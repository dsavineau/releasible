interactions:
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
    method: GET
    uri: https://api.github.com/repos/ansible/ansible/pulls/73544
  response:
    body:
      string: "{\"url\":\"https://api.github.com/repos/ansible/ansible/pulls/73544\",\"id\":570499421,\"node_id\":\"MDExOlB1bGxSZXF1ZXN0NTcwNDk5NDIx\",\"html_url\":\"https://github.com/ansible/ansible/pull/73544\",\"diff_url\":\"https://github.com/ansible/ansible/pull/73544.diff\",\"patch_url\":\"https://github.com/ansible/ansible/pull/73544.patch\",\"issue_url\":\"https://api.github.com/repos/ansible/ansible/issues/73544\",\"number\":73544,\"state\":\"open\",\"locked\":false,\"title\":\"[stable-2.9]
        Add AlmaLinux to the family of Red Hat-like operating systems (#73541)\",\"user\":{\"login\":\"samdoran\",\"id\":4047861,\"node_id\":\"MDQ6VXNlcjQwNDc4NjE=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/4047861?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/samdoran\",\"html_url\":\"https://github.com/samdoran\",\"followers_url\":\"https://api.github.com/users/samdoran/followers\",\"following_url\":\"https://api.github.com/users/samdoran/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/samdoran/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/samdoran/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/samdoran/subscriptions\",\"organizations_url\":\"https://api.github.com/users/samdoran/orgs\",\"repos_url\":\"https://api.github.com/users/samdoran/repos\",\"events_url\":\"https://api.github.com/users/samdoran/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/samdoran/received_events\",\"type\":\"User\",\"site_admin\":false},\"body\":\"#####
        SUMMARY\\r\\n<!--- Describe the change below, including rationale and design
        decisions -->\\r\\nBackport of #73541 for Ansible 2.9.\\r\\n<!--- HINT: Include
        \\\"Fixes #nnn\\\" if you are fixing an existing issue -->\\r\\n\\r\\n#####
        ISSUE TYPE\\r\\n<!--- Pick one below and delete the rest -->\\r\\n- Bugfix
        Pull Request\\r\\n\\r\\n##### COMPONENT NAME\\r\\n<!--- Write the short name
        of the module, plugin, task or feature below -->\\r\\n`lib/ansible/module_utils/facts/system/distribution.py`\",\"created_at\":\"2021-02-09T18:09:43Z\",\"updated_at\":\"2021-02-19T06:57:03Z\",\"closed_at\":null,\"merged_at\":null,\"merge_commit_sha\":\"e1234321c5c296e65533aa659c2ba629cb464d15\",\"assignee\":null,\"assignees\":[],\"requested_reviewers\":[],\"requested_teams\":[],\"labels\":[{\"id\":1316917295,\"node_id\":\"MDU6TGFiZWwxMzE2OTE3Mjk1\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/affects_2.9\",\"name\":\"affects_2.9\",\"color\":\"5319e7\",\"default\":false,\"description\":\"This
        issue/PR affects Ansible v2.9\"},{\"id\":266246971,\"node_id\":\"MDU6TGFiZWwyNjYyNDY5NzE=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/backport\",\"name\":\"backport\",\"color\":\"00ff00\",\"default\":false,\"description\":\"This
        PR does not target the devel branch.\"},{\"id\":785271699,\"node_id\":\"MDU6TGFiZWw3ODUyNzE2OTk=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/bug\",\"name\":\"bug\",\"color\":\"fbca04\",\"default\":true,\"description\":\"This
        issue/PR relates to a bug.\"},{\"id\":513652538,\"node_id\":\"MDU6TGFiZWw1MTM2NTI1Mzg=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/core_review\",\"name\":\"core_review\",\"color\":\"ededed\",\"default\":false,\"description\":\"In
        order to be merged, this PR must follow the core review workflow.\"},{\"id\":503572087,\"node_id\":\"MDU6TGFiZWw1MDM1NzIwODc=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/needs_triage\",\"name\":\"needs_triage\",\"color\":\"0e8a16\",\"default\":false,\"description\":\"Needs
        a first human triage before being processed.\"},{\"id\":581543918,\"node_id\":\"MDU6TGFiZWw1ODE1NDM5MTg=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/stale_ci\",\"name\":\"stale_ci\",\"color\":\"fef2c0\",\"default\":false,\"description\":\"This
        PR has been tested by CI more than one week ago. Close and re-open this PR
        to get it retested.\"},{\"id\":636327968,\"node_id\":\"MDU6TGFiZWw2MzYzMjc5Njg=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/support:community\",\"name\":\"support:community\",\"color\":\"ededed\",\"default\":false,\"description\":\"This
        issue/PR relates to code supported by the Ansible community.\"},{\"id\":636352796,\"node_id\":\"MDU6TGFiZWw2MzYzNTI3OTY=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/support:core\",\"name\":\"support:core\",\"color\":\"ededed\",\"default\":false,\"description\":\"This
        issue/PR relates to code supported by the Ansible Engineering Team.\"}],\"milestone\":null,\"draft\":false,\"commits_url\":\"https://api.github.com/repos/ansible/ansible/pulls/73544/commits\",\"review_comments_url\":\"https://api.github.com/repos/ansible/ansible/pulls/73544/comments\",\"review_comment_url\":\"https://api.github.com/repos/ansible/ansible/pulls/comments{/number}\",\"comments_url\":\"https://api.github.com/repos/ansible/ansible/issues/73544/comments\",\"statuses_url\":\"https://api.github.com/repos/ansible/ansible/statuses/f6398f0dec58100490938cfefc864669dfb3349c\",\"head\":{\"label\":\"samdoran:backport-2f5c83d-stable-2.9\",\"ref\":\"backport-2f5c83d-stable-2.9\",\"sha\":\"f6398f0dec58100490938cfefc864669dfb3349c\",\"user\":{\"login\":\"samdoran\",\"id\":4047861,\"node_id\":\"MDQ6VXNlcjQwNDc4NjE=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/4047861?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/samdoran\",\"html_url\":\"https://github.com/samdoran\",\"followers_url\":\"https://api.github.com/users/samdoran/followers\",\"following_url\":\"https://api.github.com/users/samdoran/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/samdoran/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/samdoran/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/samdoran/subscriptions\",\"organizations_url\":\"https://api.github.com/users/samdoran/orgs\",\"repos_url\":\"https://api.github.com/users/samdoran/repos\",\"events_url\":\"https://api.github.com/users/samdoran/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/samdoran/received_events\",\"type\":\"User\",\"site_admin\":false},\"repo\":{\"id\":70726272,\"node_id\":\"MDEwOlJlcG9zaXRvcnk3MDcyNjI3Mg==\",\"name\":\"ansible\",\"full_name\":\"samdoran/ansible\",\"private\":false,\"owner\":{\"login\":\"samdoran\",\"id\":4047861,\"node_id\":\"MDQ6VXNlcjQwNDc4NjE=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/4047861?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/samdoran\",\"html_url\":\"https://github.com/samdoran\",\"followers_url\":\"https://api.github.com/users/samdoran/followers\",\"following_url\":\"https://api.github.com/users/samdoran/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/samdoran/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/samdoran/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/samdoran/subscriptions\",\"organizations_url\":\"https://api.github.com/users/samdoran/orgs\",\"repos_url\":\"https://api.github.com/users/samdoran/repos\",\"events_url\":\"https://api.github.com/users/samdoran/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/samdoran/received_events\",\"type\":\"User\",\"site_admin\":false},\"html_url\":\"https://github.com/samdoran/ansible\",\"description\":\"Ansible
        is a radically simple IT automation platform that makes your applications
        and systems easier to deploy. Avoid writing scripts or custom code to deploy
        and update your applications\u2014 automate in a language that approaches
        plain English, using SSH, with no agents to install on remote systems.\",\"fork\":true,\"url\":\"https://api.github.com/repos/samdoran/ansible\",\"forks_url\":\"https://api.github.com/repos/samdoran/ansible/forks\",\"keys_url\":\"https://api.github.com/repos/samdoran/ansible/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/samdoran/ansible/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/samdoran/ansible/teams\",\"hooks_url\":\"https://api.github.com/repos/samdoran/ansible/hooks\",\"issue_events_url\":\"https://api.github.com/repos/samdoran/ansible/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/samdoran/ansible/events\",\"assignees_url\":\"https://api.github.com/repos/samdoran/ansible/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/samdoran/ansible/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/samdoran/ansible/tags\",\"blobs_url\":\"https://api.github.com/repos/samdoran/ansible/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/samdoran/ansible/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/samdoran/ansible/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/samdoran/ansible/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/samdoran/ansible/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/samdoran/ansible/languages\",\"stargazers_url\":\"https://api.github.com/repos/samdoran/ansible/stargazers\",\"contributors_url\":\"https://api.github.com/repos/samdoran/ansible/contributors\",\"subscribers_url\":\"https://api.github.com/repos/samdoran/ansible/subscribers\",\"subscription_url\":\"https://api.github.com/repos/samdoran/ansible/subscription\",\"commits_url\":\"https://api.github.com/repos/samdoran/ansible/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/samdoran/ansible/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/samdoran/ansible/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/samdoran/ansible/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/samdoran/ansible/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/samdoran/ansible/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/samdoran/ansible/merges\",\"archive_url\":\"https://api.github.com/repos/samdoran/ansible/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/samdoran/ansible/downloads\",\"issues_url\":\"https://api.github.com/repos/samdoran/ansible/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/samdoran/ansible/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/samdoran/ansible/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/samdoran/ansible/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/samdoran/ansible/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/samdoran/ansible/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/samdoran/ansible/deployments\",\"created_at\":\"2016-10-12T17:53:34Z\",\"updated_at\":\"2020-11-19T13:40:09Z\",\"pushed_at\":\"2021-02-26T15:28:41Z\",\"git_url\":\"git://github.com/samdoran/ansible.git\",\"ssh_url\":\"git@github.com:samdoran/ansible.git\",\"clone_url\":\"https://github.com/samdoran/ansible.git\",\"svn_url\":\"https://github.com/samdoran/ansible\",\"homepage\":\"http://ansible.com/\",\"size\":187311,\"stargazers_count\":1,\"watchers_count\":1,\"language\":\"Python\",\"has_issues\":false,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":false,\"has_pages\":false,\"forks_count\":1,\"mirror_url\":null,\"archived\":false,\"disabled\":false,\"open_issues_count\":0,\"license\":{\"key\":\"gpl-3.0\",\"name\":\"GNU
        General Public License v3.0\",\"spdx_id\":\"GPL-3.0\",\"url\":\"https://api.github.com/licenses/gpl-3.0\",\"node_id\":\"MDc6TGljZW5zZTk=\"},\"forks\":1,\"open_issues\":0,\"watchers\":1,\"default_branch\":\"devel\"}},\"base\":{\"label\":\"ansible:stable-2.9\",\"ref\":\"stable-2.9\",\"sha\":\"7a7f5a700660c9ea9028062b6714540df57910e2\",\"user\":{\"login\":\"ansible\",\"id\":1507452,\"node_id\":\"MDEyOk9yZ2FuaXphdGlvbjE1MDc0NTI=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/1507452?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/ansible\",\"html_url\":\"https://github.com/ansible\",\"followers_url\":\"https://api.github.com/users/ansible/followers\",\"following_url\":\"https://api.github.com/users/ansible/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/ansible/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/ansible/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/ansible/subscriptions\",\"organizations_url\":\"https://api.github.com/users/ansible/orgs\",\"repos_url\":\"https://api.github.com/users/ansible/repos\",\"events_url\":\"https://api.github.com/users/ansible/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/ansible/received_events\",\"type\":\"Organization\",\"site_admin\":false},\"repo\":{\"id\":3638964,\"node_id\":\"MDEwOlJlcG9zaXRvcnkzNjM4OTY0\",\"name\":\"ansible\",\"full_name\":\"ansible/ansible\",\"private\":false,\"owner\":{\"login\":\"ansible\",\"id\":1507452,\"node_id\":\"MDEyOk9yZ2FuaXphdGlvbjE1MDc0NTI=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/1507452?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/ansible\",\"html_url\":\"https://github.com/ansible\",\"followers_url\":\"https://api.github.com/users/ansible/followers\",\"following_url\":\"https://api.github.com/users/ansible/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/ansible/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/ansible/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/ansible/subscriptions\",\"organizations_url\":\"https://api.github.com/users/ansible/orgs\",\"repos_url\":\"https://api.github.com/users/ansible/repos\",\"events_url\":\"https://api.github.com/users/ansible/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/ansible/received_events\",\"type\":\"Organization\",\"site_admin\":false},\"html_url\":\"https://github.com/ansible/ansible\",\"description\":\"Ansible
        is a radically simple IT automation platform that makes your applications
        and systems easier to deploy and maintain. Automate everything from code deployment
        to network configuration to cloud management, in a language that approaches
        plain English, using SSH, with no agents to install on remote systems. https://docs.ansible.com.\",\"fork\":false,\"url\":\"https://api.github.com/repos/ansible/ansible\",\"forks_url\":\"https://api.github.com/repos/ansible/ansible/forks\",\"keys_url\":\"https://api.github.com/repos/ansible/ansible/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/ansible/ansible/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/ansible/ansible/teams\",\"hooks_url\":\"https://api.github.com/repos/ansible/ansible/hooks\",\"issue_events_url\":\"https://api.github.com/repos/ansible/ansible/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/ansible/ansible/events\",\"assignees_url\":\"https://api.github.com/repos/ansible/ansible/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/ansible/ansible/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/ansible/ansible/tags\",\"blobs_url\":\"https://api.github.com/repos/ansible/ansible/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/ansible/ansible/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/ansible/ansible/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/ansible/ansible/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/ansible/ansible/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/ansible/ansible/languages\",\"stargazers_url\":\"https://api.github.com/repos/ansible/ansible/stargazers\",\"contributors_url\":\"https://api.github.com/repos/ansible/ansible/contributors\",\"subscribers_url\":\"https://api.github.com/repos/ansible/ansible/subscribers\",\"subscription_url\":\"https://api.github.com/repos/ansible/ansible/subscription\",\"commits_url\":\"https://api.github.com/repos/ansible/ansible/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/ansible/ansible/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/ansible/ansible/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/ansible/ansible/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/ansible/ansible/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/ansible/ansible/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/ansible/ansible/merges\",\"archive_url\":\"https://api.github.com/repos/ansible/ansible/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/ansible/ansible/downloads\",\"issues_url\":\"https://api.github.com/repos/ansible/ansible/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/ansible/ansible/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/ansible/ansible/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/ansible/ansible/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/ansible/ansible/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/ansible/ansible/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/ansible/ansible/deployments\",\"created_at\":\"2012-03-06T14:58:02Z\",\"updated_at\":\"2021-02-27T02:40:42Z\",\"pushed_at\":\"2021-02-27T06:00:14Z\",\"git_url\":\"git://github.com/ansible/ansible.git\",\"ssh_url\":\"org-1507452@github.com:ansible/ansible.git\",\"clone_url\":\"https://github.com/ansible/ansible.git\",\"svn_url\":\"https://github.com/ansible/ansible\",\"homepage\":\"https://www.ansible.com/\",\"size\":194931,\"stargazers_count\":47033,\"watchers_count\":47033,\"language\":\"Python\",\"has_issues\":true,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":false,\"has_pages\":false,\"forks_count\":20311,\"mirror_url\":null,\"archived\":false,\"disabled\":false,\"open_issues_count\":1892,\"license\":{\"key\":\"gpl-3.0\",\"name\":\"GNU
        General Public License v3.0\",\"spdx_id\":\"GPL-3.0\",\"url\":\"https://api.github.com/licenses/gpl-3.0\",\"node_id\":\"MDc6TGljZW5zZTk=\"},\"forks\":20311,\"open_issues\":1892,\"watchers\":47033,\"default_branch\":\"devel\"}},\"_links\":{\"self\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/73544\"},\"html\":{\"href\":\"https://github.com/ansible/ansible/pull/73544\"},\"issue\":{\"href\":\"https://api.github.com/repos/ansible/ansible/issues/73544\"},\"comments\":{\"href\":\"https://api.github.com/repos/ansible/ansible/issues/73544/comments\"},\"review_comments\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/73544/comments\"},\"review_comment\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/comments{/number}\"},\"commits\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/73544/commits\"},\"statuses\":{\"href\":\"https://api.github.com/repos/ansible/ansible/statuses/f6398f0dec58100490938cfefc864669dfb3349c\"}},\"author_association\":\"MEMBER\",\"auto_merge\":null,\"active_lock_reason\":null,\"merged\":false,\"mergeable\":true,\"rebaseable\":true,\"mergeable_state\":\"clean\",\"merged_by\":null,\"comments\":0,\"review_comments\":0,\"maintainer_can_modify\":true,\"commits\":1,\"additions\":57,\"deletions\":1,\"changed_files\":3}"
    headers:
      Access-Control-Allow-Origin:
      - '*'
      Access-Control-Expose-Headers:
      - ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining,
        X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes,
        X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset
      Cache-Control:
      - private, max-age=60, s-maxage=60
      Content-Encoding:
      - gzip
      Content-Security-Policy:
      - default-src 'none'
      Content-Type:
      - application/json; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:38 GMT
      Etag:
      - W/"aacd1a92733b857d42d081b2721fbb57834d8528f1d8d11a1491d86417df144b"
      Last-Modified:
      - Thu, 25 Feb 2021 15:44:45 GMT
      Referrer-Policy:
      - origin-when-cross-origin, strict-origin-when-cross-origin
      Server:
      - GitHub.com
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - Accept, Authorization, Cookie, X-GitHub-OTP
      - Accept-Encoding, Accept, X-Requested-With
      X-Accepted-OAuth-Scopes:
      - ''
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Media-Type:
      - github.cloak-preview, github.groot-preview; format=json
      X-GitHub-Request-Id:
      - AAC0:74C8:2952F:1A8554:6039F06E
      X-OAuth-Scopes:
      - repo, workflow
      X-RateLimit-Limit:
      - '5000'
      X-RateLimit-Remaining:
      - '4948'
      X-RateLimit-Reset:
      - '1614412319'
      X-XSS-Protection:
      - 1; mode=block
      x-ratelimit-used:
      - '52'
    status:
      code: 200
      message: OK
    url: https://api.github.com/repos/ansible/ansible/pulls/73544
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Accept-Encoding:
      - gzip, deflate
      Host:
      - github.com
      User-Agent:
      - Python/3.8 aiohttp/3.7.3
    method: GET
    uri: https://github.com/ansible/ansible/pull/73544.diff
  response:
    body: {}
    headers:
      Cache-Control:
      - no-cache
      Content-Security-Policy:
      - 'default-src ''none''; base-uri ''self''; block-all-mixed-content; connect-src
        ''self'' uploads.github.com www.githubstatus.com collector.githubapp.com api.github.com
        github-cloud.s3.amazonaws.com github-production-repository-file-5c1aeb.s3.amazonaws.com
        github-production-upload-manifest-file-7fdce7.s3.amazonaws.com github-production-user-asset-6210df.s3.amazonaws.com
        cdn.optimizely.com logx.optimizely.com/v1/events wss://alive.github.com online.visualstudio.com/api/v1/locations;
        font-src github.githubassets.com; form-action ''self'' github.com gist.github.com;
        frame-ancestors ''none''; frame-src render.githubusercontent.com; img-src
        ''self'' data: github.githubassets.com identicons.github.com collector.githubapp.com
        github-cloud.s3.amazonaws.com user-images.githubusercontent.com/ *.githubusercontent.com;
        manifest-src ''self''; media-src ''none''; script-src github.githubassets.com;
        style-src ''unsafe-inline'' github.githubassets.com; worker-src github.com/socket-worker-5029ae85.js
        gist.github.com/socket-worker-5029ae85.js'
      Content-Type:
      - text/html; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:38 GMT
      Expect-CT:
      - max-age=2592000, report-uri="https://api.github.com/_private/browser/errors"
      Location:
      - https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73544.diff
      Referrer-Policy:
      - no-referrer-when-downgrade
      Server:
      - GitHub.com
      Set-Cookie:
      - logged_in=no; domain=.github.com; path=/; expires=Sun, 27 Feb 2022 07:10:38
        GMT; secure; HttpOnly; SameSite=Lax
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - X-PJAX
      - Accept-Encoding, Accept, X-Requested-With
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Request-Id:
      - D35A:3DBA:6579F5:853F71:6039F06E
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 302
      message: Found
    url: https://github.com/ansible/ansible/pull/73544.diff
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Accept-Encoding:
      - gzip, deflate
      Host:
      - patch-diff.githubusercontent.com
      User-Agent:
      - Python/3.8 aiohttp/3.7.3
    method: GET
    uri: https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73544.diff
  response:
    body:
      string: "diff --git a/changelogs/fragments/support_almalinux.yml b/changelogs/fragments/support_almalinux.yml\nnew
        file mode 100644\nindex 0000000000000..4dbc040a62f1e\n--- /dev/null\n+++ b/changelogs/fragments/support_almalinux.yml\n@@
        -0,0 +1,2 @@\n+bugfixes:\n+  - add AlmaLinux to fact gathering (https://github.com/ansible/ansible/pull/73458)\ndiff
        --git a/lib/ansible/module_utils/facts/system/distribution.py b/lib/ansible/module_utils/facts/system/distribution.py\nindex
        57691dbf91125..09b5a5fd173df 100644\n--- a/lib/ansible/module_utils/facts/system/distribution.py\n+++
        b/lib/ansible/module_utils/facts/system/distribution.py\n@@ -466,7 +466,8
        @@ class Distribution(object):\n     # keep keys in sync with Conditionals
        page of docs\n     OS_FAMILY_MAP = {'RedHat': ['RedHat', 'Fedora', 'CentOS',
        'Scientific', 'SLC',\n                                 'Ascendos', 'CloudLinux',
        'PSBM', 'OracleLinux', 'OVS',\n-                                'OEL', 'Amazon',
        'Virtuozzo', 'XenServer', 'Alibaba'],\n+                                'OEL',
        'Amazon', 'Virtuozzo', 'XenServer', 'Alibaba',\n+                                'AlmaLinux'],\n
        \                     'Debian': ['Debian', 'Ubuntu', 'Raspbian', 'Neon', 'KDE
        neon',\n                                 'Linux Mint', 'SteamOS', 'Devuan',
        'Kali', 'Cumulus Linux'],\n                      'Suse': ['SuSE', 'SLES',
        'SLED', 'openSUSE', 'openSUSE Tumbleweed',\ndiff --git a/test/units/module_utils/facts/system/distribution/fixtures/almalinux_8_3_beta.json
        b/test/units/module_utils/facts/system/distribution/fixtures/almalinux_8_3_beta.json\nnew
        file mode 100644\nindex 0000000000000..2d8df50bf1275\n--- /dev/null\n+++ b/test/units/module_utils/facts/system/distribution/fixtures/almalinux_8_3_beta.json\n@@
        -0,0 +1,53 @@\n+{\n+    \"name\": \"AlmaLinux 8.3\",\n+    \"distro\": {\n+
        \       \"codename\": \"Purple Manul\",\n+        \"id\": \"almalinux\",\n+
        \       \"name\": \"AlmaLinux\",\n+        \"version\": \"8.3\",\n+        \"version_best\":
        \"8.3\",\n+        \"lsb_release_info\": {\n+            \"lsb_version\":
        \":core-4.1-amd64:core-4.1-noarch\",\n+            \"distributor_id\": \"AlmaLinux\",\n+
        \           \"description\": \"AlmaLinux release 8.3 Beta (Purple Manul)\",\n+
        \           \"release\": \"8.3\",\n+            \"codename\": \"PurpleManul\"\n+
        \       },\n+        \"os_release_info\": {\n+            \"name\": \"AlmaLinux\",\n+
        \           \"version\": \"8.3 (Purple Manul)\",\n+            \"id\": \"almalinux\",\n+
        \           \"id_like\": \"rhel centos fedora\",\n+            \"version_id\":
        \"8.3\",\n+            \"platform_id\": \"platform:el8\",\n+            \"pretty_name\":
        \"AlmaLinux 8.3 Beta (Purple Manul)\",\n+            \"ansi_color\": \"0;34\",\n+
        \           \"cpe_name\": \"cpe:/o:almalinux:almalinux:8.3:beta\",\n+            \"home_url\":
        \"https://almalinux.org/\",\n+            \"bug_report_url\": \"https://bugs.almalinux.org/\",\n+
        \           \"almalinux_mantisbt_project\": \"AlmaLinux-8\",\n+            \"almalinux_mantisbt_project_version\":
        \"8\",\n+            \"codename\": \"Purple Manul\"\n+        }\n+    },\n+
        \   \"input\": {\n+        \"/etc/centos-release\": \"AlmaLinux release 8.3
        Beta (Purple Manul)\\n\",\n+        \"/etc/redhat-release\": \"AlmaLinux release
        8.3 Beta (Purple Manul)\\n\",\n+        \"/etc/system-release\": \"AlmaLinux
        release 8.3 Beta (Purple Manul)\\n\",\n+        \"/etc/os-release\": \"NAME=\\\"AlmaLinux\\\"\\nVERSION=\\\"8.3
        (Purple Manul)\\\"\\nID=\\\"almalinux\\\"\\nID_LIKE=\\\"rhel centos fedora\\\"\\nVERSION_ID=\\\"8.3\\\"\\nPLATFORM_ID=\\\"platform:el8\\\"\\nPRETTY_NAME=\\\"AlmaLinux
        8.3 Beta (Purple Manul)\\\"\\nANSI_COLOR=\\\"0;34\\\"\\nCPE_NAME=\\\"cpe:/o:almalinux:almalinux:8.3:beta\\\"\\nHOME_URL=\\\"https://almalinux.org/\\\"\\nBUG_REPORT_URL=\\\"https://bugs.almalinux.org/\\\"\\n\\nALMALINUX_MANTISBT_PROJECT=\\\"AlmaLinux-8\\\"
        \                       \\nALMALINUX_MANTISBT_PROJECT_VERSION=\\\"8\\\"                       \\n\\n\",\n+
        \       \"/usr/lib/os-release\": \"NAME=\\\"AlmaLinux\\\"\\nVERSION=\\\"8.3
        (Purple Manul)\\\"\\nID=\\\"almalinux\\\"\\nID_LIKE=\\\"rhel centos fedora\\\"\\nVERSION_ID=\\\"8.3\\\"\\nPLATFORM_ID=\\\"platform:el8\\\"\\nPRETTY_NAME=\\\"AlmaLinux
        8.3 Beta (Purple Manul)\\\"\\nANSI_COLOR=\\\"0;34\\\"\\nCPE_NAME=\\\"cpe:/o:almalinux:almalinux:8.3:beta\\\"\\nHOME_URL=\\\"https://almalinux.org/\\\"\\nBUG_REPORT_URL=\\\"https://bugs.almalinux.org/\\\"\\n\\nALMALINUX_MANTISBT_PROJECT=\\\"AlmaLinux-8\\\"
        \                       \\nALMALINUX_MANTISBT_PROJECT_VERSION=\\\"8\\\"                       \\n\\n\"\n+
        \   },\n+    \"platform.dist\": [\n+        \"almalinux\",\n+        \"8.3\",\n+
        \       \"Purple Manul\"\n+    ],\n+    \"result\": {\n+        \"distribution\":
        \"AlmaLinux\",\n+        \"distribution_version\": \"8.3\",\n+        \"distribution_release\":
        \"Purple Manul\",\n+        \"distribution_major_version\": \"8\",\n+        \"os_family\":
        \"RedHat\"\n+    },\n+    \"platform.release\": \"4.18.0-240.el8.x86_64\"\n+}\n"
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Content-Encoding:
      - gzip
      Content-Security-Policy:
      - 'default-src ''none''; base-uri ''self''; block-all-mixed-content; connect-src
        ''self'' uploads.github.com www.githubstatus.com collector.githubapp.com api.github.com
        github-cloud.s3.amazonaws.com github-production-repository-file-5c1aeb.s3.amazonaws.com
        github-production-upload-manifest-file-7fdce7.s3.amazonaws.com github-production-user-asset-6210df.s3.amazonaws.com
        cdn.optimizely.com logx.optimizely.com/v1/events wss://alive.github.com; font-src
        github.githubassets.com; form-action ''self'' github.com gist.github.com;
        frame-ancestors ''none''; frame-src render.githubusercontent.com; img-src
        ''self'' data: github.githubassets.com identicons.github.com collector.githubapp.com
        github-cloud.s3.amazonaws.com user-images.githubusercontent.com/ *.githubusercontent.com;
        manifest-src ''self''; media-src ''none''; script-src github.githubassets.com;
        style-src ''unsafe-inline'' github.githubassets.com; worker-src github.com/socket-worker-5029ae85.js
        gist.github.com/socket-worker-5029ae85.js'
      Content-Type:
      - text/plain; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:38 GMT
      Etag:
      - W/"54cc29f53348690ec8e9464582b2d634"
      Expect-CT:
      - max-age=2592000, report-uri="https://api.github.com/_private/browser/errors"
      Referrer-Policy:
      - origin-when-cross-origin, strict-origin-when-cross-origin
      Server:
      - GitHub.com
      Set-Cookie:
      - logged_in=no; domain=.github.com; path=/; expires=Sun, 27 Feb 2022 07:10:38
        GMT; secure; HttpOnly; SameSite=Lax
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - X-PJAX
      - Accept-Encoding, Accept, X-Requested-With
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Request-Id:
      - D35C:1A52:95E0EE:B717A3:6039F06E
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
    url: https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73544.diff
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Cookie:
      - logged_in=no
    method: GET
    uri: https://api.github.com/repos/ansible/ansible/pulls/73541
  response:
    body:
      string: "{\"url\":\"https://api.github.com/repos/ansible/ansible/pulls/73541\",\"id\":570476127,\"node_id\":\"MDExOlB1bGxSZXF1ZXN0NTcwNDc2MTI3\",\"html_url\":\"https://github.com/ansible/ansible/pull/73541\",\"diff_url\":\"https://github.com/ansible/ansible/pull/73541.diff\",\"patch_url\":\"https://github.com/ansible/ansible/pull/73541.patch\",\"issue_url\":\"https://api.github.com/repos/ansible/ansible/issues/73541\",\"number\":73541,\"state\":\"closed\",\"locked\":false,\"title\":\"Add
        AlmaLinux to the family of Red Hat-like operating systems\",\"user\":{\"login\":\"samdoran\",\"id\":4047861,\"node_id\":\"MDQ6VXNlcjQwNDc4NjE=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/4047861?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/samdoran\",\"html_url\":\"https://github.com/samdoran\",\"followers_url\":\"https://api.github.com/users/samdoran/followers\",\"following_url\":\"https://api.github.com/users/samdoran/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/samdoran/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/samdoran/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/samdoran/subscriptions\",\"organizations_url\":\"https://api.github.com/users/samdoran/orgs\",\"repos_url\":\"https://api.github.com/users/samdoran/repos\",\"events_url\":\"https://api.github.com/users/samdoran/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/samdoran/received_events\",\"type\":\"User\",\"site_admin\":false},\"body\":\"#####
        SUMMARY\\r\\n<!--- Describe the change below, including rationale and design
        decisions -->\\r\\nReplaces #73458\\r\\n<!--- HINT: Include \\\"Fixes #nnn\\\"
        if you are fixing an existing issue -->\\r\\n\\r\\n##### ISSUE TYPE\\r\\n<!---
        Pick one below and delete the rest -->\\r\\n- Bugfix Pull Request\\r\\n\\r\\n#####
        COMPONENT NAME\\r\\n<!--- Write the short name of the module, plugin, task
        or feature below -->\\r\\n`lib/ansible/module_utils/facts/system/distribution.py`\",\"created_at\":\"2021-02-09T17:35:47Z\",\"updated_at\":\"2021-02-11T18:59:55Z\",\"closed_at\":\"2021-02-09T18:04:39Z\",\"merged_at\":\"2021-02-09T18:04:39Z\",\"merge_commit_sha\":\"2f5c83dfb1855342389436e72d64cf7afe9698e6\",\"assignee\":null,\"assignees\":[],\"requested_reviewers\":[],\"requested_teams\":[],\"labels\":[{\"id\":1742671738,\"node_id\":\"MDU6TGFiZWwxNzQyNjcxNzM4\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/affects_2.11\",\"name\":\"affects_2.11\",\"color\":\"5319e7\",\"default\":false,\"description\":\"\"},{\"id\":785271699,\"node_id\":\"MDU6TGFiZWw3ODUyNzE2OTk=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/bug\",\"name\":\"bug\",\"color\":\"fbca04\",\"default\":true,\"description\":\"This
        issue/PR relates to a bug.\"},{\"id\":513652538,\"node_id\":\"MDU6TGFiZWw1MTM2NTI1Mzg=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/core_review\",\"name\":\"core_review\",\"color\":\"ededed\",\"default\":false,\"description\":\"In
        order to be merged, this PR must follow the core review workflow.\"},{\"id\":636327968,\"node_id\":\"MDU6TGFiZWw2MzYzMjc5Njg=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/support:community\",\"name\":\"support:community\",\"color\":\"ededed\",\"default\":false,\"description\":\"This
        issue/PR relates to code supported by the Ansible community.\"},{\"id\":636352796,\"node_id\":\"MDU6TGFiZWw2MzYzNTI3OTY=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/support:core\",\"name\":\"support:core\",\"color\":\"ededed\",\"default\":false,\"description\":\"This
        issue/PR relates to code supported by the Ansible Engineering Team.\"}],\"milestone\":null,\"draft\":false,\"commits_url\":\"https://api.github.com/repos/ansible/ansible/pulls/73541/commits\",\"review_comments_url\":\"https://api.github.com/repos/ansible/ansible/pulls/73541/comments\",\"review_comment_url\":\"https://api.github.com/repos/ansible/ansible/pulls/comments{/number}\",\"comments_url\":\"https://api.github.com/repos/ansible/ansible/issues/73541/comments\",\"statuses_url\":\"https://api.github.com/repos/ansible/ansible/statuses/3ea9b87e7ee0c0dcb807a22bf4584732d90ed881\",\"head\":{\"label\":\"samdoran:add-alma-linux\",\"ref\":\"add-alma-linux\",\"sha\":\"3ea9b87e7ee0c0dcb807a22bf4584732d90ed881\",\"user\":{\"login\":\"samdoran\",\"id\":4047861,\"node_id\":\"MDQ6VXNlcjQwNDc4NjE=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/4047861?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/samdoran\",\"html_url\":\"https://github.com/samdoran\",\"followers_url\":\"https://api.github.com/users/samdoran/followers\",\"following_url\":\"https://api.github.com/users/samdoran/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/samdoran/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/samdoran/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/samdoran/subscriptions\",\"organizations_url\":\"https://api.github.com/users/samdoran/orgs\",\"repos_url\":\"https://api.github.com/users/samdoran/repos\",\"events_url\":\"https://api.github.com/users/samdoran/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/samdoran/received_events\",\"type\":\"User\",\"site_admin\":false},\"repo\":{\"id\":70726272,\"node_id\":\"MDEwOlJlcG9zaXRvcnk3MDcyNjI3Mg==\",\"name\":\"ansible\",\"full_name\":\"samdoran/ansible\",\"private\":false,\"owner\":{\"login\":\"samdoran\",\"id\":4047861,\"node_id\":\"MDQ6VXNlcjQwNDc4NjE=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/4047861?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/samdoran\",\"html_url\":\"https://github.com/samdoran\",\"followers_url\":\"https://api.github.com/users/samdoran/followers\",\"following_url\":\"https://api.github.com/users/samdoran/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/samdoran/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/samdoran/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/samdoran/subscriptions\",\"organizations_url\":\"https://api.github.com/users/samdoran/orgs\",\"repos_url\":\"https://api.github.com/users/samdoran/repos\",\"events_url\":\"https://api.github.com/users/samdoran/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/samdoran/received_events\",\"type\":\"User\",\"site_admin\":false},\"html_url\":\"https://github.com/samdoran/ansible\",\"description\":\"Ansible
        is a radically simple IT automation platform that makes your applications
        and systems easier to deploy. Avoid writing scripts or custom code to deploy
        and update your applications\u2014 automate in a language that approaches
        plain English, using SSH, with no agents to install on remote systems.\",\"fork\":true,\"url\":\"https://api.github.com/repos/samdoran/ansible\",\"forks_url\":\"https://api.github.com/repos/samdoran/ansible/forks\",\"keys_url\":\"https://api.github.com/repos/samdoran/ansible/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/samdoran/ansible/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/samdoran/ansible/teams\",\"hooks_url\":\"https://api.github.com/repos/samdoran/ansible/hooks\",\"issue_events_url\":\"https://api.github.com/repos/samdoran/ansible/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/samdoran/ansible/events\",\"assignees_url\":\"https://api.github.com/repos/samdoran/ansible/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/samdoran/ansible/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/samdoran/ansible/tags\",\"blobs_url\":\"https://api.github.com/repos/samdoran/ansible/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/samdoran/ansible/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/samdoran/ansible/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/samdoran/ansible/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/samdoran/ansible/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/samdoran/ansible/languages\",\"stargazers_url\":\"https://api.github.com/repos/samdoran/ansible/stargazers\",\"contributors_url\":\"https://api.github.com/repos/samdoran/ansible/contributors\",\"subscribers_url\":\"https://api.github.com/repos/samdoran/ansible/subscribers\",\"subscription_url\":\"https://api.github.com/repos/samdoran/ansible/subscription\",\"commits_url\":\"https://api.github.com/repos/samdoran/ansible/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/samdoran/ansible/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/samdoran/ansible/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/samdoran/ansible/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/samdoran/ansible/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/samdoran/ansible/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/samdoran/ansible/merges\",\"archive_url\":\"https://api.github.com/repos/samdoran/ansible/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/samdoran/ansible/downloads\",\"issues_url\":\"https://api.github.com/repos/samdoran/ansible/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/samdoran/ansible/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/samdoran/ansible/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/samdoran/ansible/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/samdoran/ansible/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/samdoran/ansible/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/samdoran/ansible/deployments\",\"created_at\":\"2016-10-12T17:53:34Z\",\"updated_at\":\"2020-11-19T13:40:09Z\",\"pushed_at\":\"2021-02-26T15:28:41Z\",\"git_url\":\"git://github.com/samdoran/ansible.git\",\"ssh_url\":\"git@github.com:samdoran/ansible.git\",\"clone_url\":\"https://github.com/samdoran/ansible.git\",\"svn_url\":\"https://github.com/samdoran/ansible\",\"homepage\":\"http://ansible.com/\",\"size\":187311,\"stargazers_count\":1,\"watchers_count\":1,\"language\":\"Python\",\"has_issues\":false,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":false,\"has_pages\":false,\"forks_count\":1,\"mirror_url\":null,\"archived\":false,\"disabled\":false,\"open_issues_count\":0,\"license\":{\"key\":\"gpl-3.0\",\"name\":\"GNU
        General Public License v3.0\",\"spdx_id\":\"GPL-3.0\",\"url\":\"https://api.github.com/licenses/gpl-3.0\",\"node_id\":\"MDc6TGljZW5zZTk=\"},\"forks\":1,\"open_issues\":0,\"watchers\":1,\"default_branch\":\"devel\"}},\"base\":{\"label\":\"ansible:devel\",\"ref\":\"devel\",\"sha\":\"ca448f7c350fae8080dcfec648342d2fc8837da0\",\"user\":{\"login\":\"ansible\",\"id\":1507452,\"node_id\":\"MDEyOk9yZ2FuaXphdGlvbjE1MDc0NTI=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/1507452?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/ansible\",\"html_url\":\"https://github.com/ansible\",\"followers_url\":\"https://api.github.com/users/ansible/followers\",\"following_url\":\"https://api.github.com/users/ansible/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/ansible/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/ansible/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/ansible/subscriptions\",\"organizations_url\":\"https://api.github.com/users/ansible/orgs\",\"repos_url\":\"https://api.github.com/users/ansible/repos\",\"events_url\":\"https://api.github.com/users/ansible/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/ansible/received_events\",\"type\":\"Organization\",\"site_admin\":false},\"repo\":{\"id\":3638964,\"node_id\":\"MDEwOlJlcG9zaXRvcnkzNjM4OTY0\",\"name\":\"ansible\",\"full_name\":\"ansible/ansible\",\"private\":false,\"owner\":{\"login\":\"ansible\",\"id\":1507452,\"node_id\":\"MDEyOk9yZ2FuaXphdGlvbjE1MDc0NTI=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/1507452?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/ansible\",\"html_url\":\"https://github.com/ansible\",\"followers_url\":\"https://api.github.com/users/ansible/followers\",\"following_url\":\"https://api.github.com/users/ansible/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/ansible/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/ansible/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/ansible/subscriptions\",\"organizations_url\":\"https://api.github.com/users/ansible/orgs\",\"repos_url\":\"https://api.github.com/users/ansible/repos\",\"events_url\":\"https://api.github.com/users/ansible/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/ansible/received_events\",\"type\":\"Organization\",\"site_admin\":false},\"html_url\":\"https://github.com/ansible/ansible\",\"description\":\"Ansible
        is a radically simple IT automation platform that makes your applications
        and systems easier to deploy and maintain. Automate everything from code deployment
        to network configuration to cloud management, in a language that approaches
        plain English, using SSH, with no agents to install on remote systems. https://docs.ansible.com.\",\"fork\":false,\"url\":\"https://api.github.com/repos/ansible/ansible\",\"forks_url\":\"https://api.github.com/repos/ansible/ansible/forks\",\"keys_url\":\"https://api.github.com/repos/ansible/ansible/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/ansible/ansible/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/ansible/ansible/teams\",\"hooks_url\":\"https://api.github.com/repos/ansible/ansible/hooks\",\"issue_events_url\":\"https://api.github.com/repos/ansible/ansible/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/ansible/ansible/events\",\"assignees_url\":\"https://api.github.com/repos/ansible/ansible/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/ansible/ansible/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/ansible/ansible/tags\",\"blobs_url\":\"https://api.github.com/repos/ansible/ansible/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/ansible/ansible/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/ansible/ansible/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/ansible/ansible/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/ansible/ansible/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/ansible/ansible/languages\",\"stargazers_url\":\"https://api.github.com/repos/ansible/ansible/stargazers\",\"contributors_url\":\"https://api.github.com/repos/ansible/ansible/contributors\",\"subscribers_url\":\"https://api.github.com/repos/ansible/ansible/subscribers\",\"subscription_url\":\"https://api.github.com/repos/ansible/ansible/subscription\",\"commits_url\":\"https://api.github.com/repos/ansible/ansible/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/ansible/ansible/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/ansible/ansible/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/ansible/ansible/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/ansible/ansible/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/ansible/ansible/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/ansible/ansible/merges\",\"archive_url\":\"https://api.github.com/repos/ansible/ansible/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/ansible/ansible/downloads\",\"issues_url\":\"https://api.github.com/repos/ansible/ansible/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/ansible/ansible/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/ansible/ansible/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/ansible/ansible/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/ansible/ansible/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/ansible/ansible/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/ansible/ansible/deployments\",\"created_at\":\"2012-03-06T14:58:02Z\",\"updated_at\":\"2021-02-27T02:40:42Z\",\"pushed_at\":\"2021-02-27T06:00:14Z\",\"git_url\":\"git://github.com/ansible/ansible.git\",\"ssh_url\":\"org-1507452@github.com:ansible/ansible.git\",\"clone_url\":\"https://github.com/ansible/ansible.git\",\"svn_url\":\"https://github.com/ansible/ansible\",\"homepage\":\"https://www.ansible.com/\",\"size\":194931,\"stargazers_count\":47033,\"watchers_count\":47033,\"language\":\"Python\",\"has_issues\":true,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":false,\"has_pages\":false,\"forks_count\":20311,\"mirror_url\":null,\"archived\":false,\"disabled\":false,\"open_issues_count\":1892,\"license\":{\"key\":\"gpl-3.0\",\"name\":\"GNU
        General Public License v3.0\",\"spdx_id\":\"GPL-3.0\",\"url\":\"https://api.github.com/licenses/gpl-3.0\",\"node_id\":\"MDc6TGljZW5zZTk=\"},\"forks\":20311,\"open_issues\":1892,\"watchers\":47033,\"default_branch\":\"devel\"}},\"_links\":{\"self\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/73541\"},\"html\":{\"href\":\"https://github.com/ansible/ansible/pull/73541\"},\"issue\":{\"href\":\"https://api.github.com/repos/ansible/ansible/issues/73541\"},\"comments\":{\"href\":\"https://api.github.com/repos/ansible/ansible/issues/73541/comments\"},\"review_comments\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/73541/comments\"},\"review_comment\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/comments{/number}\"},\"commits\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/73541/commits\"},\"statuses\":{\"href\":\"https://api.github.com/repos/ansible/ansible/statuses/3ea9b87e7ee0c0dcb807a22bf4584732d90ed881\"}},\"author_association\":\"MEMBER\",\"auto_merge\":null,\"active_lock_reason\":null,\"merged\":true,\"mergeable\":null,\"rebaseable\":null,\"mergeable_state\":\"unknown\",\"merged_by\":{\"login\":\"samdoran\",\"id\":4047861,\"node_id\":\"MDQ6VXNlcjQwNDc4NjE=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/4047861?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/samdoran\",\"html_url\":\"https://github.com/samdoran\",\"followers_url\":\"https://api.github.com/users/samdoran/followers\",\"following_url\":\"https://api.github.com/users/samdoran/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/samdoran/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/samdoran/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/samdoran/subscriptions\",\"organizations_url\":\"https://api.github.com/users/samdoran/orgs\",\"repos_url\":\"https://api.github.com/users/samdoran/repos\",\"events_url\":\"https://api.github.com/users/samdoran/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/samdoran/received_events\",\"type\":\"User\",\"site_admin\":false},\"comments\":0,\"review_comments\":0,\"maintainer_can_modify\":false,\"commits\":4,\"additions\":56,\"deletions\":1,\"changed_files\":3}"
    headers:
      Access-Control-Allow-Origin:
      - '*'
      Access-Control-Expose-Headers:
      - ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining,
        X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes,
        X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset
      Cache-Control:
      - private, max-age=60, s-maxage=60
      Content-Encoding:
      - gzip
      Content-Security-Policy:
      - default-src 'none'
      Content-Type:
      - application/json; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:38 GMT
      Etag:
      - W/"20ada6c982942bf68ffe6595cc363f6614cba2f97b8bdf1fdab490456da9d887"
      Last-Modified:
      - Thu, 25 Feb 2021 15:44:45 GMT
      Referrer-Policy:
      - origin-when-cross-origin, strict-origin-when-cross-origin
      Server:
      - GitHub.com
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - Accept, Authorization, Cookie, X-GitHub-OTP
      - Accept-Encoding, Accept, X-Requested-With
      X-Accepted-OAuth-Scopes:
      - ''
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Media-Type:
      - github.cloak-preview, github.groot-preview; format=json
      X-GitHub-Request-Id:
      - AAC0:74C8:29531:1A8566:6039F06E
      X-OAuth-Scopes:
      - repo, workflow
      X-RateLimit-Limit:
      - '5000'
      X-RateLimit-Remaining:
      - '4947'
      X-RateLimit-Reset:
      - '1614412319'
      X-XSS-Protection:
      - 1; mode=block
      x-ratelimit-used:
      - '53'
    status:
      code: 200
      message: OK
    url: https://api.github.com/repos/ansible/ansible/pulls/73541
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Accept-Encoding:
      - gzip, deflate
      Cookie:
      - logged_in=no
      Host:
      - github.com
      User-Agent:
      - Python/3.8 aiohttp/3.7.3
    method: GET
    uri: https://github.com/ansible/ansible/pull/73541.diff
  response:
    body: {}
    headers:
      Cache-Control:
      - no-cache
      Content-Security-Policy:
      - 'default-src ''none''; base-uri ''self''; block-all-mixed-content; connect-src
        ''self'' uploads.github.com www.githubstatus.com collector.githubapp.com api.github.com
        github-cloud.s3.amazonaws.com github-production-repository-file-5c1aeb.s3.amazonaws.com
        github-production-upload-manifest-file-7fdce7.s3.amazonaws.com github-production-user-asset-6210df.s3.amazonaws.com
        cdn.optimizely.com logx.optimizely.com/v1/events wss://alive.github.com online.visualstudio.com/api/v1/locations;
        font-src github.githubassets.com; form-action ''self'' github.com gist.github.com;
        frame-ancestors ''none''; frame-src render.githubusercontent.com; img-src
        ''self'' data: github.githubassets.com identicons.github.com collector.githubapp.com
        github-cloud.s3.amazonaws.com user-images.githubusercontent.com/ *.githubusercontent.com;
        manifest-src ''self''; media-src ''none''; script-src github.githubassets.com;
        style-src ''unsafe-inline'' github.githubassets.com; worker-src github.com/socket-worker-5029ae85.js
        gist.github.com/socket-worker-5029ae85.js'
      Content-Type:
      - text/html; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:39 GMT
      Expect-CT:
      - max-age=2592000, report-uri="https://api.github.com/_private/browser/errors"
      Location:
      - https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73541.diff
      Referrer-Policy:
      - no-referrer-when-downgrade
      Server:
      - GitHub.com
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - X-PJAX
      - Accept-Encoding, Accept, X-Requested-With
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Request-Id:
      - D35A:3DBA:657A3E:853FCE:6039F06E
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 302
      message: Found
    url: https://github.com/ansible/ansible/pull/73541.diff
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Accept-Encoding:
      - gzip, deflate
      Host:
      - patch-diff.githubusercontent.com
      User-Agent:
      - Python/3.8 aiohttp/3.7.3
    method: GET
    uri: https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73541.diff
  response:
    body:
      string: "diff --git a/changelogs/fragments/support_almalinux.yml b/changelogs/fragments/support_almalinux.yml\nnew
        file mode 100644\nindex 0000000000000..4dbc040a62f1e\n--- /dev/null\n+++ b/changelogs/fragments/support_almalinux.yml\n@@
        -0,0 +1,2 @@\n+bugfixes:\n+  - add AlmaLinux to fact gathering (https://github.com/ansible/ansible/pull/73458)\ndiff
        --git a/lib/ansible/module_utils/facts/system/distribution.py b/lib/ansible/module_utils/facts/system/distribution.py\nindex
        a31aa197f573e..fd49b3a6fbd06 100644\n--- a/lib/ansible/module_utils/facts/system/distribution.py\n+++
        b/lib/ansible/module_utils/facts/system/distribution.py\n@@ -464,7 +464,7
        @@ class Distribution(object):\n     OS_FAMILY_MAP = {'RedHat': ['RedHat',
        'Fedora', 'CentOS', 'Scientific', 'SLC',\n                                 'Ascendos',
        'CloudLinux', 'PSBM', 'OracleLinux', 'OVS',\n                                 'OEL',
        'Amazon', 'Virtuozzo', 'XenServer', 'Alibaba',\n-                                'EulerOS',
        'openEuler'],\n+                                'EulerOS', 'openEuler', 'AlmaLinux'],\n
        \                     'Debian': ['Debian', 'Ubuntu', 'Raspbian', 'Neon', 'KDE
        neon',\n                                 'Linux Mint', 'SteamOS', 'Devuan',
        'Kali', 'Cumulus Linux',\n                                 'Pop!_OS', 'Parrot',
        'Pardus GNU/Linux'],\ndiff --git a/test/units/module_utils/facts/system/distribution/fixtures/almalinux_8_3_beta.json
        b/test/units/module_utils/facts/system/distribution/fixtures/almalinux_8_3_beta.json\nnew
        file mode 100644\nindex 0000000000000..2d8df50bf1275\n--- /dev/null\n+++ b/test/units/module_utils/facts/system/distribution/fixtures/almalinux_8_3_beta.json\n@@
        -0,0 +1,53 @@\n+{\n+    \"name\": \"AlmaLinux 8.3\",\n+    \"distro\": {\n+
        \       \"codename\": \"Purple Manul\",\n+        \"id\": \"almalinux\",\n+
        \       \"name\": \"AlmaLinux\",\n+        \"version\": \"8.3\",\n+        \"version_best\":
        \"8.3\",\n+        \"lsb_release_info\": {\n+            \"lsb_version\":
        \":core-4.1-amd64:core-4.1-noarch\",\n+            \"distributor_id\": \"AlmaLinux\",\n+
        \           \"description\": \"AlmaLinux release 8.3 Beta (Purple Manul)\",\n+
        \           \"release\": \"8.3\",\n+            \"codename\": \"PurpleManul\"\n+
        \       },\n+        \"os_release_info\": {\n+            \"name\": \"AlmaLinux\",\n+
        \           \"version\": \"8.3 (Purple Manul)\",\n+            \"id\": \"almalinux\",\n+
        \           \"id_like\": \"rhel centos fedora\",\n+            \"version_id\":
        \"8.3\",\n+            \"platform_id\": \"platform:el8\",\n+            \"pretty_name\":
        \"AlmaLinux 8.3 Beta (Purple Manul)\",\n+            \"ansi_color\": \"0;34\",\n+
        \           \"cpe_name\": \"cpe:/o:almalinux:almalinux:8.3:beta\",\n+            \"home_url\":
        \"https://almalinux.org/\",\n+            \"bug_report_url\": \"https://bugs.almalinux.org/\",\n+
        \           \"almalinux_mantisbt_project\": \"AlmaLinux-8\",\n+            \"almalinux_mantisbt_project_version\":
        \"8\",\n+            \"codename\": \"Purple Manul\"\n+        }\n+    },\n+
        \   \"input\": {\n+        \"/etc/centos-release\": \"AlmaLinux release 8.3
        Beta (Purple Manul)\\n\",\n+        \"/etc/redhat-release\": \"AlmaLinux release
        8.3 Beta (Purple Manul)\\n\",\n+        \"/etc/system-release\": \"AlmaLinux
        release 8.3 Beta (Purple Manul)\\n\",\n+        \"/etc/os-release\": \"NAME=\\\"AlmaLinux\\\"\\nVERSION=\\\"8.3
        (Purple Manul)\\\"\\nID=\\\"almalinux\\\"\\nID_LIKE=\\\"rhel centos fedora\\\"\\nVERSION_ID=\\\"8.3\\\"\\nPLATFORM_ID=\\\"platform:el8\\\"\\nPRETTY_NAME=\\\"AlmaLinux
        8.3 Beta (Purple Manul)\\\"\\nANSI_COLOR=\\\"0;34\\\"\\nCPE_NAME=\\\"cpe:/o:almalinux:almalinux:8.3:beta\\\"\\nHOME_URL=\\\"https://almalinux.org/\\\"\\nBUG_REPORT_URL=\\\"https://bugs.almalinux.org/\\\"\\n\\nALMALINUX_MANTISBT_PROJECT=\\\"AlmaLinux-8\\\"
        \                       \\nALMALINUX_MANTISBT_PROJECT_VERSION=\\\"8\\\"                       \\n\\n\",\n+
        \       \"/usr/lib/os-release\": \"NAME=\\\"AlmaLinux\\\"\\nVERSION=\\\"8.3
        (Purple Manul)\\\"\\nID=\\\"almalinux\\\"\\nID_LIKE=\\\"rhel centos fedora\\\"\\nVERSION_ID=\\\"8.3\\\"\\nPLATFORM_ID=\\\"platform:el8\\\"\\nPRETTY_NAME=\\\"AlmaLinux
        8.3 Beta (Purple Manul)\\\"\\nANSI_COLOR=\\\"0;34\\\"\\nCPE_NAME=\\\"cpe:/o:almalinux:almalinux:8.3:beta\\\"\\nHOME_URL=\\\"https://almalinux.org/\\\"\\nBUG_REPORT_URL=\\\"https://bugs.almalinux.org/\\\"\\n\\nALMALINUX_MANTISBT_PROJECT=\\\"AlmaLinux-8\\\"
        \                       \\nALMALINUX_MANTISBT_PROJECT_VERSION=\\\"8\\\"                       \\n\\n\"\n+
        \   },\n+    \"platform.dist\": [\n+        \"almalinux\",\n+        \"8.3\",\n+
        \       \"Purple Manul\"\n+    ],\n+    \"result\": {\n+        \"distribution\":
        \"AlmaLinux\",\n+        \"distribution_version\": \"8.3\",\n+        \"distribution_release\":
        \"Purple Manul\",\n+        \"distribution_major_version\": \"8\",\n+        \"os_family\":
        \"RedHat\"\n+    },\n+    \"platform.release\": \"4.18.0-240.el8.x86_64\"\n+}\n"
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Content-Encoding:
      - gzip
      Content-Security-Policy:
      - 'default-src ''none''; base-uri ''self''; block-all-mixed-content; connect-src
        ''self'' uploads.github.com www.githubstatus.com collector.githubapp.com api.github.com
        github-cloud.s3.amazonaws.com github-production-repository-file-5c1aeb.s3.amazonaws.com
        github-production-upload-manifest-file-7fdce7.s3.amazonaws.com github-production-user-asset-6210df.s3.amazonaws.com
        cdn.optimizely.com logx.optimizely.com/v1/events wss://alive.github.com; font-src
        github.githubassets.com; form-action ''self'' github.com gist.github.com;
        frame-ancestors ''none''; frame-src render.githubusercontent.com; img-src
        ''self'' data: github.githubassets.com identicons.github.com collector.githubapp.com
        github-cloud.s3.amazonaws.com user-images.githubusercontent.com/ *.githubusercontent.com;
        manifest-src ''self''; media-src ''none''; script-src github.githubassets.com;
        style-src ''unsafe-inline'' github.githubassets.com; worker-src github.com/socket-worker-5029ae85.js
        gist.github.com/socket-worker-5029ae85.js'
      Content-Type:
      - text/plain; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:39 GMT
      Etag:
      - W/"04014d3dc76f848ff6231b038782447d"
      Expect-CT:
      - max-age=2592000, report-uri="https://api.github.com/_private/browser/errors"
      Referrer-Policy:
      - origin-when-cross-origin, strict-origin-when-cross-origin
      Server:
      - GitHub.com
      Set-Cookie:
      - logged_in=no; domain=.github.com; path=/; expires=Sun, 27 Feb 2022 07:10:39
        GMT; secure; HttpOnly; SameSite=Lax
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - X-PJAX
      - Accept-Encoding, Accept, X-Requested-With
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Request-Id:
      - D35C:1A52:95E134:B71800:6039F06F
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
    url: https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73541.diff
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Cookie:
      - logged_in=no
    method: GET
    uri: https://api.github.com/repos/ansible/ansible/pulls/73541
  response:
    body:
      string: "{\"url\":\"https://api.github.com/repos/ansible/ansible/pulls/73541\",\"id\":570476127,\"node_id\":\"MDExOlB1bGxSZXF1ZXN0NTcwNDc2MTI3\",\"html_url\":\"https://github.com/ansible/ansible/pull/73541\",\"diff_url\":\"https://github.com/ansible/ansible/pull/73541.diff\",\"patch_url\":\"https://github.com/ansible/ansible/pull/73541.patch\",\"issue_url\":\"https://api.github.com/repos/ansible/ansible/issues/73541\",\"number\":73541,\"state\":\"closed\",\"locked\":false,\"title\":\"Add
        AlmaLinux to the family of Red Hat-like operating systems\",\"user\":{\"login\":\"samdoran\",\"id\":4047861,\"node_id\":\"MDQ6VXNlcjQwNDc4NjE=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/4047861?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/samdoran\",\"html_url\":\"https://github.com/samdoran\",\"followers_url\":\"https://api.github.com/users/samdoran/followers\",\"following_url\":\"https://api.github.com/users/samdoran/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/samdoran/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/samdoran/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/samdoran/subscriptions\",\"organizations_url\":\"https://api.github.com/users/samdoran/orgs\",\"repos_url\":\"https://api.github.com/users/samdoran/repos\",\"events_url\":\"https://api.github.com/users/samdoran/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/samdoran/received_events\",\"type\":\"User\",\"site_admin\":false},\"body\":\"#####
        SUMMARY\\r\\n<!--- Describe the change below, including rationale and design
        decisions -->\\r\\nReplaces #73458\\r\\n<!--- HINT: Include \\\"Fixes #nnn\\\"
        if you are fixing an existing issue -->\\r\\n\\r\\n##### ISSUE TYPE\\r\\n<!---
        Pick one below and delete the rest -->\\r\\n- Bugfix Pull Request\\r\\n\\r\\n#####
        COMPONENT NAME\\r\\n<!--- Write the short name of the module, plugin, task
        or feature below -->\\r\\n`lib/ansible/module_utils/facts/system/distribution.py`\",\"created_at\":\"2021-02-09T17:35:47Z\",\"updated_at\":\"2021-02-11T18:59:55Z\",\"closed_at\":\"2021-02-09T18:04:39Z\",\"merged_at\":\"2021-02-09T18:04:39Z\",\"merge_commit_sha\":\"2f5c83dfb1855342389436e72d64cf7afe9698e6\",\"assignee\":null,\"assignees\":[],\"requested_reviewers\":[],\"requested_teams\":[],\"labels\":[{\"id\":1742671738,\"node_id\":\"MDU6TGFiZWwxNzQyNjcxNzM4\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/affects_2.11\",\"name\":\"affects_2.11\",\"color\":\"5319e7\",\"default\":false,\"description\":\"\"},{\"id\":785271699,\"node_id\":\"MDU6TGFiZWw3ODUyNzE2OTk=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/bug\",\"name\":\"bug\",\"color\":\"fbca04\",\"default\":true,\"description\":\"This
        issue/PR relates to a bug.\"},{\"id\":513652538,\"node_id\":\"MDU6TGFiZWw1MTM2NTI1Mzg=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/core_review\",\"name\":\"core_review\",\"color\":\"ededed\",\"default\":false,\"description\":\"In
        order to be merged, this PR must follow the core review workflow.\"},{\"id\":636327968,\"node_id\":\"MDU6TGFiZWw2MzYzMjc5Njg=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/support:community\",\"name\":\"support:community\",\"color\":\"ededed\",\"default\":false,\"description\":\"This
        issue/PR relates to code supported by the Ansible community.\"},{\"id\":636352796,\"node_id\":\"MDU6TGFiZWw2MzYzNTI3OTY=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/support:core\",\"name\":\"support:core\",\"color\":\"ededed\",\"default\":false,\"description\":\"This
        issue/PR relates to code supported by the Ansible Engineering Team.\"}],\"milestone\":null,\"draft\":false,\"commits_url\":\"https://api.github.com/repos/ansible/ansible/pulls/73541/commits\",\"review_comments_url\":\"https://api.github.com/repos/ansible/ansible/pulls/73541/comments\",\"review_comment_url\":\"https://api.github.com/repos/ansible/ansible/pulls/comments{/number}\",\"comments_url\":\"https://api.github.com/repos/ansible/ansible/issues/73541/comments\",\"statuses_url\":\"https://api.github.com/repos/ansible/ansible/statuses/3ea9b87e7ee0c0dcb807a22bf4584732d90ed881\",\"head\":{\"label\":\"samdoran:add-alma-linux\",\"ref\":\"add-alma-linux\",\"sha\":\"3ea9b87e7ee0c0dcb807a22bf4584732d90ed881\",\"user\":{\"login\":\"samdoran\",\"id\":4047861,\"node_id\":\"MDQ6VXNlcjQwNDc4NjE=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/4047861?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/samdoran\",\"html_url\":\"https://github.com/samdoran\",\"followers_url\":\"https://api.github.com/users/samdoran/followers\",\"following_url\":\"https://api.github.com/users/samdoran/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/samdoran/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/samdoran/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/samdoran/subscriptions\",\"organizations_url\":\"https://api.github.com/users/samdoran/orgs\",\"repos_url\":\"https://api.github.com/users/samdoran/repos\",\"events_url\":\"https://api.github.com/users/samdoran/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/samdoran/received_events\",\"type\":\"User\",\"site_admin\":false},\"repo\":{\"id\":70726272,\"node_id\":\"MDEwOlJlcG9zaXRvcnk3MDcyNjI3Mg==\",\"name\":\"ansible\",\"full_name\":\"samdoran/ansible\",\"private\":false,\"owner\":{\"login\":\"samdoran\",\"id\":4047861,\"node_id\":\"MDQ6VXNlcjQwNDc4NjE=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/4047861?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/samdoran\",\"html_url\":\"https://github.com/samdoran\",\"followers_url\":\"https://api.github.com/users/samdoran/followers\",\"following_url\":\"https://api.github.com/users/samdoran/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/samdoran/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/samdoran/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/samdoran/subscriptions\",\"organizations_url\":\"https://api.github.com/users/samdoran/orgs\",\"repos_url\":\"https://api.github.com/users/samdoran/repos\",\"events_url\":\"https://api.github.com/users/samdoran/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/samdoran/received_events\",\"type\":\"User\",\"site_admin\":false},\"html_url\":\"https://github.com/samdoran/ansible\",\"description\":\"Ansible
        is a radically simple IT automation platform that makes your applications
        and systems easier to deploy. Avoid writing scripts or custom code to deploy
        and update your applications\u2014 automate in a language that approaches
        plain English, using SSH, with no agents to install on remote systems.\",\"fork\":true,\"url\":\"https://api.github.com/repos/samdoran/ansible\",\"forks_url\":\"https://api.github.com/repos/samdoran/ansible/forks\",\"keys_url\":\"https://api.github.com/repos/samdoran/ansible/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/samdoran/ansible/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/samdoran/ansible/teams\",\"hooks_url\":\"https://api.github.com/repos/samdoran/ansible/hooks\",\"issue_events_url\":\"https://api.github.com/repos/samdoran/ansible/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/samdoran/ansible/events\",\"assignees_url\":\"https://api.github.com/repos/samdoran/ansible/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/samdoran/ansible/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/samdoran/ansible/tags\",\"blobs_url\":\"https://api.github.com/repos/samdoran/ansible/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/samdoran/ansible/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/samdoran/ansible/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/samdoran/ansible/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/samdoran/ansible/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/samdoran/ansible/languages\",\"stargazers_url\":\"https://api.github.com/repos/samdoran/ansible/stargazers\",\"contributors_url\":\"https://api.github.com/repos/samdoran/ansible/contributors\",\"subscribers_url\":\"https://api.github.com/repos/samdoran/ansible/subscribers\",\"subscription_url\":\"https://api.github.com/repos/samdoran/ansible/subscription\",\"commits_url\":\"https://api.github.com/repos/samdoran/ansible/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/samdoran/ansible/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/samdoran/ansible/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/samdoran/ansible/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/samdoran/ansible/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/samdoran/ansible/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/samdoran/ansible/merges\",\"archive_url\":\"https://api.github.com/repos/samdoran/ansible/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/samdoran/ansible/downloads\",\"issues_url\":\"https://api.github.com/repos/samdoran/ansible/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/samdoran/ansible/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/samdoran/ansible/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/samdoran/ansible/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/samdoran/ansible/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/samdoran/ansible/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/samdoran/ansible/deployments\",\"created_at\":\"2016-10-12T17:53:34Z\",\"updated_at\":\"2020-11-19T13:40:09Z\",\"pushed_at\":\"2021-02-26T15:28:41Z\",\"git_url\":\"git://github.com/samdoran/ansible.git\",\"ssh_url\":\"git@github.com:samdoran/ansible.git\",\"clone_url\":\"https://github.com/samdoran/ansible.git\",\"svn_url\":\"https://github.com/samdoran/ansible\",\"homepage\":\"http://ansible.com/\",\"size\":187311,\"stargazers_count\":1,\"watchers_count\":1,\"language\":\"Python\",\"has_issues\":false,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":false,\"has_pages\":false,\"forks_count\":1,\"mirror_url\":null,\"archived\":false,\"disabled\":false,\"open_issues_count\":0,\"license\":{\"key\":\"gpl-3.0\",\"name\":\"GNU
        General Public License v3.0\",\"spdx_id\":\"GPL-3.0\",\"url\":\"https://api.github.com/licenses/gpl-3.0\",\"node_id\":\"MDc6TGljZW5zZTk=\"},\"forks\":1,\"open_issues\":0,\"watchers\":1,\"default_branch\":\"devel\"}},\"base\":{\"label\":\"ansible:devel\",\"ref\":\"devel\",\"sha\":\"ca448f7c350fae8080dcfec648342d2fc8837da0\",\"user\":{\"login\":\"ansible\",\"id\":1507452,\"node_id\":\"MDEyOk9yZ2FuaXphdGlvbjE1MDc0NTI=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/1507452?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/ansible\",\"html_url\":\"https://github.com/ansible\",\"followers_url\":\"https://api.github.com/users/ansible/followers\",\"following_url\":\"https://api.github.com/users/ansible/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/ansible/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/ansible/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/ansible/subscriptions\",\"organizations_url\":\"https://api.github.com/users/ansible/orgs\",\"repos_url\":\"https://api.github.com/users/ansible/repos\",\"events_url\":\"https://api.github.com/users/ansible/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/ansible/received_events\",\"type\":\"Organization\",\"site_admin\":false},\"repo\":{\"id\":3638964,\"node_id\":\"MDEwOlJlcG9zaXRvcnkzNjM4OTY0\",\"name\":\"ansible\",\"full_name\":\"ansible/ansible\",\"private\":false,\"owner\":{\"login\":\"ansible\",\"id\":1507452,\"node_id\":\"MDEyOk9yZ2FuaXphdGlvbjE1MDc0NTI=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/1507452?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/ansible\",\"html_url\":\"https://github.com/ansible\",\"followers_url\":\"https://api.github.com/users/ansible/followers\",\"following_url\":\"https://api.github.com/users/ansible/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/ansible/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/ansible/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/ansible/subscriptions\",\"organizations_url\":\"https://api.github.com/users/ansible/orgs\",\"repos_url\":\"https://api.github.com/users/ansible/repos\",\"events_url\":\"https://api.github.com/users/ansible/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/ansible/received_events\",\"type\":\"Organization\",\"site_admin\":false},\"html_url\":\"https://github.com/ansible/ansible\",\"description\":\"Ansible
        is a radically simple IT automation platform that makes your applications
        and systems easier to deploy and maintain. Automate everything from code deployment
        to network configuration to cloud management, in a language that approaches
        plain English, using SSH, with no agents to install on remote systems. https://docs.ansible.com.\",\"fork\":false,\"url\":\"https://api.github.com/repos/ansible/ansible\",\"forks_url\":\"https://api.github.com/repos/ansible/ansible/forks\",\"keys_url\":\"https://api.github.com/repos/ansible/ansible/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/ansible/ansible/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/ansible/ansible/teams\",\"hooks_url\":\"https://api.github.com/repos/ansible/ansible/hooks\",\"issue_events_url\":\"https://api.github.com/repos/ansible/ansible/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/ansible/ansible/events\",\"assignees_url\":\"https://api.github.com/repos/ansible/ansible/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/ansible/ansible/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/ansible/ansible/tags\",\"blobs_url\":\"https://api.github.com/repos/ansible/ansible/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/ansible/ansible/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/ansible/ansible/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/ansible/ansible/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/ansible/ansible/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/ansible/ansible/languages\",\"stargazers_url\":\"https://api.github.com/repos/ansible/ansible/stargazers\",\"contributors_url\":\"https://api.github.com/repos/ansible/ansible/contributors\",\"subscribers_url\":\"https://api.github.com/repos/ansible/ansible/subscribers\",\"subscription_url\":\"https://api.github.com/repos/ansible/ansible/subscription\",\"commits_url\":\"https://api.github.com/repos/ansible/ansible/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/ansible/ansible/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/ansible/ansible/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/ansible/ansible/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/ansible/ansible/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/ansible/ansible/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/ansible/ansible/merges\",\"archive_url\":\"https://api.github.com/repos/ansible/ansible/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/ansible/ansible/downloads\",\"issues_url\":\"https://api.github.com/repos/ansible/ansible/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/ansible/ansible/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/ansible/ansible/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/ansible/ansible/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/ansible/ansible/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/ansible/ansible/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/ansible/ansible/deployments\",\"created_at\":\"2012-03-06T14:58:02Z\",\"updated_at\":\"2021-02-27T02:40:42Z\",\"pushed_at\":\"2021-02-27T06:00:14Z\",\"git_url\":\"git://github.com/ansible/ansible.git\",\"ssh_url\":\"org-1507452@github.com:ansible/ansible.git\",\"clone_url\":\"https://github.com/ansible/ansible.git\",\"svn_url\":\"https://github.com/ansible/ansible\",\"homepage\":\"https://www.ansible.com/\",\"size\":194931,\"stargazers_count\":47033,\"watchers_count\":47033,\"language\":\"Python\",\"has_issues\":true,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":false,\"has_pages\":false,\"forks_count\":20311,\"mirror_url\":null,\"archived\":false,\"disabled\":false,\"open_issues_count\":1892,\"license\":{\"key\":\"gpl-3.0\",\"name\":\"GNU
        General Public License v3.0\",\"spdx_id\":\"GPL-3.0\",\"url\":\"https://api.github.com/licenses/gpl-3.0\",\"node_id\":\"MDc6TGljZW5zZTk=\"},\"forks\":20311,\"open_issues\":1892,\"watchers\":47033,\"default_branch\":\"devel\"}},\"_links\":{\"self\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/73541\"},\"html\":{\"href\":\"https://github.com/ansible/ansible/pull/73541\"},\"issue\":{\"href\":\"https://api.github.com/repos/ansible/ansible/issues/73541\"},\"comments\":{\"href\":\"https://api.github.com/repos/ansible/ansible/issues/73541/comments\"},\"review_comments\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/73541/comments\"},\"review_comment\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/comments{/number}\"},\"commits\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/73541/commits\"},\"statuses\":{\"href\":\"https://api.github.com/repos/ansible/ansible/statuses/3ea9b87e7ee0c0dcb807a22bf4584732d90ed881\"}},\"author_association\":\"MEMBER\",\"auto_merge\":null,\"active_lock_reason\":null,\"merged\":true,\"mergeable\":null,\"rebaseable\":null,\"mergeable_state\":\"unknown\",\"merged_by\":{\"login\":\"samdoran\",\"id\":4047861,\"node_id\":\"MDQ6VXNlcjQwNDc4NjE=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/4047861?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/samdoran\",\"html_url\":\"https://github.com/samdoran\",\"followers_url\":\"https://api.github.com/users/samdoran/followers\",\"following_url\":\"https://api.github.com/users/samdoran/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/samdoran/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/samdoran/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/samdoran/subscriptions\",\"organizations_url\":\"https://api.github.com/users/samdoran/orgs\",\"repos_url\":\"https://api.github.com/users/samdoran/repos\",\"events_url\":\"https://api.github.com/users/samdoran/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/samdoran/received_events\",\"type\":\"User\",\"site_admin\":false},\"comments\":0,\"review_comments\":0,\"maintainer_can_modify\":false,\"commits\":4,\"additions\":56,\"deletions\":1,\"changed_files\":3}"
    headers:
      Access-Control-Allow-Origin:
      - '*'
      Access-Control-Expose-Headers:
      - ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining,
        X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes,
        X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset
      Cache-Control:
      - private, max-age=60, s-maxage=60
      Content-Encoding:
      - gzip
      Content-Security-Policy:
      - default-src 'none'
      Content-Type:
      - application/json; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:39 GMT
      Etag:
      - W/"20ada6c982942bf68ffe6595cc363f6614cba2f97b8bdf1fdab490456da9d887"
      Last-Modified:
      - Thu, 25 Feb 2021 15:44:45 GMT
      Referrer-Policy:
      - origin-when-cross-origin, strict-origin-when-cross-origin
      Server:
      - GitHub.com
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - Accept, Authorization, Cookie, X-GitHub-OTP
      - Accept-Encoding, Accept, X-Requested-With
      X-Accepted-OAuth-Scopes:
      - ''
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Media-Type:
      - github.cloak-preview, github.groot-preview; format=json
      X-GitHub-Request-Id:
      - AAC0:74C8:29532:1A8572:6039F06F
      X-OAuth-Scopes:
      - repo, workflow
      X-RateLimit-Limit:
      - '5000'
      X-RateLimit-Remaining:
      - '4946'
      X-RateLimit-Reset:
      - '1614412319'
      X-XSS-Protection:
      - 1; mode=block
      x-ratelimit-used:
      - '54'
    status:
      code: 200
      message: OK
    url: https://api.github.com/repos/ansible/ansible/pulls/73541
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Accept-Encoding:
      - gzip, deflate
      Cookie:
      - logged_in=no
      Host:
      - github.com
      User-Agent:
      - Python/3.8 aiohttp/3.7.3
    method: GET
    uri: https://github.com/ansible/ansible/pull/73541.diff
  response:
    body: {}
    headers:
      Cache-Control:
      - no-cache
      Content-Security-Policy:
      - 'default-src ''none''; base-uri ''self''; block-all-mixed-content; connect-src
        ''self'' uploads.github.com www.githubstatus.com collector.githubapp.com api.github.com
        github-cloud.s3.amazonaws.com github-production-repository-file-5c1aeb.s3.amazonaws.com
        github-production-upload-manifest-file-7fdce7.s3.amazonaws.com github-production-user-asset-6210df.s3.amazonaws.com
        cdn.optimizely.com logx.optimizely.com/v1/events wss://alive.github.com online.visualstudio.com/api/v1/locations;
        font-src github.githubassets.com; form-action ''self'' github.com gist.github.com;
        frame-ancestors ''none''; frame-src render.githubusercontent.com; img-src
        ''self'' data: github.githubassets.com identicons.github.com collector.githubapp.com
        github-cloud.s3.amazonaws.com user-images.githubusercontent.com/ *.githubusercontent.com;
        manifest-src ''self''; media-src ''none''; script-src github.githubassets.com;
        style-src ''unsafe-inline'' github.githubassets.com; worker-src github.com/socket-worker-5029ae85.js
        gist.github.com/socket-worker-5029ae85.js'
      Content-Type:
      - text/html; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:39 GMT
      Expect-CT:
      - max-age=2592000, report-uri="https://api.github.com/_private/browser/errors"
      Location:
      - https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73541.diff
      Referrer-Policy:
      - no-referrer-when-downgrade
      Server:
      - GitHub.com
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - X-PJAX
      - Accept-Encoding, Accept, X-Requested-With
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Request-Id:
      - D35A:3DBA:657A6F:854007:6039F06F
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 302
      message: Found
    url: https://github.com/ansible/ansible/pull/73541.diff
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Accept-Encoding:
      - gzip, deflate
      Host:
      - patch-diff.githubusercontent.com
      User-Agent:
      - Python/3.8 aiohttp/3.7.3
    method: GET
    uri: https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73541.diff
  response:
    body:
      string: "diff --git a/changelogs/fragments/support_almalinux.yml b/changelogs/fragments/support_almalinux.yml\nnew
        file mode 100644\nindex 0000000000000..4dbc040a62f1e\n--- /dev/null\n+++ b/changelogs/fragments/support_almalinux.yml\n@@
        -0,0 +1,2 @@\n+bugfixes:\n+  - add AlmaLinux to fact gathering (https://github.com/ansible/ansible/pull/73458)\ndiff
        --git a/lib/ansible/module_utils/facts/system/distribution.py b/lib/ansible/module_utils/facts/system/distribution.py\nindex
        a31aa197f573e..fd49b3a6fbd06 100644\n--- a/lib/ansible/module_utils/facts/system/distribution.py\n+++
        b/lib/ansible/module_utils/facts/system/distribution.py\n@@ -464,7 +464,7
        @@ class Distribution(object):\n     OS_FAMILY_MAP = {'RedHat': ['RedHat',
        'Fedora', 'CentOS', 'Scientific', 'SLC',\n                                 'Ascendos',
        'CloudLinux', 'PSBM', 'OracleLinux', 'OVS',\n                                 'OEL',
        'Amazon', 'Virtuozzo', 'XenServer', 'Alibaba',\n-                                'EulerOS',
        'openEuler'],\n+                                'EulerOS', 'openEuler', 'AlmaLinux'],\n
        \                     'Debian': ['Debian', 'Ubuntu', 'Raspbian', 'Neon', 'KDE
        neon',\n                                 'Linux Mint', 'SteamOS', 'Devuan',
        'Kali', 'Cumulus Linux',\n                                 'Pop!_OS', 'Parrot',
        'Pardus GNU/Linux'],\ndiff --git a/test/units/module_utils/facts/system/distribution/fixtures/almalinux_8_3_beta.json
        b/test/units/module_utils/facts/system/distribution/fixtures/almalinux_8_3_beta.json\nnew
        file mode 100644\nindex 0000000000000..2d8df50bf1275\n--- /dev/null\n+++ b/test/units/module_utils/facts/system/distribution/fixtures/almalinux_8_3_beta.json\n@@
        -0,0 +1,53 @@\n+{\n+    \"name\": \"AlmaLinux 8.3\",\n+    \"distro\": {\n+
        \       \"codename\": \"Purple Manul\",\n+        \"id\": \"almalinux\",\n+
        \       \"name\": \"AlmaLinux\",\n+        \"version\": \"8.3\",\n+        \"version_best\":
        \"8.3\",\n+        \"lsb_release_info\": {\n+            \"lsb_version\":
        \":core-4.1-amd64:core-4.1-noarch\",\n+            \"distributor_id\": \"AlmaLinux\",\n+
        \           \"description\": \"AlmaLinux release 8.3 Beta (Purple Manul)\",\n+
        \           \"release\": \"8.3\",\n+            \"codename\": \"PurpleManul\"\n+
        \       },\n+        \"os_release_info\": {\n+            \"name\": \"AlmaLinux\",\n+
        \           \"version\": \"8.3 (Purple Manul)\",\n+            \"id\": \"almalinux\",\n+
        \           \"id_like\": \"rhel centos fedora\",\n+            \"version_id\":
        \"8.3\",\n+            \"platform_id\": \"platform:el8\",\n+            \"pretty_name\":
        \"AlmaLinux 8.3 Beta (Purple Manul)\",\n+            \"ansi_color\": \"0;34\",\n+
        \           \"cpe_name\": \"cpe:/o:almalinux:almalinux:8.3:beta\",\n+            \"home_url\":
        \"https://almalinux.org/\",\n+            \"bug_report_url\": \"https://bugs.almalinux.org/\",\n+
        \           \"almalinux_mantisbt_project\": \"AlmaLinux-8\",\n+            \"almalinux_mantisbt_project_version\":
        \"8\",\n+            \"codename\": \"Purple Manul\"\n+        }\n+    },\n+
        \   \"input\": {\n+        \"/etc/centos-release\": \"AlmaLinux release 8.3
        Beta (Purple Manul)\\n\",\n+        \"/etc/redhat-release\": \"AlmaLinux release
        8.3 Beta (Purple Manul)\\n\",\n+        \"/etc/system-release\": \"AlmaLinux
        release 8.3 Beta (Purple Manul)\\n\",\n+        \"/etc/os-release\": \"NAME=\\\"AlmaLinux\\\"\\nVERSION=\\\"8.3
        (Purple Manul)\\\"\\nID=\\\"almalinux\\\"\\nID_LIKE=\\\"rhel centos fedora\\\"\\nVERSION_ID=\\\"8.3\\\"\\nPLATFORM_ID=\\\"platform:el8\\\"\\nPRETTY_NAME=\\\"AlmaLinux
        8.3 Beta (Purple Manul)\\\"\\nANSI_COLOR=\\\"0;34\\\"\\nCPE_NAME=\\\"cpe:/o:almalinux:almalinux:8.3:beta\\\"\\nHOME_URL=\\\"https://almalinux.org/\\\"\\nBUG_REPORT_URL=\\\"https://bugs.almalinux.org/\\\"\\n\\nALMALINUX_MANTISBT_PROJECT=\\\"AlmaLinux-8\\\"
        \                       \\nALMALINUX_MANTISBT_PROJECT_VERSION=\\\"8\\\"                       \\n\\n\",\n+
        \       \"/usr/lib/os-release\": \"NAME=\\\"AlmaLinux\\\"\\nVERSION=\\\"8.3
        (Purple Manul)\\\"\\nID=\\\"almalinux\\\"\\nID_LIKE=\\\"rhel centos fedora\\\"\\nVERSION_ID=\\\"8.3\\\"\\nPLATFORM_ID=\\\"platform:el8\\\"\\nPRETTY_NAME=\\\"AlmaLinux
        8.3 Beta (Purple Manul)\\\"\\nANSI_COLOR=\\\"0;34\\\"\\nCPE_NAME=\\\"cpe:/o:almalinux:almalinux:8.3:beta\\\"\\nHOME_URL=\\\"https://almalinux.org/\\\"\\nBUG_REPORT_URL=\\\"https://bugs.almalinux.org/\\\"\\n\\nALMALINUX_MANTISBT_PROJECT=\\\"AlmaLinux-8\\\"
        \                       \\nALMALINUX_MANTISBT_PROJECT_VERSION=\\\"8\\\"                       \\n\\n\"\n+
        \   },\n+    \"platform.dist\": [\n+        \"almalinux\",\n+        \"8.3\",\n+
        \       \"Purple Manul\"\n+    ],\n+    \"result\": {\n+        \"distribution\":
        \"AlmaLinux\",\n+        \"distribution_version\": \"8.3\",\n+        \"distribution_release\":
        \"Purple Manul\",\n+        \"distribution_major_version\": \"8\",\n+        \"os_family\":
        \"RedHat\"\n+    },\n+    \"platform.release\": \"4.18.0-240.el8.x86_64\"\n+}\n"
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Content-Encoding:
      - gzip
      Content-Security-Policy:
      - 'default-src ''none''; base-uri ''self''; block-all-mixed-content; connect-src
        ''self'' uploads.github.com www.githubstatus.com collector.githubapp.com api.github.com
        github-cloud.s3.amazonaws.com github-production-repository-file-5c1aeb.s3.amazonaws.com
        github-production-upload-manifest-file-7fdce7.s3.amazonaws.com github-production-user-asset-6210df.s3.amazonaws.com
        cdn.optimizely.com logx.optimizely.com/v1/events wss://alive.github.com; font-src
        github.githubassets.com; form-action ''self'' github.com gist.github.com;
        frame-ancestors ''none''; frame-src render.githubusercontent.com; img-src
        ''self'' data: github.githubassets.com identicons.github.com collector.githubapp.com
        github-cloud.s3.amazonaws.com user-images.githubusercontent.com/ *.githubusercontent.com;
        manifest-src ''self''; media-src ''none''; script-src github.githubassets.com;
        style-src ''unsafe-inline'' github.githubassets.com; worker-src github.com/socket-worker-5029ae85.js
        gist.github.com/socket-worker-5029ae85.js'
      Content-Type:
      - text/plain; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:39 GMT
      Etag:
      - W/"04014d3dc76f848ff6231b038782447d"
      Expect-CT:
      - max-age=2592000, report-uri="https://api.github.com/_private/browser/errors"
      Referrer-Policy:
      - origin-when-cross-origin, strict-origin-when-cross-origin
      Server:
      - GitHub.com
      Set-Cookie:
      - logged_in=no; domain=.github.com; path=/; expires=Sun, 27 Feb 2022 07:10:39
        GMT; secure; HttpOnly; SameSite=Lax
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - X-PJAX
      - Accept-Encoding, Accept, X-Requested-With
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Request-Id:
      - D35C:1A52:95E17D:B7185E:6039F06F
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
    url: https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73541.diff
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Cookie:
      - logged_in=no
    method: GET
    uri: https://api.github.com/repos/ansible/ansible/pulls/73493
  response:
    body:
      string: "{\"url\":\"https://api.github.com/repos/ansible/ansible/pulls/73493\",\"id\":567978006,\"node_id\":\"MDExOlB1bGxSZXF1ZXN0NTY3OTc4MDA2\",\"html_url\":\"https://github.com/ansible/ansible/pull/73493\",\"diff_url\":\"https://github.com/ansible/ansible/pull/73493.diff\",\"patch_url\":\"https://github.com/ansible/ansible/pull/73493.patch\",\"issue_url\":\"https://api.github.com/repos/ansible/ansible/issues/73493\",\"number\":73493,\"state\":\"closed\",\"locked\":false,\"title\":\"no_log
        mask suboption fallback values and defaults CVE-2021-20228 - 2.9\",\"user\":{\"login\":\"jborean93\",\"id\":8462645,\"node_id\":\"MDQ6VXNlcjg0NjI2NDU=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/8462645?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/jborean93\",\"html_url\":\"https://github.com/jborean93\",\"followers_url\":\"https://api.github.com/users/jborean93/followers\",\"following_url\":\"https://api.github.com/users/jborean93/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/jborean93/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/jborean93/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/jborean93/subscriptions\",\"organizations_url\":\"https://api.github.com/users/jborean93/orgs\",\"repos_url\":\"https://api.github.com/users/jborean93/repos\",\"events_url\":\"https://api.github.com/users/jborean93/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/jborean93/received_events\",\"type\":\"User\",\"site_admin\":false},\"body\":\"(cherry
        picked from commit 0cdc410dce6658e93c06fa27e0100ddbb11e7015)\\r\\n\\r\\n#####
        SUMMARY\\r\\nBackport of https://github.com/ansible/ansible/pull/73487\\r\\n\\r\\n#####
        ISSUE TYPE\\r\\n- Bugfix Pull Request\\r\\n\\r\\n##### COMPONENT NAME\\r\\nbasic.py\",\"created_at\":\"2021-02-04T23:20:43Z\",\"updated_at\":\"2021-02-17T22:45:20Z\",\"closed_at\":\"2021-02-07T06:07:57Z\",\"merged_at\":\"2021-02-07T06:07:57Z\",\"merge_commit_sha\":\"49ebd509df9de1c1fc1bcee00e79a835dd00662c\",\"assignee\":null,\"assignees\":[],\"requested_reviewers\":[],\"requested_teams\":[],\"labels\":[{\"id\":1316917295,\"node_id\":\"MDU6TGFiZWwxMzE2OTE3Mjk1\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/affects_2.9\",\"name\":\"affects_2.9\",\"color\":\"5319e7\",\"default\":false,\"description\":\"This
        issue/PR affects Ansible v2.9\"},{\"id\":266246971,\"node_id\":\"MDU6TGFiZWwyNjYyNDY5NzE=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/backport\",\"name\":\"backport\",\"color\":\"00ff00\",\"default\":false,\"description\":\"This
        PR does not target the devel branch.\"},{\"id\":785271699,\"node_id\":\"MDU6TGFiZWw3ODUyNzE2OTk=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/bug\",\"name\":\"bug\",\"color\":\"fbca04\",\"default\":true,\"description\":\"This
        issue/PR relates to a bug.\"},{\"id\":513652538,\"node_id\":\"MDU6TGFiZWw1MTM2NTI1Mzg=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/core_review\",\"name\":\"core_review\",\"color\":\"ededed\",\"default\":false,\"description\":\"In
        order to be merged, this PR must follow the core review workflow.\"},{\"id\":636327968,\"node_id\":\"MDU6TGFiZWw2MzYzMjc5Njg=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/support:community\",\"name\":\"support:community\",\"color\":\"ededed\",\"default\":false,\"description\":\"This
        issue/PR relates to code supported by the Ansible community.\"},{\"id\":636352796,\"node_id\":\"MDU6TGFiZWw2MzYzNTI3OTY=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/support:core\",\"name\":\"support:core\",\"color\":\"ededed\",\"default\":false,\"description\":\"This
        issue/PR relates to code supported by the Ansible Engineering Team.\"}],\"milestone\":null,\"draft\":false,\"commits_url\":\"https://api.github.com/repos/ansible/ansible/pulls/73493/commits\",\"review_comments_url\":\"https://api.github.com/repos/ansible/ansible/pulls/73493/comments\",\"review_comment_url\":\"https://api.github.com/repos/ansible/ansible/pulls/comments{/number}\",\"comments_url\":\"https://api.github.com/repos/ansible/ansible/issues/73493/comments\",\"statuses_url\":\"https://api.github.com/repos/ansible/ansible/statuses/c9fbf167d46985737f6c39069bebb2156a4f8f00\",\"head\":{\"label\":\"jborean93:nolog-suboptions-2.9\",\"ref\":\"nolog-suboptions-2.9\",\"sha\":\"c9fbf167d46985737f6c39069bebb2156a4f8f00\",\"user\":{\"login\":\"jborean93\",\"id\":8462645,\"node_id\":\"MDQ6VXNlcjg0NjI2NDU=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/8462645?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/jborean93\",\"html_url\":\"https://github.com/jborean93\",\"followers_url\":\"https://api.github.com/users/jborean93/followers\",\"following_url\":\"https://api.github.com/users/jborean93/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/jborean93/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/jborean93/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/jborean93/subscriptions\",\"organizations_url\":\"https://api.github.com/users/jborean93/orgs\",\"repos_url\":\"https://api.github.com/users/jborean93/repos\",\"events_url\":\"https://api.github.com/users/jborean93/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/jborean93/received_events\",\"type\":\"User\",\"site_admin\":false},\"repo\":{\"id\":72729201,\"node_id\":\"MDEwOlJlcG9zaXRvcnk3MjcyOTIwMQ==\",\"name\":\"ansible\",\"full_name\":\"jborean93/ansible\",\"private\":false,\"owner\":{\"login\":\"jborean93\",\"id\":8462645,\"node_id\":\"MDQ6VXNlcjg0NjI2NDU=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/8462645?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/jborean93\",\"html_url\":\"https://github.com/jborean93\",\"followers_url\":\"https://api.github.com/users/jborean93/followers\",\"following_url\":\"https://api.github.com/users/jborean93/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/jborean93/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/jborean93/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/jborean93/subscriptions\",\"organizations_url\":\"https://api.github.com/users/jborean93/orgs\",\"repos_url\":\"https://api.github.com/users/jborean93/repos\",\"events_url\":\"https://api.github.com/users/jborean93/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/jborean93/received_events\",\"type\":\"User\",\"site_admin\":false},\"html_url\":\"https://github.com/jborean93/ansible\",\"description\":\"Ansible
        is a radically simple IT automation platform that makes your applications
        and systems easier to deploy. Avoid writing scripts or custom code to deploy
        and update your applications\u2014 automate in a language that approaches
        plain English, using SSH, with no agents to install on remote systems.\",\"fork\":true,\"url\":\"https://api.github.com/repos/jborean93/ansible\",\"forks_url\":\"https://api.github.com/repos/jborean93/ansible/forks\",\"keys_url\":\"https://api.github.com/repos/jborean93/ansible/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/jborean93/ansible/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/jborean93/ansible/teams\",\"hooks_url\":\"https://api.github.com/repos/jborean93/ansible/hooks\",\"issue_events_url\":\"https://api.github.com/repos/jborean93/ansible/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/jborean93/ansible/events\",\"assignees_url\":\"https://api.github.com/repos/jborean93/ansible/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/jborean93/ansible/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/jborean93/ansible/tags\",\"blobs_url\":\"https://api.github.com/repos/jborean93/ansible/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/jborean93/ansible/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/jborean93/ansible/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/jborean93/ansible/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/jborean93/ansible/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/jborean93/ansible/languages\",\"stargazers_url\":\"https://api.github.com/repos/jborean93/ansible/stargazers\",\"contributors_url\":\"https://api.github.com/repos/jborean93/ansible/contributors\",\"subscribers_url\":\"https://api.github.com/repos/jborean93/ansible/subscribers\",\"subscription_url\":\"https://api.github.com/repos/jborean93/ansible/subscription\",\"commits_url\":\"https://api.github.com/repos/jborean93/ansible/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/jborean93/ansible/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/jborean93/ansible/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/jborean93/ansible/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/jborean93/ansible/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/jborean93/ansible/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/jborean93/ansible/merges\",\"archive_url\":\"https://api.github.com/repos/jborean93/ansible/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/jborean93/ansible/downloads\",\"issues_url\":\"https://api.github.com/repos/jborean93/ansible/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/jborean93/ansible/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/jborean93/ansible/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/jborean93/ansible/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/jborean93/ansible/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/jborean93/ansible/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/jborean93/ansible/deployments\",\"created_at\":\"2016-11-03T09:27:23Z\",\"updated_at\":\"2021-02-26T00:49:47Z\",\"pushed_at\":\"2021-02-26T00:49:30Z\",\"git_url\":\"git://github.com/jborean93/ansible.git\",\"ssh_url\":\"git@github.com:jborean93/ansible.git\",\"clone_url\":\"https://github.com/jborean93/ansible.git\",\"svn_url\":\"https://github.com/jborean93/ansible\",\"homepage\":\"http://ansible.com/\",\"size\":173974,\"stargazers_count\":0,\"watchers_count\":0,\"language\":\"Python\",\"has_issues\":false,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":false,\"has_pages\":false,\"forks_count\":0,\"mirror_url\":null,\"archived\":false,\"disabled\":false,\"open_issues_count\":0,\"license\":{\"key\":\"gpl-3.0\",\"name\":\"GNU
        General Public License v3.0\",\"spdx_id\":\"GPL-3.0\",\"url\":\"https://api.github.com/licenses/gpl-3.0\",\"node_id\":\"MDc6TGljZW5zZTk=\"},\"forks\":0,\"open_issues\":0,\"watchers\":0,\"default_branch\":\"devel\"}},\"base\":{\"label\":\"ansible:stable-2.9\",\"ref\":\"stable-2.9\",\"sha\":\"e9838486bd6b7becf9dac0a94852aa320b4479e4\",\"user\":{\"login\":\"ansible\",\"id\":1507452,\"node_id\":\"MDEyOk9yZ2FuaXphdGlvbjE1MDc0NTI=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/1507452?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/ansible\",\"html_url\":\"https://github.com/ansible\",\"followers_url\":\"https://api.github.com/users/ansible/followers\",\"following_url\":\"https://api.github.com/users/ansible/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/ansible/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/ansible/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/ansible/subscriptions\",\"organizations_url\":\"https://api.github.com/users/ansible/orgs\",\"repos_url\":\"https://api.github.com/users/ansible/repos\",\"events_url\":\"https://api.github.com/users/ansible/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/ansible/received_events\",\"type\":\"Organization\",\"site_admin\":false},\"repo\":{\"id\":3638964,\"node_id\":\"MDEwOlJlcG9zaXRvcnkzNjM4OTY0\",\"name\":\"ansible\",\"full_name\":\"ansible/ansible\",\"private\":false,\"owner\":{\"login\":\"ansible\",\"id\":1507452,\"node_id\":\"MDEyOk9yZ2FuaXphdGlvbjE1MDc0NTI=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/1507452?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/ansible\",\"html_url\":\"https://github.com/ansible\",\"followers_url\":\"https://api.github.com/users/ansible/followers\",\"following_url\":\"https://api.github.com/users/ansible/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/ansible/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/ansible/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/ansible/subscriptions\",\"organizations_url\":\"https://api.github.com/users/ansible/orgs\",\"repos_url\":\"https://api.github.com/users/ansible/repos\",\"events_url\":\"https://api.github.com/users/ansible/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/ansible/received_events\",\"type\":\"Organization\",\"site_admin\":false},\"html_url\":\"https://github.com/ansible/ansible\",\"description\":\"Ansible
        is a radically simple IT automation platform that makes your applications
        and systems easier to deploy and maintain. Automate everything from code deployment
        to network configuration to cloud management, in a language that approaches
        plain English, using SSH, with no agents to install on remote systems. https://docs.ansible.com.\",\"fork\":false,\"url\":\"https://api.github.com/repos/ansible/ansible\",\"forks_url\":\"https://api.github.com/repos/ansible/ansible/forks\",\"keys_url\":\"https://api.github.com/repos/ansible/ansible/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/ansible/ansible/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/ansible/ansible/teams\",\"hooks_url\":\"https://api.github.com/repos/ansible/ansible/hooks\",\"issue_events_url\":\"https://api.github.com/repos/ansible/ansible/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/ansible/ansible/events\",\"assignees_url\":\"https://api.github.com/repos/ansible/ansible/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/ansible/ansible/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/ansible/ansible/tags\",\"blobs_url\":\"https://api.github.com/repos/ansible/ansible/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/ansible/ansible/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/ansible/ansible/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/ansible/ansible/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/ansible/ansible/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/ansible/ansible/languages\",\"stargazers_url\":\"https://api.github.com/repos/ansible/ansible/stargazers\",\"contributors_url\":\"https://api.github.com/repos/ansible/ansible/contributors\",\"subscribers_url\":\"https://api.github.com/repos/ansible/ansible/subscribers\",\"subscription_url\":\"https://api.github.com/repos/ansible/ansible/subscription\",\"commits_url\":\"https://api.github.com/repos/ansible/ansible/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/ansible/ansible/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/ansible/ansible/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/ansible/ansible/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/ansible/ansible/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/ansible/ansible/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/ansible/ansible/merges\",\"archive_url\":\"https://api.github.com/repos/ansible/ansible/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/ansible/ansible/downloads\",\"issues_url\":\"https://api.github.com/repos/ansible/ansible/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/ansible/ansible/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/ansible/ansible/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/ansible/ansible/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/ansible/ansible/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/ansible/ansible/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/ansible/ansible/deployments\",\"created_at\":\"2012-03-06T14:58:02Z\",\"updated_at\":\"2021-02-27T02:40:42Z\",\"pushed_at\":\"2021-02-27T06:00:14Z\",\"git_url\":\"git://github.com/ansible/ansible.git\",\"ssh_url\":\"org-1507452@github.com:ansible/ansible.git\",\"clone_url\":\"https://github.com/ansible/ansible.git\",\"svn_url\":\"https://github.com/ansible/ansible\",\"homepage\":\"https://www.ansible.com/\",\"size\":194931,\"stargazers_count\":47033,\"watchers_count\":47033,\"language\":\"Python\",\"has_issues\":true,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":false,\"has_pages\":false,\"forks_count\":20311,\"mirror_url\":null,\"archived\":false,\"disabled\":false,\"open_issues_count\":1892,\"license\":{\"key\":\"gpl-3.0\",\"name\":\"GNU
        General Public License v3.0\",\"spdx_id\":\"GPL-3.0\",\"url\":\"https://api.github.com/licenses/gpl-3.0\",\"node_id\":\"MDc6TGljZW5zZTk=\"},\"forks\":20311,\"open_issues\":1892,\"watchers\":47033,\"default_branch\":\"devel\"}},\"_links\":{\"self\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/73493\"},\"html\":{\"href\":\"https://github.com/ansible/ansible/pull/73493\"},\"issue\":{\"href\":\"https://api.github.com/repos/ansible/ansible/issues/73493\"},\"comments\":{\"href\":\"https://api.github.com/repos/ansible/ansible/issues/73493/comments\"},\"review_comments\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/73493/comments\"},\"review_comment\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/comments{/number}\"},\"commits\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/73493/commits\"},\"statuses\":{\"href\":\"https://api.github.com/repos/ansible/ansible/statuses/c9fbf167d46985737f6c39069bebb2156a4f8f00\"}},\"author_association\":\"MEMBER\",\"auto_merge\":null,\"active_lock_reason\":null,\"merged\":true,\"mergeable\":null,\"rebaseable\":null,\"mergeable_state\":\"unknown\",\"merged_by\":{\"login\":\"relrod\",\"id\":43930,\"node_id\":\"MDQ6VXNlcjQzOTMw\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/43930?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/relrod\",\"html_url\":\"https://github.com/relrod\",\"followers_url\":\"https://api.github.com/users/relrod/followers\",\"following_url\":\"https://api.github.com/users/relrod/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/relrod/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/relrod/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/relrod/subscriptions\",\"organizations_url\":\"https://api.github.com/users/relrod/orgs\",\"repos_url\":\"https://api.github.com/users/relrod/repos\",\"events_url\":\"https://api.github.com/users/relrod/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/relrod/received_events\",\"type\":\"User\",\"site_admin\":false},\"comments\":3,\"review_comments\":0,\"maintainer_can_modify\":false,\"commits\":1,\"additions\":125,\"deletions\":11,\"changed_files\":7}"
    headers:
      Access-Control-Allow-Origin:
      - '*'
      Access-Control-Expose-Headers:
      - ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining,
        X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes,
        X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset
      Cache-Control:
      - private, max-age=60, s-maxage=60
      Content-Encoding:
      - gzip
      Content-Security-Policy:
      - default-src 'none'
      Content-Type:
      - application/json; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:39 GMT
      Etag:
      - W/"2bb8cca6902ab59ef3cb67ae4e9381cd22366709a300cd0002c79c98d7c8d063"
      Last-Modified:
      - Wed, 17 Feb 2021 22:45:20 GMT
      Referrer-Policy:
      - origin-when-cross-origin, strict-origin-when-cross-origin
      Server:
      - GitHub.com
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - Accept, Authorization, Cookie, X-GitHub-OTP
      - Accept-Encoding, Accept, X-Requested-With
      X-Accepted-OAuth-Scopes:
      - ''
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Media-Type:
      - github.cloak-preview, github.groot-preview; format=json
      X-GitHub-Request-Id:
      - AAC0:74C8:29533:1A857A:6039F06F
      X-OAuth-Scopes:
      - repo, workflow
      X-RateLimit-Limit:
      - '5000'
      X-RateLimit-Remaining:
      - '4945'
      X-RateLimit-Reset:
      - '1614412319'
      X-XSS-Protection:
      - 1; mode=block
      x-ratelimit-used:
      - '55'
    status:
      code: 200
      message: OK
    url: https://api.github.com/repos/ansible/ansible/pulls/73493
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Accept-Encoding:
      - gzip, deflate
      Cookie:
      - logged_in=no
      Host:
      - github.com
      User-Agent:
      - Python/3.8 aiohttp/3.7.3
    method: GET
    uri: https://github.com/ansible/ansible/pull/73493.diff
  response:
    body: {}
    headers:
      Cache-Control:
      - no-cache
      Content-Security-Policy:
      - 'default-src ''none''; base-uri ''self''; block-all-mixed-content; connect-src
        ''self'' uploads.github.com www.githubstatus.com collector.githubapp.com api.github.com
        github-cloud.s3.amazonaws.com github-production-repository-file-5c1aeb.s3.amazonaws.com
        github-production-upload-manifest-file-7fdce7.s3.amazonaws.com github-production-user-asset-6210df.s3.amazonaws.com
        cdn.optimizely.com logx.optimizely.com/v1/events wss://alive.github.com online.visualstudio.com/api/v1/locations;
        font-src github.githubassets.com; form-action ''self'' github.com gist.github.com;
        frame-ancestors ''none''; frame-src render.githubusercontent.com; img-src
        ''self'' data: github.githubassets.com identicons.github.com collector.githubapp.com
        github-cloud.s3.amazonaws.com user-images.githubusercontent.com/ *.githubusercontent.com;
        manifest-src ''self''; media-src ''none''; script-src github.githubassets.com;
        style-src ''unsafe-inline'' github.githubassets.com; worker-src github.com/socket-worker-5029ae85.js
        gist.github.com/socket-worker-5029ae85.js'
      Content-Type:
      - text/html; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:39 GMT
      Expect-CT:
      - max-age=2592000, report-uri="https://api.github.com/_private/browser/errors"
      Location:
      - https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73493.diff
      Referrer-Policy:
      - no-referrer-when-downgrade
      Server:
      - GitHub.com
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - X-PJAX
      - Accept-Encoding, Accept, X-Requested-With
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Request-Id:
      - D35A:3DBA:657AA5:854054:6039F06F
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 302
      message: Found
    url: https://github.com/ansible/ansible/pull/73493.diff
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Accept-Encoding:
      - gzip, deflate
      Host:
      - patch-diff.githubusercontent.com
      User-Agent:
      - Python/3.8 aiohttp/3.7.3
    method: GET
    uri: https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73493.diff
  response:
    body:
      string: "diff --git a/changelogs/fragments/no_log-fallback.yml b/changelogs/fragments/no_log-fallback.yml\nnew
        file mode 100644\nindex 0000000000000..6947531358576\n--- /dev/null\n+++ b/changelogs/fragments/no_log-fallback.yml\n@@
        -0,0 +1,2 @@\n+security_fixes:\n+  - '**security issue** - Mask default and
        fallback values for ``no_log`` module options (CVE-2021-20228)'\ndiff --git
        a/lib/ansible/module_utils/basic.py b/lib/ansible/module_utils/basic.py\nindex
        63715d3be5cd0..adb95e9706a77 100644\n--- a/lib/ansible/module_utils/basic.py\n+++
        b/lib/ansible/module_utils/basic.py\n@@ -725,6 +725,9 @@ def __init__(self,
        argument_spec, bypass_checks=False, no_log=False,\n                 if k not
        in self.argument_spec:\n                     self.argument_spec[k] = v\n \n+
        \       # Save parameter values that should never be logged\n+        self.no_log_values
        = set()\n+\n         self._load_params()\n         self._set_fallbacks()\n
        \n@@ -736,8 +739,6 @@ def __init__(self, argument_spec, bypass_checks=False,
        no_log=False,\n             print('\\n{\"failed\": true, \"msg\": \"Module
        alias error: %s\"}' % to_native(e))\n             sys.exit(1)\n \n-        #
        Save parameter values that should never be logged\n-        self.no_log_values
        = set()\n         self._handle_no_log_values()\n \n         # check the locale
        as set by the current environment, and reset to\n@@ -1926,14 +1927,15 @@ def
        _set_defaults(self, pre=True, spec=None, param=None):\n             param
        = self.params\n         for (k, v) in spec.items():\n             default
        = v.get('default', None)\n-            if pre is True:\n-                #
        this prevents setting defaults on required items\n-                if default
        is not None and k not in param:\n-                    param[k] = default\n-
        \           else:\n-                # make sure things without a default still
        get set None\n-                if k not in param:\n-                    param[k]
        = default\n+\n+            # This prevents setting defaults on required items
        on the 1st run,\n+            # otherwise will set things without a default
        to None on the 2nd.\n+            if k not in param and (default is not None
        or not pre):\n+                # Make sure any default value for no_log fields
        are masked.\n+                if v.get('no_log', False) and default:\n+                    self.no_log_values.add(default)\n+\n+
        \               param[k] = default\n \n     def _set_fallbacks(self, spec=None,
        param=None):\n         if spec is None:\n@@ -1953,9 +1955,13 @@ def _set_fallbacks(self,
        spec=None, param=None):\n                     else:\n                         fallback_args
        = item\n                 try:\n-                    param[k] = fallback_strategy(*fallback_args,
        **fallback_kwargs)\n+                    fallback_value = fallback_strategy(*fallback_args,
        **fallback_kwargs)\n                 except AnsibleFallbackNotFound:\n                     continue\n+
        \               else:\n+                    if v.get('no_log', False) and
        fallback_value:\n+                        self.no_log_values.add(fallback_value)\n+
        \                   param[k] = fallback_value\n \n     def _load_params(self):\n
        \        ''' read the input and set the params attribute.\ndiff --git a/test/integration/targets/module_utils/callback/pure_json.py
        b/test/integration/targets/module_utils/callback/pure_json.py\nnew file mode
        100644\nindex 0000000000000..1723d7bbe869b\n--- /dev/null\n+++ b/test/integration/targets/module_utils/callback/pure_json.py\n@@
        -0,0 +1,31 @@\n+# (c) 2021 Ansible Project\n+# GNU General Public License
        v3.0+ (see COPYING or https://www.gnu.org/licenses/gpl-3.0.txt)\n+\n+from
        __future__ import (absolute_import, division, print_function)\n+__metaclass__
        = type\n+\n+DOCUMENTATION = '''\n+    name: pure_json\n+    type: stdout\n+
        \   short_description: only outputs the module results as json\n+'''\n+\n+import
        json\n+\n+from ansible.plugins.callback import CallbackBase\n+\n+\n+class
        CallbackModule(CallbackBase):\n+\n+    CALLBACK_VERSION = 2.0\n+    CALLBACK_TYPE
        = 'stdout'\n+    CALLBACK_NAME = 'pure_json'\n+\n+    def v2_runner_on_failed(self,
        result, ignore_errors=False):\n+        self._display.display(json.dumps(result._result))\n+\n+
        \   def v2_runner_on_ok(self, result):\n+        self._display.display(json.dumps(result._result))\n+\n+
        \   def v2_runner_on_skipped(self, result):\n+        self._display.display(json.dumps(result._result))\ndiff
        --git a/test/integration/targets/module_utils/library/test_no_log.py b/test/integration/targets/module_utils/library/test_no_log.py\nnew
        file mode 100644\nindex 0000000000000..770e0b3a17e0c\n--- /dev/null\n+++ b/test/integration/targets/module_utils/library/test_no_log.py\n@@
        -0,0 +1,35 @@\n+#!/usr/bin/python\n+# (c) 2021 Ansible Project\n+# GNU General
        Public License v3.0+ (see COPYING or https://www.gnu.org/licenses/gpl-3.0.txt)\n+\n+from
        __future__ import absolute_import, division, print_function\n+__metaclass__
        = type\n+\n+\n+from ansible.module_utils.basic import AnsibleModule, env_fallback\n+\n+\n+def
        main():\n+    module = AnsibleModule(\n+        argument_spec=dict(\n+            explicit_pass=dict(type='str',
        no_log=True),\n+            fallback_pass=dict(type='str', no_log=True, fallback=(env_fallback,
        ['SECRET_ENV'])),\n+            default_pass=dict(type='str', no_log=True,
        default='zyx'),\n+            normal=dict(type='str', default='plaintext'),\n+
        \           suboption=dict(\n+                type='dict',\n+                options=dict(\n+
        \                   explicit_sub_pass=dict(type='str', no_log=True),\n+                    fallback_sub_pass=dict(type='str',
        no_log=True, fallback=(env_fallback, ['SECRET_SUB_ENV'])),\n+                    default_sub_pass=dict(type='str',
        no_log=True, default='xvu'),\n+                    normal=dict(type='str',
        default='plaintext'),\n+                ),\n+            ),\n+        ),\n+
        \   )\n+\n+    module.exit_json(changed=False)\n+\n+\n+if __name__ == '__main__':\n+
        \   main()\ndiff --git a/test/integration/targets/module_utils/module_utils_test_no_log.yml
        b/test/integration/targets/module_utils/module_utils_test_no_log.yml\nnew
        file mode 100644\nindex 0000000000000..bad2efd495db2\n--- /dev/null\n+++ b/test/integration/targets/module_utils/module_utils_test_no_log.yml\n@@
        -0,0 +1,9 @@\n+# This is called by module_utils_vvvvv.yml with a custom callback\n+-
        hosts: testhost\n+  gather_facts: no\n+  tasks:\n+    - name: Check no_log
        invocation results\n+      test_no_log:\n+        explicit_pass: abc\n+        suboption:\n+
        \         explicit_sub_pass: def\ndiff --git a/test/integration/targets/module_utils/module_utils_vvvvv.yml
        b/test/integration/targets/module_utils/module_utils_vvvvv.yml\nnew file mode
        100644\nindex 0000000000000..1fd91d252f9a8\n--- /dev/null\n+++ b/test/integration/targets/module_utils/module_utils_vvvvv.yml\n@@
        -0,0 +1,27 @@\n+- hosts: testhost\n+  gather_facts: no\n+  tasks:\n+  # Invocation
        usually is output with 3vs or more, our callback plugin displays it anyway\n+
        \ - name: Check no_log invocation results\n+    command: ansible-playbook
        -i {{ inventory_file }} module_utils_test_no_log.yml\n+    environment:\n+
        \     ANSIBLE_CALLBACK_PLUGINS: callback\n+      ANSIBLE_STDOUT_CALLBACK:
        pure_json\n+      SECRET_ENV: ghi\n+      SECRET_SUB_ENV: jkl\n+    register:
        no_log_invocation\n+\n+  - set_fact:\n+      no_log_invocation: '{{ no_log_invocation.stdout
        | trim | from_json }}'\n+\n+  - name: check no log values from fallback or
        default are masked\n+    assert:\n+      that:\n+      - no_log_invocation.invocation.module_args.default_pass
        == 'VALUE_SPECIFIED_IN_NO_LOG_PARAMETER'\n+      - no_log_invocation.invocation.module_args.explicit_pass
        == 'VALUE_SPECIFIED_IN_NO_LOG_PARAMETER'\n+      - no_log_invocation.invocation.module_args.fallback_pass
        == 'VALUE_SPECIFIED_IN_NO_LOG_PARAMETER'\n+      - no_log_invocation.invocation.module_args.normal
        == 'plaintext'\n+      - no_log_invocation.invocation.module_args.suboption.default_sub_pass
        == 'VALUE_SPECIFIED_IN_NO_LOG_PARAMETER'\n+      - no_log_invocation.invocation.module_args.suboption.explicit_sub_pass
        == 'VALUE_SPECIFIED_IN_NO_LOG_PARAMETER'\n+      - no_log_invocation.invocation.module_args.suboption.fallback_sub_pass
        == 'VALUE_SPECIFIED_IN_NO_LOG_PARAMETER'\n+      - no_log_invocation.invocation.module_args.suboption.normal
        == 'plaintext'\ndiff --git a/test/integration/targets/module_utils/runme.sh
        b/test/integration/targets/module_utils/runme.sh\nindex efbb7f8208ca1..6adb84560bf4d
        100755\n--- a/test/integration/targets/module_utils/runme.sh\n+++ b/test/integration/targets/module_utils/runme.sh\n@@
        -2,5 +2,9 @@\n \n set -eux\n \n+# Keep the -vvvvv here. This acts as a test
        for testing that higher verbosity\n+# doesn't traceback with unicode in the
        custom module_utils directory path.\n+ansible-playbook module_utils_vvvvv.yml
        -i ../../inventory -vvvvv \"$@\"\n+\n ansible-playbook module_utils_test.yml
        -i ../../inventory -v \"$@\"\n ANSIBLE_MODULE_UTILS=other_mu_dir ansible-playbook
        module_utils_envvar.yml -i ../../inventory -v \"$@\"\n"
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Content-Encoding:
      - gzip
      Content-Security-Policy:
      - 'default-src ''none''; base-uri ''self''; block-all-mixed-content; connect-src
        ''self'' uploads.github.com www.githubstatus.com collector.githubapp.com api.github.com
        github-cloud.s3.amazonaws.com github-production-repository-file-5c1aeb.s3.amazonaws.com
        github-production-upload-manifest-file-7fdce7.s3.amazonaws.com github-production-user-asset-6210df.s3.amazonaws.com
        cdn.optimizely.com logx.optimizely.com/v1/events wss://alive.github.com; font-src
        github.githubassets.com; form-action ''self'' github.com gist.github.com;
        frame-ancestors ''none''; frame-src render.githubusercontent.com; img-src
        ''self'' data: github.githubassets.com identicons.github.com collector.githubapp.com
        github-cloud.s3.amazonaws.com user-images.githubusercontent.com/ *.githubusercontent.com;
        manifest-src ''self''; media-src ''none''; script-src github.githubassets.com;
        style-src ''unsafe-inline'' github.githubassets.com; worker-src github.com/socket-worker-5029ae85.js
        gist.github.com/socket-worker-5029ae85.js'
      Content-Type:
      - text/plain; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:39 GMT
      Etag:
      - W/"466a4986aaedde4f7368fcf6b2d17092"
      Expect-CT:
      - max-age=2592000, report-uri="https://api.github.com/_private/browser/errors"
      Referrer-Policy:
      - origin-when-cross-origin, strict-origin-when-cross-origin
      Server:
      - GitHub.com
      Set-Cookie:
      - logged_in=no; domain=.github.com; path=/; expires=Sun, 27 Feb 2022 07:10:39
        GMT; secure; HttpOnly; SameSite=Lax
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - X-PJAX
      - Accept-Encoding, Accept, X-Requested-With
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Request-Id:
      - D35C:1A52:95E1C5:B718A4:6039F06F
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
    url: https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73493.diff
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Cookie:
      - logged_in=no
    method: GET
    uri: https://api.github.com/search/commits?per_page=100&q=hash:0cdc410dce6658e93c06fa27e0100ddbb11e7015+org:ansible+org:ansible-collections+is:public
  response:
    body:
      string: '{"total_count":1,"incomplete_results":false,"items":[{"url":"https://api.github.com/repos/ansible/ansible/commits/0cdc410dce6658e93c06fa27e0100ddbb11e7015","sha":"0cdc410dce6658e93c06fa27e0100ddbb11e7015","node_id":"MDY6Q29tbWl0MzYzODk2NDowY2RjNDEwZGNlNjY1OGU5M2MwNmZhMjdlMDEwMGRkYmIxMWU3MDE1","html_url":"https://github.com/ansible/ansible/commit/0cdc410dce6658e93c06fa27e0100ddbb11e7015","comments_url":"https://api.github.com/repos/ansible/ansible/commits/0cdc410dce6658e93c06fa27e0100ddbb11e7015/comments","commit":{"url":"https://api.github.com/repos/ansible/ansible/git/commits/0cdc410dce6658e93c06fa27e0100ddbb11e7015","author":{"date":"2021-02-05T09:11:55.000+10:00","name":"Jordan
        Borean","email":"jborean93@gmail.com"},"committer":{"date":"2021-02-05T09:11:55.000+10:00","name":"GitHub","email":"noreply@github.com"},"message":"no_log
        mask suboption fallback values and defaults CVE-2021-20228 (#73487)\n\n* no_log
        mask suboption fallback values and defaults\r\n\r\n* Added changelog\r\n\r\n*
        Remove lambda expression","tree":{"url":"https://api.github.com/repos/ansible/ansible/git/trees/50a5f0359f1d4e459e29e89c8aea127f881fb4b0","sha":"50a5f0359f1d4e459e29e89c8aea127f881fb4b0"},"comment_count":0},"author":{"login":"jborean93","id":8462645,"node_id":"MDQ6VXNlcjg0NjI2NDU=","avatar_url":"https://avatars.githubusercontent.com/u/8462645?v=4","gravatar_id":"","url":"https://api.github.com/users/jborean93","html_url":"https://github.com/jborean93","followers_url":"https://api.github.com/users/jborean93/followers","following_url":"https://api.github.com/users/jborean93/following{/other_user}","gists_url":"https://api.github.com/users/jborean93/gists{/gist_id}","starred_url":"https://api.github.com/users/jborean93/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jborean93/subscriptions","organizations_url":"https://api.github.com/users/jborean93/orgs","repos_url":"https://api.github.com/users/jborean93/repos","events_url":"https://api.github.com/users/jborean93/events{/privacy}","received_events_url":"https://api.github.com/users/jborean93/received_events","type":"User","site_admin":false},"committer":{"login":"web-flow","id":19864447,"node_id":"MDQ6VXNlcjE5ODY0NDQ3","avatar_url":"https://avatars.githubusercontent.com/u/19864447?v=4","gravatar_id":"","url":"https://api.github.com/users/web-flow","html_url":"https://github.com/web-flow","followers_url":"https://api.github.com/users/web-flow/followers","following_url":"https://api.github.com/users/web-flow/following{/other_user}","gists_url":"https://api.github.com/users/web-flow/gists{/gist_id}","starred_url":"https://api.github.com/users/web-flow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/web-flow/subscriptions","organizations_url":"https://api.github.com/users/web-flow/orgs","repos_url":"https://api.github.com/users/web-flow/repos","events_url":"https://api.github.com/users/web-flow/events{/privacy}","received_events_url":"https://api.github.com/users/web-flow/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/ansible/ansible/commits/4315e1880742eedc5b65fdc51fdc6a94afa61bd1","html_url":"https://github.com/ansible/ansible/commit/4315e1880742eedc5b65fdc51fdc6a94afa61bd1","sha":"4315e1880742eedc5b65fdc51fdc6a94afa61bd1"}],"repository":{"id":3638964,"node_id":"MDEwOlJlcG9zaXRvcnkzNjM4OTY0","name":"ansible","full_name":"ansible/ansible","private":false,"owner":{"login":"ansible","id":1507452,"node_id":"MDEyOk9yZ2FuaXphdGlvbjE1MDc0NTI=","avatar_url":"https://avatars.githubusercontent.com/u/1507452?v=4","gravatar_id":"","url":"https://api.github.com/users/ansible","html_url":"https://github.com/ansible","followers_url":"https://api.github.com/users/ansible/followers","following_url":"https://api.github.com/users/ansible/following{/other_user}","gists_url":"https://api.github.com/users/ansible/gists{/gist_id}","starred_url":"https://api.github.com/users/ansible/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ansible/subscriptions","organizations_url":"https://api.github.com/users/ansible/orgs","repos_url":"https://api.github.com/users/ansible/repos","events_url":"https://api.github.com/users/ansible/events{/privacy}","received_events_url":"https://api.github.com/users/ansible/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/ansible/ansible","description":"Ansible
        is a radically simple IT automation platform that makes your applications
        and systems easier to deploy and maintain. Automate everything from code deployment
        to network configuration to cloud management, in a language that approaches
        plain English, using SSH, with no agents to install on remote systems. https://docs.ansible.com.","fork":false,"url":"https://api.github.com/repos/ansible/ansible","forks_url":"https://api.github.com/repos/ansible/ansible/forks","keys_url":"https://api.github.com/repos/ansible/ansible/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ansible/ansible/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ansible/ansible/teams","hooks_url":"https://api.github.com/repos/ansible/ansible/hooks","issue_events_url":"https://api.github.com/repos/ansible/ansible/issues/events{/number}","events_url":"https://api.github.com/repos/ansible/ansible/events","assignees_url":"https://api.github.com/repos/ansible/ansible/assignees{/user}","branches_url":"https://api.github.com/repos/ansible/ansible/branches{/branch}","tags_url":"https://api.github.com/repos/ansible/ansible/tags","blobs_url":"https://api.github.com/repos/ansible/ansible/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ansible/ansible/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ansible/ansible/git/refs{/sha}","trees_url":"https://api.github.com/repos/ansible/ansible/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ansible/ansible/statuses/{sha}","languages_url":"https://api.github.com/repos/ansible/ansible/languages","stargazers_url":"https://api.github.com/repos/ansible/ansible/stargazers","contributors_url":"https://api.github.com/repos/ansible/ansible/contributors","subscribers_url":"https://api.github.com/repos/ansible/ansible/subscribers","subscription_url":"https://api.github.com/repos/ansible/ansible/subscription","commits_url":"https://api.github.com/repos/ansible/ansible/commits{/sha}","git_commits_url":"https://api.github.com/repos/ansible/ansible/git/commits{/sha}","comments_url":"https://api.github.com/repos/ansible/ansible/comments{/number}","issue_comment_url":"https://api.github.com/repos/ansible/ansible/issues/comments{/number}","contents_url":"https://api.github.com/repos/ansible/ansible/contents/{+path}","compare_url":"https://api.github.com/repos/ansible/ansible/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ansible/ansible/merges","archive_url":"https://api.github.com/repos/ansible/ansible/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ansible/ansible/downloads","issues_url":"https://api.github.com/repos/ansible/ansible/issues{/number}","pulls_url":"https://api.github.com/repos/ansible/ansible/pulls{/number}","milestones_url":"https://api.github.com/repos/ansible/ansible/milestones{/number}","notifications_url":"https://api.github.com/repos/ansible/ansible/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ansible/ansible/labels{/name}","releases_url":"https://api.github.com/repos/ansible/ansible/releases{/id}","deployments_url":"https://api.github.com/repos/ansible/ansible/deployments"},"score":1.0}]}'
    headers:
      Access-Control-Allow-Origin:
      - '*'
      Access-Control-Expose-Headers:
      - ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining,
        X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes,
        X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset
      Cache-Control:
      - no-cache
      Content-Encoding:
      - gzip
      Content-Security-Policy:
      - default-src 'none'
      Content-Type:
      - application/json; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:40 GMT
      Referrer-Policy:
      - origin-when-cross-origin, strict-origin-when-cross-origin
      Server:
      - GitHub.com
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - Accept, Authorization, Cookie, X-GitHub-OTP
      - Accept-Encoding, Accept, X-Requested-With
      X-Accepted-OAuth-Scopes:
      - ''
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Media-Type:
      - github.cloak-preview, github.groot-preview; format=json
      X-GitHub-Request-Id:
      - AAC0:74C8:29534:1A8582:6039F06F
      X-OAuth-Scopes:
      - repo, workflow
      X-RateLimit-Limit:
      - '30'
      X-RateLimit-Remaining:
      - '28'
      X-RateLimit-Reset:
      - '1614409897'
      X-XSS-Protection:
      - 1; mode=block
      x-ratelimit-used:
      - '2'
    status:
      code: 200
      message: OK
    url: https://api.github.com/search/commits?per_page=100&q=hash:0cdc410dce6658e93c06fa27e0100ddbb11e7015+org:ansible+org:ansible-collections+is:public
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Cookie:
      - logged_in=no
    method: GET
    uri: https://api.github.com/repos/ansible/ansible/commits/0cdc410dce6658e93c06fa27e0100ddbb11e7015/pulls?per_page=100
  response:
    body:
      string: "[{\"url\":\"https://api.github.com/repos/ansible/ansible/pulls/73487\",\"id\":567890636,\"node_id\":\"MDExOlB1bGxSZXF1ZXN0NTY3ODkwNjM2\",\"html_url\":\"https://github.com/ansible/ansible/pull/73487\",\"diff_url\":\"https://github.com/ansible/ansible/pull/73487.diff\",\"patch_url\":\"https://github.com/ansible/ansible/pull/73487.patch\",\"issue_url\":\"https://api.github.com/repos/ansible/ansible/issues/73487\",\"number\":73487,\"state\":\"closed\",\"locked\":false,\"title\":\"no_log
        mask suboption fallback values and defaults CVE-2021-20228\",\"user\":{\"login\":\"jborean93\",\"id\":8462645,\"node_id\":\"MDQ6VXNlcjg0NjI2NDU=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/8462645?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/jborean93\",\"html_url\":\"https://github.com/jborean93\",\"followers_url\":\"https://api.github.com/users/jborean93/followers\",\"following_url\":\"https://api.github.com/users/jborean93/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/jborean93/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/jborean93/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/jborean93/subscriptions\",\"organizations_url\":\"https://api.github.com/users/jborean93/orgs\",\"repos_url\":\"https://api.github.com/users/jborean93/repos\",\"events_url\":\"https://api.github.com/users/jborean93/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/jborean93/received_events\",\"type\":\"User\",\"site_admin\":false},\"body\":\"#####
        SUMMARY\\r\\nMake sure default and fallback values for `no_log` fields are
        masked in the module output.\\r\\n\\r\\nCVE-2021-20228\\r\\n\\r\\n##### ISSUE
        TYPE\\r\\n- Bugfix Pull Request\\r\\n\\r\\n##### COMPONENT NAME\\r\\nbasic.py\",\"created_at\":\"2021-02-04T20:17:58Z\",\"updated_at\":\"2021-02-08T07:51:08Z\",\"closed_at\":\"2021-02-04T23:11:56Z\",\"merged_at\":\"2021-02-04T23:11:56Z\",\"merge_commit_sha\":\"0cdc410dce6658e93c06fa27e0100ddbb11e7015\",\"assignee\":null,\"assignees\":[],\"requested_reviewers\":[],\"requested_teams\":[],\"labels\":[{\"id\":1742671738,\"node_id\":\"MDU6TGFiZWwxNzQyNjcxNzM4\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/affects_2.11\",\"name\":\"affects_2.11\",\"color\":\"5319e7\",\"default\":false,\"description\":\"\"},{\"id\":785271699,\"node_id\":\"MDU6TGFiZWw3ODUyNzE2OTk=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/bug\",\"name\":\"bug\",\"color\":\"fbca04\",\"default\":true,\"description\":\"This
        issue/PR relates to a bug.\"},{\"id\":1285191701,\"node_id\":\"MDU6TGFiZWwxMjg1MTkxNzAx\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/collection\",\"name\":\"collection\",\"color\":\"b60205\",\"default\":false,\"description\":\"Related
        to Ansible Collections work\"},{\"id\":1991487163,\"node_id\":\"MDU6TGFiZWwxOTkxNDg3MTYz\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/collection:amazon.aws\",\"name\":\"collection:amazon.aws\",\"color\":\"ededed\",\"default\":false,\"description\":null},{\"id\":513652538,\"node_id\":\"MDU6TGFiZWw1MTM2NTI1Mzg=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/core_review\",\"name\":\"core_review\",\"color\":\"ededed\",\"default\":false,\"description\":\"In
        order to be merged, this PR must follow the core review workflow.\"},{\"id\":636327968,\"node_id\":\"MDU6TGFiZWw2MzYzMjc5Njg=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/support:community\",\"name\":\"support:community\",\"color\":\"ededed\",\"default\":false,\"description\":\"This
        issue/PR relates to code supported by the Ansible community.\"},{\"id\":636352796,\"node_id\":\"MDU6TGFiZWw2MzYzNTI3OTY=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/support:core\",\"name\":\"support:core\",\"color\":\"ededed\",\"default\":false,\"description\":\"This
        issue/PR relates to code supported by the Ansible Engineering Team.\"}],\"milestone\":null,\"draft\":false,\"commits_url\":\"https://api.github.com/repos/ansible/ansible/pulls/73487/commits\",\"review_comments_url\":\"https://api.github.com/repos/ansible/ansible/pulls/73487/comments\",\"review_comment_url\":\"https://api.github.com/repos/ansible/ansible/pulls/comments{/number}\",\"comments_url\":\"https://api.github.com/repos/ansible/ansible/issues/73487/comments\",\"statuses_url\":\"https://api.github.com/repos/ansible/ansible/statuses/fb53dc23950f22857e2b6c6c6e9771dd980c9be9\",\"head\":{\"label\":\"jborean93:nolog-suboptions\",\"ref\":\"nolog-suboptions\",\"sha\":\"fb53dc23950f22857e2b6c6c6e9771dd980c9be9\",\"user\":{\"login\":\"jborean93\",\"id\":8462645,\"node_id\":\"MDQ6VXNlcjg0NjI2NDU=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/8462645?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/jborean93\",\"html_url\":\"https://github.com/jborean93\",\"followers_url\":\"https://api.github.com/users/jborean93/followers\",\"following_url\":\"https://api.github.com/users/jborean93/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/jborean93/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/jborean93/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/jborean93/subscriptions\",\"organizations_url\":\"https://api.github.com/users/jborean93/orgs\",\"repos_url\":\"https://api.github.com/users/jborean93/repos\",\"events_url\":\"https://api.github.com/users/jborean93/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/jborean93/received_events\",\"type\":\"User\",\"site_admin\":false},\"repo\":{\"id\":72729201,\"node_id\":\"MDEwOlJlcG9zaXRvcnk3MjcyOTIwMQ==\",\"name\":\"ansible\",\"full_name\":\"jborean93/ansible\",\"private\":false,\"owner\":{\"login\":\"jborean93\",\"id\":8462645,\"node_id\":\"MDQ6VXNlcjg0NjI2NDU=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/8462645?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/jborean93\",\"html_url\":\"https://github.com/jborean93\",\"followers_url\":\"https://api.github.com/users/jborean93/followers\",\"following_url\":\"https://api.github.com/users/jborean93/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/jborean93/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/jborean93/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/jborean93/subscriptions\",\"organizations_url\":\"https://api.github.com/users/jborean93/orgs\",\"repos_url\":\"https://api.github.com/users/jborean93/repos\",\"events_url\":\"https://api.github.com/users/jborean93/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/jborean93/received_events\",\"type\":\"User\",\"site_admin\":false},\"html_url\":\"https://github.com/jborean93/ansible\",\"description\":\"Ansible
        is a radically simple IT automation platform that makes your applications
        and systems easier to deploy. Avoid writing scripts or custom code to deploy
        and update your applications\u2014 automate in a language that approaches
        plain English, using SSH, with no agents to install on remote systems.\",\"fork\":true,\"url\":\"https://api.github.com/repos/jborean93/ansible\",\"forks_url\":\"https://api.github.com/repos/jborean93/ansible/forks\",\"keys_url\":\"https://api.github.com/repos/jborean93/ansible/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/jborean93/ansible/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/jborean93/ansible/teams\",\"hooks_url\":\"https://api.github.com/repos/jborean93/ansible/hooks\",\"issue_events_url\":\"https://api.github.com/repos/jborean93/ansible/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/jborean93/ansible/events\",\"assignees_url\":\"https://api.github.com/repos/jborean93/ansible/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/jborean93/ansible/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/jborean93/ansible/tags\",\"blobs_url\":\"https://api.github.com/repos/jborean93/ansible/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/jborean93/ansible/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/jborean93/ansible/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/jborean93/ansible/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/jborean93/ansible/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/jborean93/ansible/languages\",\"stargazers_url\":\"https://api.github.com/repos/jborean93/ansible/stargazers\",\"contributors_url\":\"https://api.github.com/repos/jborean93/ansible/contributors\",\"subscribers_url\":\"https://api.github.com/repos/jborean93/ansible/subscribers\",\"subscription_url\":\"https://api.github.com/repos/jborean93/ansible/subscription\",\"commits_url\":\"https://api.github.com/repos/jborean93/ansible/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/jborean93/ansible/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/jborean93/ansible/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/jborean93/ansible/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/jborean93/ansible/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/jborean93/ansible/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/jborean93/ansible/merges\",\"archive_url\":\"https://api.github.com/repos/jborean93/ansible/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/jborean93/ansible/downloads\",\"issues_url\":\"https://api.github.com/repos/jborean93/ansible/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/jborean93/ansible/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/jborean93/ansible/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/jborean93/ansible/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/jborean93/ansible/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/jborean93/ansible/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/jborean93/ansible/deployments\",\"created_at\":\"2016-11-03T09:27:23Z\",\"updated_at\":\"2021-02-26T00:49:47Z\",\"pushed_at\":\"2021-02-26T00:49:30Z\",\"git_url\":\"git://github.com/jborean93/ansible.git\",\"ssh_url\":\"git@github.com:jborean93/ansible.git\",\"clone_url\":\"https://github.com/jborean93/ansible.git\",\"svn_url\":\"https://github.com/jborean93/ansible\",\"homepage\":\"http://ansible.com/\",\"size\":173974,\"stargazers_count\":0,\"watchers_count\":0,\"language\":\"Python\",\"has_issues\":false,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":false,\"has_pages\":false,\"forks_count\":0,\"mirror_url\":null,\"archived\":false,\"disabled\":false,\"open_issues_count\":0,\"license\":{\"key\":\"gpl-3.0\",\"name\":\"GNU
        General Public License v3.0\",\"spdx_id\":\"GPL-3.0\",\"url\":\"https://api.github.com/licenses/gpl-3.0\",\"node_id\":\"MDc6TGljZW5zZTk=\"},\"forks\":0,\"open_issues\":0,\"watchers\":0,\"default_branch\":\"devel\"}},\"base\":{\"label\":\"ansible:devel\",\"ref\":\"devel\",\"sha\":\"7fb7d138fb1f5e3977d800cd2a56c60a101713ee\",\"user\":{\"login\":\"ansible\",\"id\":1507452,\"node_id\":\"MDEyOk9yZ2FuaXphdGlvbjE1MDc0NTI=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/1507452?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/ansible\",\"html_url\":\"https://github.com/ansible\",\"followers_url\":\"https://api.github.com/users/ansible/followers\",\"following_url\":\"https://api.github.com/users/ansible/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/ansible/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/ansible/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/ansible/subscriptions\",\"organizations_url\":\"https://api.github.com/users/ansible/orgs\",\"repos_url\":\"https://api.github.com/users/ansible/repos\",\"events_url\":\"https://api.github.com/users/ansible/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/ansible/received_events\",\"type\":\"Organization\",\"site_admin\":false},\"repo\":{\"id\":3638964,\"node_id\":\"MDEwOlJlcG9zaXRvcnkzNjM4OTY0\",\"name\":\"ansible\",\"full_name\":\"ansible/ansible\",\"private\":false,\"owner\":{\"login\":\"ansible\",\"id\":1507452,\"node_id\":\"MDEyOk9yZ2FuaXphdGlvbjE1MDc0NTI=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/1507452?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/ansible\",\"html_url\":\"https://github.com/ansible\",\"followers_url\":\"https://api.github.com/users/ansible/followers\",\"following_url\":\"https://api.github.com/users/ansible/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/ansible/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/ansible/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/ansible/subscriptions\",\"organizations_url\":\"https://api.github.com/users/ansible/orgs\",\"repos_url\":\"https://api.github.com/users/ansible/repos\",\"events_url\":\"https://api.github.com/users/ansible/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/ansible/received_events\",\"type\":\"Organization\",\"site_admin\":false},\"html_url\":\"https://github.com/ansible/ansible\",\"description\":\"Ansible
        is a radically simple IT automation platform that makes your applications
        and systems easier to deploy and maintain. Automate everything from code deployment
        to network configuration to cloud management, in a language that approaches
        plain English, using SSH, with no agents to install on remote systems. https://docs.ansible.com.\",\"fork\":false,\"url\":\"https://api.github.com/repos/ansible/ansible\",\"forks_url\":\"https://api.github.com/repos/ansible/ansible/forks\",\"keys_url\":\"https://api.github.com/repos/ansible/ansible/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/ansible/ansible/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/ansible/ansible/teams\",\"hooks_url\":\"https://api.github.com/repos/ansible/ansible/hooks\",\"issue_events_url\":\"https://api.github.com/repos/ansible/ansible/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/ansible/ansible/events\",\"assignees_url\":\"https://api.github.com/repos/ansible/ansible/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/ansible/ansible/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/ansible/ansible/tags\",\"blobs_url\":\"https://api.github.com/repos/ansible/ansible/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/ansible/ansible/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/ansible/ansible/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/ansible/ansible/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/ansible/ansible/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/ansible/ansible/languages\",\"stargazers_url\":\"https://api.github.com/repos/ansible/ansible/stargazers\",\"contributors_url\":\"https://api.github.com/repos/ansible/ansible/contributors\",\"subscribers_url\":\"https://api.github.com/repos/ansible/ansible/subscribers\",\"subscription_url\":\"https://api.github.com/repos/ansible/ansible/subscription\",\"commits_url\":\"https://api.github.com/repos/ansible/ansible/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/ansible/ansible/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/ansible/ansible/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/ansible/ansible/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/ansible/ansible/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/ansible/ansible/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/ansible/ansible/merges\",\"archive_url\":\"https://api.github.com/repos/ansible/ansible/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/ansible/ansible/downloads\",\"issues_url\":\"https://api.github.com/repos/ansible/ansible/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/ansible/ansible/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/ansible/ansible/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/ansible/ansible/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/ansible/ansible/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/ansible/ansible/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/ansible/ansible/deployments\",\"created_at\":\"2012-03-06T14:58:02Z\",\"updated_at\":\"2021-02-27T02:40:42Z\",\"pushed_at\":\"2021-02-27T06:00:14Z\",\"git_url\":\"git://github.com/ansible/ansible.git\",\"ssh_url\":\"org-1507452@github.com:ansible/ansible.git\",\"clone_url\":\"https://github.com/ansible/ansible.git\",\"svn_url\":\"https://github.com/ansible/ansible\",\"homepage\":\"https://www.ansible.com/\",\"size\":194931,\"stargazers_count\":47033,\"watchers_count\":47033,\"language\":\"Python\",\"has_issues\":true,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":false,\"has_pages\":false,\"forks_count\":20311,\"mirror_url\":null,\"archived\":false,\"disabled\":false,\"open_issues_count\":1892,\"license\":{\"key\":\"gpl-3.0\",\"name\":\"GNU
        General Public License v3.0\",\"spdx_id\":\"GPL-3.0\",\"url\":\"https://api.github.com/licenses/gpl-3.0\",\"node_id\":\"MDc6TGljZW5zZTk=\"},\"forks\":20311,\"open_issues\":1892,\"watchers\":47033,\"default_branch\":\"devel\"}},\"_links\":{\"self\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/73487\"},\"html\":{\"href\":\"https://github.com/ansible/ansible/pull/73487\"},\"issue\":{\"href\":\"https://api.github.com/repos/ansible/ansible/issues/73487\"},\"comments\":{\"href\":\"https://api.github.com/repos/ansible/ansible/issues/73487/comments\"},\"review_comments\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/73487/comments\"},\"review_comment\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/comments{/number}\"},\"commits\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/73487/commits\"},\"statuses\":{\"href\":\"https://api.github.com/repos/ansible/ansible/statuses/fb53dc23950f22857e2b6c6c6e9771dd980c9be9\"}},\"author_association\":\"MEMBER\",\"auto_merge\":null,\"active_lock_reason\":null}]"
    headers:
      Access-Control-Allow-Origin:
      - '*'
      Access-Control-Expose-Headers:
      - ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining,
        X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes,
        X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset
      Cache-Control:
      - private, max-age=60, s-maxage=60
      Content-Encoding:
      - gzip
      Content-Security-Policy:
      - default-src 'none'
      Content-Type:
      - application/json; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:40 GMT
      Etag:
      - W/"46c7f73821d8b92f85dd93e59bcc330d02048d2329ef71611dbe595577d500ad"
      Referrer-Policy:
      - origin-when-cross-origin, strict-origin-when-cross-origin
      Server:
      - GitHub.com
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - Accept, Authorization, Cookie, X-GitHub-OTP
      - Accept-Encoding, Accept, X-Requested-With
      X-Accepted-OAuth-Scopes:
      - ''
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Media-Type:
      - github.cloak-preview, github.groot-preview; format=json
      X-GitHub-Request-Id:
      - AAC0:74C8:29535:1A8584:6039F070
      X-OAuth-Scopes:
      - repo, workflow
      X-RateLimit-Limit:
      - '5000'
      X-RateLimit-Remaining:
      - '4944'
      X-RateLimit-Reset:
      - '1614412319'
      X-XSS-Protection:
      - 1; mode=block
      x-ratelimit-used:
      - '56'
    status:
      code: 200
      message: OK
    url: https://api.github.com/repos/ansible/ansible/commits/0cdc410dce6658e93c06fa27e0100ddbb11e7015/pulls?per_page=100
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Cookie:
      - logged_in=no
    method: GET
    uri: https://api.github.com/repos/ansible/ansible/pulls/73487
  response:
    body:
      string: "{\"url\":\"https://api.github.com/repos/ansible/ansible/pulls/73487\",\"id\":567890636,\"node_id\":\"MDExOlB1bGxSZXF1ZXN0NTY3ODkwNjM2\",\"html_url\":\"https://github.com/ansible/ansible/pull/73487\",\"diff_url\":\"https://github.com/ansible/ansible/pull/73487.diff\",\"patch_url\":\"https://github.com/ansible/ansible/pull/73487.patch\",\"issue_url\":\"https://api.github.com/repos/ansible/ansible/issues/73487\",\"number\":73487,\"state\":\"closed\",\"locked\":false,\"title\":\"no_log
        mask suboption fallback values and defaults CVE-2021-20228\",\"user\":{\"login\":\"jborean93\",\"id\":8462645,\"node_id\":\"MDQ6VXNlcjg0NjI2NDU=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/8462645?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/jborean93\",\"html_url\":\"https://github.com/jborean93\",\"followers_url\":\"https://api.github.com/users/jborean93/followers\",\"following_url\":\"https://api.github.com/users/jborean93/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/jborean93/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/jborean93/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/jborean93/subscriptions\",\"organizations_url\":\"https://api.github.com/users/jborean93/orgs\",\"repos_url\":\"https://api.github.com/users/jborean93/repos\",\"events_url\":\"https://api.github.com/users/jborean93/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/jborean93/received_events\",\"type\":\"User\",\"site_admin\":false},\"body\":\"#####
        SUMMARY\\r\\nMake sure default and fallback values for `no_log` fields are
        masked in the module output.\\r\\n\\r\\nCVE-2021-20228\\r\\n\\r\\n##### ISSUE
        TYPE\\r\\n- Bugfix Pull Request\\r\\n\\r\\n##### COMPONENT NAME\\r\\nbasic.py\",\"created_at\":\"2021-02-04T20:17:58Z\",\"updated_at\":\"2021-02-08T07:51:08Z\",\"closed_at\":\"2021-02-04T23:11:56Z\",\"merged_at\":\"2021-02-04T23:11:56Z\",\"merge_commit_sha\":\"0cdc410dce6658e93c06fa27e0100ddbb11e7015\",\"assignee\":null,\"assignees\":[],\"requested_reviewers\":[],\"requested_teams\":[],\"labels\":[{\"id\":1742671738,\"node_id\":\"MDU6TGFiZWwxNzQyNjcxNzM4\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/affects_2.11\",\"name\":\"affects_2.11\",\"color\":\"5319e7\",\"default\":false,\"description\":\"\"},{\"id\":785271699,\"node_id\":\"MDU6TGFiZWw3ODUyNzE2OTk=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/bug\",\"name\":\"bug\",\"color\":\"fbca04\",\"default\":true,\"description\":\"This
        issue/PR relates to a bug.\"},{\"id\":1285191701,\"node_id\":\"MDU6TGFiZWwxMjg1MTkxNzAx\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/collection\",\"name\":\"collection\",\"color\":\"b60205\",\"default\":false,\"description\":\"Related
        to Ansible Collections work\"},{\"id\":1991487163,\"node_id\":\"MDU6TGFiZWwxOTkxNDg3MTYz\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/collection:amazon.aws\",\"name\":\"collection:amazon.aws\",\"color\":\"ededed\",\"default\":false,\"description\":null},{\"id\":513652538,\"node_id\":\"MDU6TGFiZWw1MTM2NTI1Mzg=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/core_review\",\"name\":\"core_review\",\"color\":\"ededed\",\"default\":false,\"description\":\"In
        order to be merged, this PR must follow the core review workflow.\"},{\"id\":636327968,\"node_id\":\"MDU6TGFiZWw2MzYzMjc5Njg=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/support:community\",\"name\":\"support:community\",\"color\":\"ededed\",\"default\":false,\"description\":\"This
        issue/PR relates to code supported by the Ansible community.\"},{\"id\":636352796,\"node_id\":\"MDU6TGFiZWw2MzYzNTI3OTY=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/support:core\",\"name\":\"support:core\",\"color\":\"ededed\",\"default\":false,\"description\":\"This
        issue/PR relates to code supported by the Ansible Engineering Team.\"}],\"milestone\":null,\"draft\":false,\"commits_url\":\"https://api.github.com/repos/ansible/ansible/pulls/73487/commits\",\"review_comments_url\":\"https://api.github.com/repos/ansible/ansible/pulls/73487/comments\",\"review_comment_url\":\"https://api.github.com/repos/ansible/ansible/pulls/comments{/number}\",\"comments_url\":\"https://api.github.com/repos/ansible/ansible/issues/73487/comments\",\"statuses_url\":\"https://api.github.com/repos/ansible/ansible/statuses/fb53dc23950f22857e2b6c6c6e9771dd980c9be9\",\"head\":{\"label\":\"jborean93:nolog-suboptions\",\"ref\":\"nolog-suboptions\",\"sha\":\"fb53dc23950f22857e2b6c6c6e9771dd980c9be9\",\"user\":{\"login\":\"jborean93\",\"id\":8462645,\"node_id\":\"MDQ6VXNlcjg0NjI2NDU=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/8462645?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/jborean93\",\"html_url\":\"https://github.com/jborean93\",\"followers_url\":\"https://api.github.com/users/jborean93/followers\",\"following_url\":\"https://api.github.com/users/jborean93/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/jborean93/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/jborean93/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/jborean93/subscriptions\",\"organizations_url\":\"https://api.github.com/users/jborean93/orgs\",\"repos_url\":\"https://api.github.com/users/jborean93/repos\",\"events_url\":\"https://api.github.com/users/jborean93/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/jborean93/received_events\",\"type\":\"User\",\"site_admin\":false},\"repo\":{\"id\":72729201,\"node_id\":\"MDEwOlJlcG9zaXRvcnk3MjcyOTIwMQ==\",\"name\":\"ansible\",\"full_name\":\"jborean93/ansible\",\"private\":false,\"owner\":{\"login\":\"jborean93\",\"id\":8462645,\"node_id\":\"MDQ6VXNlcjg0NjI2NDU=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/8462645?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/jborean93\",\"html_url\":\"https://github.com/jborean93\",\"followers_url\":\"https://api.github.com/users/jborean93/followers\",\"following_url\":\"https://api.github.com/users/jborean93/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/jborean93/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/jborean93/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/jborean93/subscriptions\",\"organizations_url\":\"https://api.github.com/users/jborean93/orgs\",\"repos_url\":\"https://api.github.com/users/jborean93/repos\",\"events_url\":\"https://api.github.com/users/jborean93/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/jborean93/received_events\",\"type\":\"User\",\"site_admin\":false},\"html_url\":\"https://github.com/jborean93/ansible\",\"description\":\"Ansible
        is a radically simple IT automation platform that makes your applications
        and systems easier to deploy. Avoid writing scripts or custom code to deploy
        and update your applications\u2014 automate in a language that approaches
        plain English, using SSH, with no agents to install on remote systems.\",\"fork\":true,\"url\":\"https://api.github.com/repos/jborean93/ansible\",\"forks_url\":\"https://api.github.com/repos/jborean93/ansible/forks\",\"keys_url\":\"https://api.github.com/repos/jborean93/ansible/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/jborean93/ansible/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/jborean93/ansible/teams\",\"hooks_url\":\"https://api.github.com/repos/jborean93/ansible/hooks\",\"issue_events_url\":\"https://api.github.com/repos/jborean93/ansible/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/jborean93/ansible/events\",\"assignees_url\":\"https://api.github.com/repos/jborean93/ansible/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/jborean93/ansible/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/jborean93/ansible/tags\",\"blobs_url\":\"https://api.github.com/repos/jborean93/ansible/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/jborean93/ansible/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/jborean93/ansible/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/jborean93/ansible/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/jborean93/ansible/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/jborean93/ansible/languages\",\"stargazers_url\":\"https://api.github.com/repos/jborean93/ansible/stargazers\",\"contributors_url\":\"https://api.github.com/repos/jborean93/ansible/contributors\",\"subscribers_url\":\"https://api.github.com/repos/jborean93/ansible/subscribers\",\"subscription_url\":\"https://api.github.com/repos/jborean93/ansible/subscription\",\"commits_url\":\"https://api.github.com/repos/jborean93/ansible/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/jborean93/ansible/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/jborean93/ansible/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/jborean93/ansible/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/jborean93/ansible/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/jborean93/ansible/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/jborean93/ansible/merges\",\"archive_url\":\"https://api.github.com/repos/jborean93/ansible/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/jborean93/ansible/downloads\",\"issues_url\":\"https://api.github.com/repos/jborean93/ansible/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/jborean93/ansible/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/jborean93/ansible/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/jborean93/ansible/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/jborean93/ansible/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/jborean93/ansible/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/jborean93/ansible/deployments\",\"created_at\":\"2016-11-03T09:27:23Z\",\"updated_at\":\"2021-02-26T00:49:47Z\",\"pushed_at\":\"2021-02-26T00:49:30Z\",\"git_url\":\"git://github.com/jborean93/ansible.git\",\"ssh_url\":\"git@github.com:jborean93/ansible.git\",\"clone_url\":\"https://github.com/jborean93/ansible.git\",\"svn_url\":\"https://github.com/jborean93/ansible\",\"homepage\":\"http://ansible.com/\",\"size\":173974,\"stargazers_count\":0,\"watchers_count\":0,\"language\":\"Python\",\"has_issues\":false,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":false,\"has_pages\":false,\"forks_count\":0,\"mirror_url\":null,\"archived\":false,\"disabled\":false,\"open_issues_count\":0,\"license\":{\"key\":\"gpl-3.0\",\"name\":\"GNU
        General Public License v3.0\",\"spdx_id\":\"GPL-3.0\",\"url\":\"https://api.github.com/licenses/gpl-3.0\",\"node_id\":\"MDc6TGljZW5zZTk=\"},\"forks\":0,\"open_issues\":0,\"watchers\":0,\"default_branch\":\"devel\"}},\"base\":{\"label\":\"ansible:devel\",\"ref\":\"devel\",\"sha\":\"7fb7d138fb1f5e3977d800cd2a56c60a101713ee\",\"user\":{\"login\":\"ansible\",\"id\":1507452,\"node_id\":\"MDEyOk9yZ2FuaXphdGlvbjE1MDc0NTI=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/1507452?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/ansible\",\"html_url\":\"https://github.com/ansible\",\"followers_url\":\"https://api.github.com/users/ansible/followers\",\"following_url\":\"https://api.github.com/users/ansible/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/ansible/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/ansible/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/ansible/subscriptions\",\"organizations_url\":\"https://api.github.com/users/ansible/orgs\",\"repos_url\":\"https://api.github.com/users/ansible/repos\",\"events_url\":\"https://api.github.com/users/ansible/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/ansible/received_events\",\"type\":\"Organization\",\"site_admin\":false},\"repo\":{\"id\":3638964,\"node_id\":\"MDEwOlJlcG9zaXRvcnkzNjM4OTY0\",\"name\":\"ansible\",\"full_name\":\"ansible/ansible\",\"private\":false,\"owner\":{\"login\":\"ansible\",\"id\":1507452,\"node_id\":\"MDEyOk9yZ2FuaXphdGlvbjE1MDc0NTI=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/1507452?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/ansible\",\"html_url\":\"https://github.com/ansible\",\"followers_url\":\"https://api.github.com/users/ansible/followers\",\"following_url\":\"https://api.github.com/users/ansible/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/ansible/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/ansible/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/ansible/subscriptions\",\"organizations_url\":\"https://api.github.com/users/ansible/orgs\",\"repos_url\":\"https://api.github.com/users/ansible/repos\",\"events_url\":\"https://api.github.com/users/ansible/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/ansible/received_events\",\"type\":\"Organization\",\"site_admin\":false},\"html_url\":\"https://github.com/ansible/ansible\",\"description\":\"Ansible
        is a radically simple IT automation platform that makes your applications
        and systems easier to deploy and maintain. Automate everything from code deployment
        to network configuration to cloud management, in a language that approaches
        plain English, using SSH, with no agents to install on remote systems. https://docs.ansible.com.\",\"fork\":false,\"url\":\"https://api.github.com/repos/ansible/ansible\",\"forks_url\":\"https://api.github.com/repos/ansible/ansible/forks\",\"keys_url\":\"https://api.github.com/repos/ansible/ansible/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/ansible/ansible/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/ansible/ansible/teams\",\"hooks_url\":\"https://api.github.com/repos/ansible/ansible/hooks\",\"issue_events_url\":\"https://api.github.com/repos/ansible/ansible/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/ansible/ansible/events\",\"assignees_url\":\"https://api.github.com/repos/ansible/ansible/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/ansible/ansible/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/ansible/ansible/tags\",\"blobs_url\":\"https://api.github.com/repos/ansible/ansible/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/ansible/ansible/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/ansible/ansible/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/ansible/ansible/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/ansible/ansible/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/ansible/ansible/languages\",\"stargazers_url\":\"https://api.github.com/repos/ansible/ansible/stargazers\",\"contributors_url\":\"https://api.github.com/repos/ansible/ansible/contributors\",\"subscribers_url\":\"https://api.github.com/repos/ansible/ansible/subscribers\",\"subscription_url\":\"https://api.github.com/repos/ansible/ansible/subscription\",\"commits_url\":\"https://api.github.com/repos/ansible/ansible/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/ansible/ansible/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/ansible/ansible/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/ansible/ansible/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/ansible/ansible/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/ansible/ansible/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/ansible/ansible/merges\",\"archive_url\":\"https://api.github.com/repos/ansible/ansible/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/ansible/ansible/downloads\",\"issues_url\":\"https://api.github.com/repos/ansible/ansible/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/ansible/ansible/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/ansible/ansible/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/ansible/ansible/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/ansible/ansible/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/ansible/ansible/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/ansible/ansible/deployments\",\"created_at\":\"2012-03-06T14:58:02Z\",\"updated_at\":\"2021-02-27T02:40:42Z\",\"pushed_at\":\"2021-02-27T06:00:14Z\",\"git_url\":\"git://github.com/ansible/ansible.git\",\"ssh_url\":\"org-1507452@github.com:ansible/ansible.git\",\"clone_url\":\"https://github.com/ansible/ansible.git\",\"svn_url\":\"https://github.com/ansible/ansible\",\"homepage\":\"https://www.ansible.com/\",\"size\":194931,\"stargazers_count\":47033,\"watchers_count\":47033,\"language\":\"Python\",\"has_issues\":true,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":false,\"has_pages\":false,\"forks_count\":20311,\"mirror_url\":null,\"archived\":false,\"disabled\":false,\"open_issues_count\":1892,\"license\":{\"key\":\"gpl-3.0\",\"name\":\"GNU
        General Public License v3.0\",\"spdx_id\":\"GPL-3.0\",\"url\":\"https://api.github.com/licenses/gpl-3.0\",\"node_id\":\"MDc6TGljZW5zZTk=\"},\"forks\":20311,\"open_issues\":1892,\"watchers\":47033,\"default_branch\":\"devel\"}},\"_links\":{\"self\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/73487\"},\"html\":{\"href\":\"https://github.com/ansible/ansible/pull/73487\"},\"issue\":{\"href\":\"https://api.github.com/repos/ansible/ansible/issues/73487\"},\"comments\":{\"href\":\"https://api.github.com/repos/ansible/ansible/issues/73487/comments\"},\"review_comments\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/73487/comments\"},\"review_comment\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/comments{/number}\"},\"commits\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/73487/commits\"},\"statuses\":{\"href\":\"https://api.github.com/repos/ansible/ansible/statuses/fb53dc23950f22857e2b6c6c6e9771dd980c9be9\"}},\"author_association\":\"MEMBER\",\"auto_merge\":null,\"active_lock_reason\":null,\"merged\":true,\"mergeable\":null,\"rebaseable\":null,\"mergeable_state\":\"unknown\",\"merged_by\":{\"login\":\"jborean93\",\"id\":8462645,\"node_id\":\"MDQ6VXNlcjg0NjI2NDU=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/8462645?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/jborean93\",\"html_url\":\"https://github.com/jborean93\",\"followers_url\":\"https://api.github.com/users/jborean93/followers\",\"following_url\":\"https://api.github.com/users/jborean93/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/jborean93/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/jborean93/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/jborean93/subscriptions\",\"organizations_url\":\"https://api.github.com/users/jborean93/orgs\",\"repos_url\":\"https://api.github.com/users/jborean93/repos\",\"events_url\":\"https://api.github.com/users/jborean93/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/jborean93/received_events\",\"type\":\"User\",\"site_admin\":false},\"comments\":5,\"review_comments\":0,\"maintainer_can_modify\":false,\"commits\":3,\"additions\":119,\"deletions\":11,\"changed_files\":6}"
    headers:
      Access-Control-Allow-Origin:
      - '*'
      Access-Control-Expose-Headers:
      - ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining,
        X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes,
        X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset
      Cache-Control:
      - private, max-age=60, s-maxage=60
      Content-Encoding:
      - gzip
      Content-Security-Policy:
      - default-src 'none'
      Content-Type:
      - application/json; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:40 GMT
      Etag:
      - W/"2470aeabb68687c10200e6019d8bd456b7be62ccf6978d81d81e44aa93957cab"
      Last-Modified:
      - Wed, 10 Feb 2021 04:46:45 GMT
      Referrer-Policy:
      - origin-when-cross-origin, strict-origin-when-cross-origin
      Server:
      - GitHub.com
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - Accept, Authorization, Cookie, X-GitHub-OTP
      - Accept-Encoding, Accept, X-Requested-With
      X-Accepted-OAuth-Scopes:
      - ''
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Media-Type:
      - github.cloak-preview, github.groot-preview; format=json
      X-GitHub-Request-Id:
      - AAC0:74C8:29536:1A8586:6039F070
      X-OAuth-Scopes:
      - repo, workflow
      X-RateLimit-Limit:
      - '5000'
      X-RateLimit-Remaining:
      - '4943'
      X-RateLimit-Reset:
      - '1614412319'
      X-XSS-Protection:
      - 1; mode=block
      x-ratelimit-used:
      - '57'
    status:
      code: 200
      message: OK
    url: https://api.github.com/repos/ansible/ansible/pulls/73487
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Accept-Encoding:
      - gzip, deflate
      Cookie:
      - logged_in=no
      Host:
      - github.com
      User-Agent:
      - Python/3.8 aiohttp/3.7.3
    method: GET
    uri: https://github.com/ansible/ansible/pull/73487.diff
  response:
    body: {}
    headers:
      Cache-Control:
      - no-cache
      Content-Security-Policy:
      - 'default-src ''none''; base-uri ''self''; block-all-mixed-content; connect-src
        ''self'' uploads.github.com www.githubstatus.com collector.githubapp.com api.github.com
        github-cloud.s3.amazonaws.com github-production-repository-file-5c1aeb.s3.amazonaws.com
        github-production-upload-manifest-file-7fdce7.s3.amazonaws.com github-production-user-asset-6210df.s3.amazonaws.com
        cdn.optimizely.com logx.optimizely.com/v1/events wss://alive.github.com online.visualstudio.com/api/v1/locations;
        font-src github.githubassets.com; form-action ''self'' github.com gist.github.com;
        frame-ancestors ''none''; frame-src render.githubusercontent.com; img-src
        ''self'' data: github.githubassets.com identicons.github.com collector.githubapp.com
        github-cloud.s3.amazonaws.com user-images.githubusercontent.com/ *.githubusercontent.com;
        manifest-src ''self''; media-src ''none''; script-src github.githubassets.com;
        style-src ''unsafe-inline'' github.githubassets.com; worker-src github.com/socket-worker-5029ae85.js
        gist.github.com/socket-worker-5029ae85.js'
      Content-Type:
      - text/html; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:40 GMT
      Expect-CT:
      - max-age=2592000, report-uri="https://api.github.com/_private/browser/errors"
      Location:
      - https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73487.diff
      Referrer-Policy:
      - no-referrer-when-downgrade
      Server:
      - GitHub.com
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - X-PJAX
      - Accept-Encoding, Accept, X-Requested-With
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Request-Id:
      - D35A:3DBA:657B01:8540CE:6039F070
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 302
      message: Found
    url: https://github.com/ansible/ansible/pull/73487.diff
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Accept-Encoding:
      - gzip, deflate
      Host:
      - patch-diff.githubusercontent.com
      User-Agent:
      - Python/3.8 aiohttp/3.7.3
    method: GET
    uri: https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73487.diff
  response:
    body:
      string: "diff --git a/changelogs/fragments/no_log-fallback.yml b/changelogs/fragments/no_log-fallback.yml\nnew
        file mode 100644\nindex 0000000000000..6947531358576\n--- /dev/null\n+++ b/changelogs/fragments/no_log-fallback.yml\n@@
        -0,0 +1,2 @@\n+security_fixes:\n+  - '**security issue** - Mask default and
        fallback values for ``no_log`` module options (CVE-2021-20228)'\ndiff --git
        a/lib/ansible/module_utils/basic.py b/lib/ansible/module_utils/basic.py\nindex
        6c756a909e2f2..9cc8daa9fe496 100644\n--- a/lib/ansible/module_utils/basic.py\n+++
        b/lib/ansible/module_utils/basic.py\n@@ -713,6 +713,9 @@ def __init__(self,
        argument_spec, bypass_checks=False, no_log=False,\n                 if k not
        in self.argument_spec:\n                     self.argument_spec[k] = v\n \n+
        \       # Save parameter values that should never be logged\n+        self.no_log_values
        = set()\n+\n         self._load_params()\n         self._set_fallbacks()\n
        \n@@ -724,8 +727,6 @@ def __init__(self, argument_spec, bypass_checks=False,
        no_log=False,\n             print('\\n{\"failed\": true, \"msg\": \"Module
        alias error: %s\"}' % to_native(e))\n             sys.exit(1)\n \n-        #
        Save parameter values that should never be logged\n-        self.no_log_values
        = set()\n         self._handle_no_log_values()\n \n         # check the locale
        as set by the current environment, and reset to\n@@ -1930,14 +1931,15 @@ def
        _set_defaults(self, pre=True, spec=None, param=None):\n             param
        = self.params\n         for (k, v) in spec.items():\n             default
        = v.get('default', None)\n-            if pre is True:\n-                #
        this prevents setting defaults on required items\n-                if default
        is not None and k not in param:\n-                    param[k] = default\n-
        \           else:\n-                # make sure things without a default still
        get set None\n-                if k not in param:\n-                    param[k]
        = default\n+\n+            # This prevents setting defaults on required items
        on the 1st run,\n+            # otherwise will set things without a default
        to None on the 2nd.\n+            if k not in param and (default is not None
        or not pre):\n+                # Make sure any default value for no_log fields
        are masked.\n+                if v.get('no_log', False) and default:\n+                    self.no_log_values.add(default)\n+\n+
        \               param[k] = default\n \n     def _set_fallbacks(self, spec=None,
        param=None):\n         if spec is None:\n@@ -1957,9 +1959,13 @@ def _set_fallbacks(self,
        spec=None, param=None):\n                     else:\n                         fallback_args
        = item\n                 try:\n-                    param[k] = fallback_strategy(*fallback_args,
        **fallback_kwargs)\n+                    fallback_value = fallback_strategy(*fallback_args,
        **fallback_kwargs)\n                 except AnsibleFallbackNotFound:\n                     continue\n+
        \               else:\n+                    if v.get('no_log', False) and
        fallback_value:\n+                        self.no_log_values.add(fallback_value)\n+
        \                   param[k] = fallback_value\n \n     def _load_params(self):\n
        \        ''' read the input and set the params attribute.\ndiff --git a/test/integration/targets/module_utils/callback/pure_json.py
        b/test/integration/targets/module_utils/callback/pure_json.py\nnew file mode
        100644\nindex 0000000000000..1723d7bbe869b\n--- /dev/null\n+++ b/test/integration/targets/module_utils/callback/pure_json.py\n@@
        -0,0 +1,31 @@\n+# (c) 2021 Ansible Project\n+# GNU General Public License
        v3.0+ (see COPYING or https://www.gnu.org/licenses/gpl-3.0.txt)\n+\n+from
        __future__ import (absolute_import, division, print_function)\n+__metaclass__
        = type\n+\n+DOCUMENTATION = '''\n+    name: pure_json\n+    type: stdout\n+
        \   short_description: only outputs the module results as json\n+'''\n+\n+import
        json\n+\n+from ansible.plugins.callback import CallbackBase\n+\n+\n+class
        CallbackModule(CallbackBase):\n+\n+    CALLBACK_VERSION = 2.0\n+    CALLBACK_TYPE
        = 'stdout'\n+    CALLBACK_NAME = 'pure_json'\n+\n+    def v2_runner_on_failed(self,
        result, ignore_errors=False):\n+        self._display.display(json.dumps(result._result))\n+\n+
        \   def v2_runner_on_ok(self, result):\n+        self._display.display(json.dumps(result._result))\n+\n+
        \   def v2_runner_on_skipped(self, result):\n+        self._display.display(json.dumps(result._result))\ndiff
        --git a/test/integration/targets/module_utils/library/test_no_log.py b/test/integration/targets/module_utils/library/test_no_log.py\nnew
        file mode 100644\nindex 0000000000000..770e0b3a17e0c\n--- /dev/null\n+++ b/test/integration/targets/module_utils/library/test_no_log.py\n@@
        -0,0 +1,35 @@\n+#!/usr/bin/python\n+# (c) 2021 Ansible Project\n+# GNU General
        Public License v3.0+ (see COPYING or https://www.gnu.org/licenses/gpl-3.0.txt)\n+\n+from
        __future__ import absolute_import, division, print_function\n+__metaclass__
        = type\n+\n+\n+from ansible.module_utils.basic import AnsibleModule, env_fallback\n+\n+\n+def
        main():\n+    module = AnsibleModule(\n+        argument_spec=dict(\n+            explicit_pass=dict(type='str',
        no_log=True),\n+            fallback_pass=dict(type='str', no_log=True, fallback=(env_fallback,
        ['SECRET_ENV'])),\n+            default_pass=dict(type='str', no_log=True,
        default='zyx'),\n+            normal=dict(type='str', default='plaintext'),\n+
        \           suboption=dict(\n+                type='dict',\n+                options=dict(\n+
        \                   explicit_sub_pass=dict(type='str', no_log=True),\n+                    fallback_sub_pass=dict(type='str',
        no_log=True, fallback=(env_fallback, ['SECRET_SUB_ENV'])),\n+                    default_sub_pass=dict(type='str',
        no_log=True, default='xvu'),\n+                    normal=dict(type='str',
        default='plaintext'),\n+                ),\n+            ),\n+        ),\n+
        \   )\n+\n+    module.exit_json(changed=False)\n+\n+\n+if __name__ == '__main__':\n+
        \   main()\ndiff --git a/test/integration/targets/module_utils/module_utils_test_no_log.yml
        b/test/integration/targets/module_utils/module_utils_test_no_log.yml\nnew
        file mode 100644\nindex 0000000000000..bad2efd495db2\n--- /dev/null\n+++ b/test/integration/targets/module_utils/module_utils_test_no_log.yml\n@@
        -0,0 +1,9 @@\n+# This is called by module_utils_vvvvv.yml with a custom callback\n+-
        hosts: testhost\n+  gather_facts: no\n+  tasks:\n+    - name: Check no_log
        invocation results\n+      test_no_log:\n+        explicit_pass: abc\n+        suboption:\n+
        \         explicit_sub_pass: def\ndiff --git a/test/integration/targets/module_utils/module_utils_vvvvv.yml
        b/test/integration/targets/module_utils/module_utils_vvvvv.yml\nindex 1fe9624f7b48f..6a9f92013c50e
        100644\n--- a/test/integration/targets/module_utils/module_utils_vvvvv.yml\n+++
        b/test/integration/targets/module_utils/module_utils_vvvvv.yml\n@@ -3,3 +3,28
        @@\n   tasks:\n   - name: Use a specially crafted module to see if things
        were imported correctly\n     test:\n+\n+  # Invocation usually is output
        with 3vs or more, our callback plugin displays it anyway\n+  - name: Check
        no_log invocation results\n+    command: ansible-playbook -i {{ inventory_file
        }} module_utils_test_no_log.yml\n+    environment:\n+      ANSIBLE_CALLBACK_PLUGINS:
        callback\n+      ANSIBLE_STDOUT_CALLBACK: pure_json\n+      SECRET_ENV: ghi\n+
        \     SECRET_SUB_ENV: jkl\n+    register: no_log_invocation\n+\n+  - set_fact:\n+
        \     no_log_invocation: '{{ no_log_invocation.stdout | trim | from_json }}'\n+\n+
        \ - name: check no log values from fallback or default are masked\n+    assert:\n+
        \     that:\n+      - no_log_invocation.invocation.module_args.default_pass
        == 'VALUE_SPECIFIED_IN_NO_LOG_PARAMETER'\n+      - no_log_invocation.invocation.module_args.explicit_pass
        == 'VALUE_SPECIFIED_IN_NO_LOG_PARAMETER'\n+      - no_log_invocation.invocation.module_args.fallback_pass
        == 'VALUE_SPECIFIED_IN_NO_LOG_PARAMETER'\n+      - no_log_invocation.invocation.module_args.normal
        == 'plaintext'\n+      - no_log_invocation.invocation.module_args.suboption.default_sub_pass
        == 'VALUE_SPECIFIED_IN_NO_LOG_PARAMETER'\n+      - no_log_invocation.invocation.module_args.suboption.explicit_sub_pass
        == 'VALUE_SPECIFIED_IN_NO_LOG_PARAMETER'\n+      - no_log_invocation.invocation.module_args.suboption.fallback_sub_pass
        == 'VALUE_SPECIFIED_IN_NO_LOG_PARAMETER'\n+      - no_log_invocation.invocation.module_args.suboption.normal
        == 'plaintext'\n"
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Content-Encoding:
      - gzip
      Content-Security-Policy:
      - 'default-src ''none''; base-uri ''self''; block-all-mixed-content; connect-src
        ''self'' uploads.github.com www.githubstatus.com collector.githubapp.com api.github.com
        github-cloud.s3.amazonaws.com github-production-repository-file-5c1aeb.s3.amazonaws.com
        github-production-upload-manifest-file-7fdce7.s3.amazonaws.com github-production-user-asset-6210df.s3.amazonaws.com
        cdn.optimizely.com logx.optimizely.com/v1/events wss://alive.github.com; font-src
        github.githubassets.com; form-action ''self'' github.com gist.github.com;
        frame-ancestors ''none''; frame-src render.githubusercontent.com; img-src
        ''self'' data: github.githubassets.com identicons.github.com collector.githubapp.com
        github-cloud.s3.amazonaws.com user-images.githubusercontent.com/ *.githubusercontent.com;
        manifest-src ''self''; media-src ''none''; script-src github.githubassets.com;
        style-src ''unsafe-inline'' github.githubassets.com; worker-src github.com/socket-worker-5029ae85.js
        gist.github.com/socket-worker-5029ae85.js'
      Content-Type:
      - text/plain; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:40 GMT
      Etag:
      - W/"0687d3ebbec1ca07d0b0dd032415ee3e"
      Expect-CT:
      - max-age=2592000, report-uri="https://api.github.com/_private/browser/errors"
      Referrer-Policy:
      - origin-when-cross-origin, strict-origin-when-cross-origin
      Server:
      - GitHub.com
      Set-Cookie:
      - logged_in=no; domain=.github.com; path=/; expires=Sun, 27 Feb 2022 07:10:40
        GMT; secure; HttpOnly; SameSite=Lax
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - X-PJAX
      - Accept-Encoding, Accept, X-Requested-With
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Request-Id:
      - D35C:1A52:95E25D:B71959:6039F070
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
    url: https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73487.diff
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Cookie:
      - logged_in=no
    method: GET
    uri: https://api.github.com/repos/ansible/ansible/pulls/73487
  response:
    body:
      string: "{\"url\":\"https://api.github.com/repos/ansible/ansible/pulls/73487\",\"id\":567890636,\"node_id\":\"MDExOlB1bGxSZXF1ZXN0NTY3ODkwNjM2\",\"html_url\":\"https://github.com/ansible/ansible/pull/73487\",\"diff_url\":\"https://github.com/ansible/ansible/pull/73487.diff\",\"patch_url\":\"https://github.com/ansible/ansible/pull/73487.patch\",\"issue_url\":\"https://api.github.com/repos/ansible/ansible/issues/73487\",\"number\":73487,\"state\":\"closed\",\"locked\":false,\"title\":\"no_log
        mask suboption fallback values and defaults CVE-2021-20228\",\"user\":{\"login\":\"jborean93\",\"id\":8462645,\"node_id\":\"MDQ6VXNlcjg0NjI2NDU=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/8462645?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/jborean93\",\"html_url\":\"https://github.com/jborean93\",\"followers_url\":\"https://api.github.com/users/jborean93/followers\",\"following_url\":\"https://api.github.com/users/jborean93/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/jborean93/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/jborean93/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/jborean93/subscriptions\",\"organizations_url\":\"https://api.github.com/users/jborean93/orgs\",\"repos_url\":\"https://api.github.com/users/jborean93/repos\",\"events_url\":\"https://api.github.com/users/jborean93/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/jborean93/received_events\",\"type\":\"User\",\"site_admin\":false},\"body\":\"#####
        SUMMARY\\r\\nMake sure default and fallback values for `no_log` fields are
        masked in the module output.\\r\\n\\r\\nCVE-2021-20228\\r\\n\\r\\n##### ISSUE
        TYPE\\r\\n- Bugfix Pull Request\\r\\n\\r\\n##### COMPONENT NAME\\r\\nbasic.py\",\"created_at\":\"2021-02-04T20:17:58Z\",\"updated_at\":\"2021-02-08T07:51:08Z\",\"closed_at\":\"2021-02-04T23:11:56Z\",\"merged_at\":\"2021-02-04T23:11:56Z\",\"merge_commit_sha\":\"0cdc410dce6658e93c06fa27e0100ddbb11e7015\",\"assignee\":null,\"assignees\":[],\"requested_reviewers\":[],\"requested_teams\":[],\"labels\":[{\"id\":1742671738,\"node_id\":\"MDU6TGFiZWwxNzQyNjcxNzM4\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/affects_2.11\",\"name\":\"affects_2.11\",\"color\":\"5319e7\",\"default\":false,\"description\":\"\"},{\"id\":785271699,\"node_id\":\"MDU6TGFiZWw3ODUyNzE2OTk=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/bug\",\"name\":\"bug\",\"color\":\"fbca04\",\"default\":true,\"description\":\"This
        issue/PR relates to a bug.\"},{\"id\":1285191701,\"node_id\":\"MDU6TGFiZWwxMjg1MTkxNzAx\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/collection\",\"name\":\"collection\",\"color\":\"b60205\",\"default\":false,\"description\":\"Related
        to Ansible Collections work\"},{\"id\":1991487163,\"node_id\":\"MDU6TGFiZWwxOTkxNDg3MTYz\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/collection:amazon.aws\",\"name\":\"collection:amazon.aws\",\"color\":\"ededed\",\"default\":false,\"description\":null},{\"id\":513652538,\"node_id\":\"MDU6TGFiZWw1MTM2NTI1Mzg=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/core_review\",\"name\":\"core_review\",\"color\":\"ededed\",\"default\":false,\"description\":\"In
        order to be merged, this PR must follow the core review workflow.\"},{\"id\":636327968,\"node_id\":\"MDU6TGFiZWw2MzYzMjc5Njg=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/support:community\",\"name\":\"support:community\",\"color\":\"ededed\",\"default\":false,\"description\":\"This
        issue/PR relates to code supported by the Ansible community.\"},{\"id\":636352796,\"node_id\":\"MDU6TGFiZWw2MzYzNTI3OTY=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/support:core\",\"name\":\"support:core\",\"color\":\"ededed\",\"default\":false,\"description\":\"This
        issue/PR relates to code supported by the Ansible Engineering Team.\"}],\"milestone\":null,\"draft\":false,\"commits_url\":\"https://api.github.com/repos/ansible/ansible/pulls/73487/commits\",\"review_comments_url\":\"https://api.github.com/repos/ansible/ansible/pulls/73487/comments\",\"review_comment_url\":\"https://api.github.com/repos/ansible/ansible/pulls/comments{/number}\",\"comments_url\":\"https://api.github.com/repos/ansible/ansible/issues/73487/comments\",\"statuses_url\":\"https://api.github.com/repos/ansible/ansible/statuses/fb53dc23950f22857e2b6c6c6e9771dd980c9be9\",\"head\":{\"label\":\"jborean93:nolog-suboptions\",\"ref\":\"nolog-suboptions\",\"sha\":\"fb53dc23950f22857e2b6c6c6e9771dd980c9be9\",\"user\":{\"login\":\"jborean93\",\"id\":8462645,\"node_id\":\"MDQ6VXNlcjg0NjI2NDU=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/8462645?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/jborean93\",\"html_url\":\"https://github.com/jborean93\",\"followers_url\":\"https://api.github.com/users/jborean93/followers\",\"following_url\":\"https://api.github.com/users/jborean93/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/jborean93/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/jborean93/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/jborean93/subscriptions\",\"organizations_url\":\"https://api.github.com/users/jborean93/orgs\",\"repos_url\":\"https://api.github.com/users/jborean93/repos\",\"events_url\":\"https://api.github.com/users/jborean93/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/jborean93/received_events\",\"type\":\"User\",\"site_admin\":false},\"repo\":{\"id\":72729201,\"node_id\":\"MDEwOlJlcG9zaXRvcnk3MjcyOTIwMQ==\",\"name\":\"ansible\",\"full_name\":\"jborean93/ansible\",\"private\":false,\"owner\":{\"login\":\"jborean93\",\"id\":8462645,\"node_id\":\"MDQ6VXNlcjg0NjI2NDU=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/8462645?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/jborean93\",\"html_url\":\"https://github.com/jborean93\",\"followers_url\":\"https://api.github.com/users/jborean93/followers\",\"following_url\":\"https://api.github.com/users/jborean93/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/jborean93/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/jborean93/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/jborean93/subscriptions\",\"organizations_url\":\"https://api.github.com/users/jborean93/orgs\",\"repos_url\":\"https://api.github.com/users/jborean93/repos\",\"events_url\":\"https://api.github.com/users/jborean93/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/jborean93/received_events\",\"type\":\"User\",\"site_admin\":false},\"html_url\":\"https://github.com/jborean93/ansible\",\"description\":\"Ansible
        is a radically simple IT automation platform that makes your applications
        and systems easier to deploy. Avoid writing scripts or custom code to deploy
        and update your applications\u2014 automate in a language that approaches
        plain English, using SSH, with no agents to install on remote systems.\",\"fork\":true,\"url\":\"https://api.github.com/repos/jborean93/ansible\",\"forks_url\":\"https://api.github.com/repos/jborean93/ansible/forks\",\"keys_url\":\"https://api.github.com/repos/jborean93/ansible/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/jborean93/ansible/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/jborean93/ansible/teams\",\"hooks_url\":\"https://api.github.com/repos/jborean93/ansible/hooks\",\"issue_events_url\":\"https://api.github.com/repos/jborean93/ansible/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/jborean93/ansible/events\",\"assignees_url\":\"https://api.github.com/repos/jborean93/ansible/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/jborean93/ansible/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/jborean93/ansible/tags\",\"blobs_url\":\"https://api.github.com/repos/jborean93/ansible/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/jborean93/ansible/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/jborean93/ansible/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/jborean93/ansible/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/jborean93/ansible/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/jborean93/ansible/languages\",\"stargazers_url\":\"https://api.github.com/repos/jborean93/ansible/stargazers\",\"contributors_url\":\"https://api.github.com/repos/jborean93/ansible/contributors\",\"subscribers_url\":\"https://api.github.com/repos/jborean93/ansible/subscribers\",\"subscription_url\":\"https://api.github.com/repos/jborean93/ansible/subscription\",\"commits_url\":\"https://api.github.com/repos/jborean93/ansible/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/jborean93/ansible/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/jborean93/ansible/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/jborean93/ansible/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/jborean93/ansible/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/jborean93/ansible/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/jborean93/ansible/merges\",\"archive_url\":\"https://api.github.com/repos/jborean93/ansible/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/jborean93/ansible/downloads\",\"issues_url\":\"https://api.github.com/repos/jborean93/ansible/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/jborean93/ansible/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/jborean93/ansible/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/jborean93/ansible/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/jborean93/ansible/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/jborean93/ansible/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/jborean93/ansible/deployments\",\"created_at\":\"2016-11-03T09:27:23Z\",\"updated_at\":\"2021-02-26T00:49:47Z\",\"pushed_at\":\"2021-02-26T00:49:30Z\",\"git_url\":\"git://github.com/jborean93/ansible.git\",\"ssh_url\":\"git@github.com:jborean93/ansible.git\",\"clone_url\":\"https://github.com/jborean93/ansible.git\",\"svn_url\":\"https://github.com/jborean93/ansible\",\"homepage\":\"http://ansible.com/\",\"size\":173974,\"stargazers_count\":0,\"watchers_count\":0,\"language\":\"Python\",\"has_issues\":false,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":false,\"has_pages\":false,\"forks_count\":0,\"mirror_url\":null,\"archived\":false,\"disabled\":false,\"open_issues_count\":0,\"license\":{\"key\":\"gpl-3.0\",\"name\":\"GNU
        General Public License v3.0\",\"spdx_id\":\"GPL-3.0\",\"url\":\"https://api.github.com/licenses/gpl-3.0\",\"node_id\":\"MDc6TGljZW5zZTk=\"},\"forks\":0,\"open_issues\":0,\"watchers\":0,\"default_branch\":\"devel\"}},\"base\":{\"label\":\"ansible:devel\",\"ref\":\"devel\",\"sha\":\"7fb7d138fb1f5e3977d800cd2a56c60a101713ee\",\"user\":{\"login\":\"ansible\",\"id\":1507452,\"node_id\":\"MDEyOk9yZ2FuaXphdGlvbjE1MDc0NTI=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/1507452?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/ansible\",\"html_url\":\"https://github.com/ansible\",\"followers_url\":\"https://api.github.com/users/ansible/followers\",\"following_url\":\"https://api.github.com/users/ansible/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/ansible/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/ansible/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/ansible/subscriptions\",\"organizations_url\":\"https://api.github.com/users/ansible/orgs\",\"repos_url\":\"https://api.github.com/users/ansible/repos\",\"events_url\":\"https://api.github.com/users/ansible/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/ansible/received_events\",\"type\":\"Organization\",\"site_admin\":false},\"repo\":{\"id\":3638964,\"node_id\":\"MDEwOlJlcG9zaXRvcnkzNjM4OTY0\",\"name\":\"ansible\",\"full_name\":\"ansible/ansible\",\"private\":false,\"owner\":{\"login\":\"ansible\",\"id\":1507452,\"node_id\":\"MDEyOk9yZ2FuaXphdGlvbjE1MDc0NTI=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/1507452?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/ansible\",\"html_url\":\"https://github.com/ansible\",\"followers_url\":\"https://api.github.com/users/ansible/followers\",\"following_url\":\"https://api.github.com/users/ansible/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/ansible/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/ansible/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/ansible/subscriptions\",\"organizations_url\":\"https://api.github.com/users/ansible/orgs\",\"repos_url\":\"https://api.github.com/users/ansible/repos\",\"events_url\":\"https://api.github.com/users/ansible/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/ansible/received_events\",\"type\":\"Organization\",\"site_admin\":false},\"html_url\":\"https://github.com/ansible/ansible\",\"description\":\"Ansible
        is a radically simple IT automation platform that makes your applications
        and systems easier to deploy and maintain. Automate everything from code deployment
        to network configuration to cloud management, in a language that approaches
        plain English, using SSH, with no agents to install on remote systems. https://docs.ansible.com.\",\"fork\":false,\"url\":\"https://api.github.com/repos/ansible/ansible\",\"forks_url\":\"https://api.github.com/repos/ansible/ansible/forks\",\"keys_url\":\"https://api.github.com/repos/ansible/ansible/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/ansible/ansible/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/ansible/ansible/teams\",\"hooks_url\":\"https://api.github.com/repos/ansible/ansible/hooks\",\"issue_events_url\":\"https://api.github.com/repos/ansible/ansible/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/ansible/ansible/events\",\"assignees_url\":\"https://api.github.com/repos/ansible/ansible/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/ansible/ansible/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/ansible/ansible/tags\",\"blobs_url\":\"https://api.github.com/repos/ansible/ansible/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/ansible/ansible/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/ansible/ansible/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/ansible/ansible/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/ansible/ansible/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/ansible/ansible/languages\",\"stargazers_url\":\"https://api.github.com/repos/ansible/ansible/stargazers\",\"contributors_url\":\"https://api.github.com/repos/ansible/ansible/contributors\",\"subscribers_url\":\"https://api.github.com/repos/ansible/ansible/subscribers\",\"subscription_url\":\"https://api.github.com/repos/ansible/ansible/subscription\",\"commits_url\":\"https://api.github.com/repos/ansible/ansible/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/ansible/ansible/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/ansible/ansible/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/ansible/ansible/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/ansible/ansible/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/ansible/ansible/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/ansible/ansible/merges\",\"archive_url\":\"https://api.github.com/repos/ansible/ansible/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/ansible/ansible/downloads\",\"issues_url\":\"https://api.github.com/repos/ansible/ansible/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/ansible/ansible/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/ansible/ansible/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/ansible/ansible/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/ansible/ansible/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/ansible/ansible/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/ansible/ansible/deployments\",\"created_at\":\"2012-03-06T14:58:02Z\",\"updated_at\":\"2021-02-27T02:40:42Z\",\"pushed_at\":\"2021-02-27T06:00:14Z\",\"git_url\":\"git://github.com/ansible/ansible.git\",\"ssh_url\":\"org-1507452@github.com:ansible/ansible.git\",\"clone_url\":\"https://github.com/ansible/ansible.git\",\"svn_url\":\"https://github.com/ansible/ansible\",\"homepage\":\"https://www.ansible.com/\",\"size\":194931,\"stargazers_count\":47033,\"watchers_count\":47033,\"language\":\"Python\",\"has_issues\":true,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":false,\"has_pages\":false,\"forks_count\":20311,\"mirror_url\":null,\"archived\":false,\"disabled\":false,\"open_issues_count\":1892,\"license\":{\"key\":\"gpl-3.0\",\"name\":\"GNU
        General Public License v3.0\",\"spdx_id\":\"GPL-3.0\",\"url\":\"https://api.github.com/licenses/gpl-3.0\",\"node_id\":\"MDc6TGljZW5zZTk=\"},\"forks\":20311,\"open_issues\":1892,\"watchers\":47033,\"default_branch\":\"devel\"}},\"_links\":{\"self\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/73487\"},\"html\":{\"href\":\"https://github.com/ansible/ansible/pull/73487\"},\"issue\":{\"href\":\"https://api.github.com/repos/ansible/ansible/issues/73487\"},\"comments\":{\"href\":\"https://api.github.com/repos/ansible/ansible/issues/73487/comments\"},\"review_comments\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/73487/comments\"},\"review_comment\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/comments{/number}\"},\"commits\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/73487/commits\"},\"statuses\":{\"href\":\"https://api.github.com/repos/ansible/ansible/statuses/fb53dc23950f22857e2b6c6c6e9771dd980c9be9\"}},\"author_association\":\"MEMBER\",\"auto_merge\":null,\"active_lock_reason\":null,\"merged\":true,\"mergeable\":null,\"rebaseable\":null,\"mergeable_state\":\"unknown\",\"merged_by\":{\"login\":\"jborean93\",\"id\":8462645,\"node_id\":\"MDQ6VXNlcjg0NjI2NDU=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/8462645?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/jborean93\",\"html_url\":\"https://github.com/jborean93\",\"followers_url\":\"https://api.github.com/users/jborean93/followers\",\"following_url\":\"https://api.github.com/users/jborean93/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/jborean93/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/jborean93/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/jborean93/subscriptions\",\"organizations_url\":\"https://api.github.com/users/jborean93/orgs\",\"repos_url\":\"https://api.github.com/users/jborean93/repos\",\"events_url\":\"https://api.github.com/users/jborean93/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/jborean93/received_events\",\"type\":\"User\",\"site_admin\":false},\"comments\":5,\"review_comments\":0,\"maintainer_can_modify\":false,\"commits\":3,\"additions\":119,\"deletions\":11,\"changed_files\":6}"
    headers:
      Access-Control-Allow-Origin:
      - '*'
      Access-Control-Expose-Headers:
      - ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining,
        X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes,
        X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset
      Cache-Control:
      - private, max-age=60, s-maxage=60
      Content-Encoding:
      - gzip
      Content-Security-Policy:
      - default-src 'none'
      Content-Type:
      - application/json; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:40 GMT
      Etag:
      - W/"2470aeabb68687c10200e6019d8bd456b7be62ccf6978d81d81e44aa93957cab"
      Last-Modified:
      - Wed, 10 Feb 2021 04:46:45 GMT
      Referrer-Policy:
      - origin-when-cross-origin, strict-origin-when-cross-origin
      Server:
      - GitHub.com
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - Accept, Authorization, Cookie, X-GitHub-OTP
      - Accept-Encoding, Accept, X-Requested-With
      X-Accepted-OAuth-Scopes:
      - ''
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Media-Type:
      - github.cloak-preview, github.groot-preview; format=json
      X-GitHub-Request-Id:
      - AAC0:74C8:29537:1A858E:6039F070
      X-OAuth-Scopes:
      - repo, workflow
      X-RateLimit-Limit:
      - '5000'
      X-RateLimit-Remaining:
      - '4942'
      X-RateLimit-Reset:
      - '1614412319'
      X-XSS-Protection:
      - 1; mode=block
      x-ratelimit-used:
      - '58'
    status:
      code: 200
      message: OK
    url: https://api.github.com/repos/ansible/ansible/pulls/73487
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Accept-Encoding:
      - gzip, deflate
      Cookie:
      - logged_in=no
      Host:
      - github.com
      User-Agent:
      - Python/3.8 aiohttp/3.7.3
    method: GET
    uri: https://github.com/ansible/ansible/pull/73487.diff
  response:
    body: {}
    headers:
      Cache-Control:
      - no-cache
      Content-Security-Policy:
      - 'default-src ''none''; base-uri ''self''; block-all-mixed-content; connect-src
        ''self'' uploads.github.com www.githubstatus.com collector.githubapp.com api.github.com
        github-cloud.s3.amazonaws.com github-production-repository-file-5c1aeb.s3.amazonaws.com
        github-production-upload-manifest-file-7fdce7.s3.amazonaws.com github-production-user-asset-6210df.s3.amazonaws.com
        cdn.optimizely.com logx.optimizely.com/v1/events wss://alive.github.com online.visualstudio.com/api/v1/locations;
        font-src github.githubassets.com; form-action ''self'' github.com gist.github.com;
        frame-ancestors ''none''; frame-src render.githubusercontent.com; img-src
        ''self'' data: github.githubassets.com identicons.github.com collector.githubapp.com
        github-cloud.s3.amazonaws.com user-images.githubusercontent.com/ *.githubusercontent.com;
        manifest-src ''self''; media-src ''none''; script-src github.githubassets.com;
        style-src ''unsafe-inline'' github.githubassets.com; worker-src github.com/socket-worker-5029ae85.js
        gist.github.com/socket-worker-5029ae85.js'
      Content-Type:
      - text/html; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:40 GMT
      Expect-CT:
      - max-age=2592000, report-uri="https://api.github.com/_private/browser/errors"
      Location:
      - https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73487.diff
      Referrer-Policy:
      - no-referrer-when-downgrade
      Server:
      - GitHub.com
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - X-PJAX
      - Accept-Encoding, Accept, X-Requested-With
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Request-Id:
      - D35A:3DBA:657B33:85410A:6039F070
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 302
      message: Found
    url: https://github.com/ansible/ansible/pull/73487.diff
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Accept-Encoding:
      - gzip, deflate
      Host:
      - patch-diff.githubusercontent.com
      User-Agent:
      - Python/3.8 aiohttp/3.7.3
    method: GET
    uri: https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73487.diff
  response:
    body:
      string: "diff --git a/changelogs/fragments/no_log-fallback.yml b/changelogs/fragments/no_log-fallback.yml\nnew
        file mode 100644\nindex 0000000000000..6947531358576\n--- /dev/null\n+++ b/changelogs/fragments/no_log-fallback.yml\n@@
        -0,0 +1,2 @@\n+security_fixes:\n+  - '**security issue** - Mask default and
        fallback values for ``no_log`` module options (CVE-2021-20228)'\ndiff --git
        a/lib/ansible/module_utils/basic.py b/lib/ansible/module_utils/basic.py\nindex
        6c756a909e2f2..9cc8daa9fe496 100644\n--- a/lib/ansible/module_utils/basic.py\n+++
        b/lib/ansible/module_utils/basic.py\n@@ -713,6 +713,9 @@ def __init__(self,
        argument_spec, bypass_checks=False, no_log=False,\n                 if k not
        in self.argument_spec:\n                     self.argument_spec[k] = v\n \n+
        \       # Save parameter values that should never be logged\n+        self.no_log_values
        = set()\n+\n         self._load_params()\n         self._set_fallbacks()\n
        \n@@ -724,8 +727,6 @@ def __init__(self, argument_spec, bypass_checks=False,
        no_log=False,\n             print('\\n{\"failed\": true, \"msg\": \"Module
        alias error: %s\"}' % to_native(e))\n             sys.exit(1)\n \n-        #
        Save parameter values that should never be logged\n-        self.no_log_values
        = set()\n         self._handle_no_log_values()\n \n         # check the locale
        as set by the current environment, and reset to\n@@ -1930,14 +1931,15 @@ def
        _set_defaults(self, pre=True, spec=None, param=None):\n             param
        = self.params\n         for (k, v) in spec.items():\n             default
        = v.get('default', None)\n-            if pre is True:\n-                #
        this prevents setting defaults on required items\n-                if default
        is not None and k not in param:\n-                    param[k] = default\n-
        \           else:\n-                # make sure things without a default still
        get set None\n-                if k not in param:\n-                    param[k]
        = default\n+\n+            # This prevents setting defaults on required items
        on the 1st run,\n+            # otherwise will set things without a default
        to None on the 2nd.\n+            if k not in param and (default is not None
        or not pre):\n+                # Make sure any default value for no_log fields
        are masked.\n+                if v.get('no_log', False) and default:\n+                    self.no_log_values.add(default)\n+\n+
        \               param[k] = default\n \n     def _set_fallbacks(self, spec=None,
        param=None):\n         if spec is None:\n@@ -1957,9 +1959,13 @@ def _set_fallbacks(self,
        spec=None, param=None):\n                     else:\n                         fallback_args
        = item\n                 try:\n-                    param[k] = fallback_strategy(*fallback_args,
        **fallback_kwargs)\n+                    fallback_value = fallback_strategy(*fallback_args,
        **fallback_kwargs)\n                 except AnsibleFallbackNotFound:\n                     continue\n+
        \               else:\n+                    if v.get('no_log', False) and
        fallback_value:\n+                        self.no_log_values.add(fallback_value)\n+
        \                   param[k] = fallback_value\n \n     def _load_params(self):\n
        \        ''' read the input and set the params attribute.\ndiff --git a/test/integration/targets/module_utils/callback/pure_json.py
        b/test/integration/targets/module_utils/callback/pure_json.py\nnew file mode
        100644\nindex 0000000000000..1723d7bbe869b\n--- /dev/null\n+++ b/test/integration/targets/module_utils/callback/pure_json.py\n@@
        -0,0 +1,31 @@\n+# (c) 2021 Ansible Project\n+# GNU General Public License
        v3.0+ (see COPYING or https://www.gnu.org/licenses/gpl-3.0.txt)\n+\n+from
        __future__ import (absolute_import, division, print_function)\n+__metaclass__
        = type\n+\n+DOCUMENTATION = '''\n+    name: pure_json\n+    type: stdout\n+
        \   short_description: only outputs the module results as json\n+'''\n+\n+import
        json\n+\n+from ansible.plugins.callback import CallbackBase\n+\n+\n+class
        CallbackModule(CallbackBase):\n+\n+    CALLBACK_VERSION = 2.0\n+    CALLBACK_TYPE
        = 'stdout'\n+    CALLBACK_NAME = 'pure_json'\n+\n+    def v2_runner_on_failed(self,
        result, ignore_errors=False):\n+        self._display.display(json.dumps(result._result))\n+\n+
        \   def v2_runner_on_ok(self, result):\n+        self._display.display(json.dumps(result._result))\n+\n+
        \   def v2_runner_on_skipped(self, result):\n+        self._display.display(json.dumps(result._result))\ndiff
        --git a/test/integration/targets/module_utils/library/test_no_log.py b/test/integration/targets/module_utils/library/test_no_log.py\nnew
        file mode 100644\nindex 0000000000000..770e0b3a17e0c\n--- /dev/null\n+++ b/test/integration/targets/module_utils/library/test_no_log.py\n@@
        -0,0 +1,35 @@\n+#!/usr/bin/python\n+# (c) 2021 Ansible Project\n+# GNU General
        Public License v3.0+ (see COPYING or https://www.gnu.org/licenses/gpl-3.0.txt)\n+\n+from
        __future__ import absolute_import, division, print_function\n+__metaclass__
        = type\n+\n+\n+from ansible.module_utils.basic import AnsibleModule, env_fallback\n+\n+\n+def
        main():\n+    module = AnsibleModule(\n+        argument_spec=dict(\n+            explicit_pass=dict(type='str',
        no_log=True),\n+            fallback_pass=dict(type='str', no_log=True, fallback=(env_fallback,
        ['SECRET_ENV'])),\n+            default_pass=dict(type='str', no_log=True,
        default='zyx'),\n+            normal=dict(type='str', default='plaintext'),\n+
        \           suboption=dict(\n+                type='dict',\n+                options=dict(\n+
        \                   explicit_sub_pass=dict(type='str', no_log=True),\n+                    fallback_sub_pass=dict(type='str',
        no_log=True, fallback=(env_fallback, ['SECRET_SUB_ENV'])),\n+                    default_sub_pass=dict(type='str',
        no_log=True, default='xvu'),\n+                    normal=dict(type='str',
        default='plaintext'),\n+                ),\n+            ),\n+        ),\n+
        \   )\n+\n+    module.exit_json(changed=False)\n+\n+\n+if __name__ == '__main__':\n+
        \   main()\ndiff --git a/test/integration/targets/module_utils/module_utils_test_no_log.yml
        b/test/integration/targets/module_utils/module_utils_test_no_log.yml\nnew
        file mode 100644\nindex 0000000000000..bad2efd495db2\n--- /dev/null\n+++ b/test/integration/targets/module_utils/module_utils_test_no_log.yml\n@@
        -0,0 +1,9 @@\n+# This is called by module_utils_vvvvv.yml with a custom callback\n+-
        hosts: testhost\n+  gather_facts: no\n+  tasks:\n+    - name: Check no_log
        invocation results\n+      test_no_log:\n+        explicit_pass: abc\n+        suboption:\n+
        \         explicit_sub_pass: def\ndiff --git a/test/integration/targets/module_utils/module_utils_vvvvv.yml
        b/test/integration/targets/module_utils/module_utils_vvvvv.yml\nindex 1fe9624f7b48f..6a9f92013c50e
        100644\n--- a/test/integration/targets/module_utils/module_utils_vvvvv.yml\n+++
        b/test/integration/targets/module_utils/module_utils_vvvvv.yml\n@@ -3,3 +3,28
        @@\n   tasks:\n   - name: Use a specially crafted module to see if things
        were imported correctly\n     test:\n+\n+  # Invocation usually is output
        with 3vs or more, our callback plugin displays it anyway\n+  - name: Check
        no_log invocation results\n+    command: ansible-playbook -i {{ inventory_file
        }} module_utils_test_no_log.yml\n+    environment:\n+      ANSIBLE_CALLBACK_PLUGINS:
        callback\n+      ANSIBLE_STDOUT_CALLBACK: pure_json\n+      SECRET_ENV: ghi\n+
        \     SECRET_SUB_ENV: jkl\n+    register: no_log_invocation\n+\n+  - set_fact:\n+
        \     no_log_invocation: '{{ no_log_invocation.stdout | trim | from_json }}'\n+\n+
        \ - name: check no log values from fallback or default are masked\n+    assert:\n+
        \     that:\n+      - no_log_invocation.invocation.module_args.default_pass
        == 'VALUE_SPECIFIED_IN_NO_LOG_PARAMETER'\n+      - no_log_invocation.invocation.module_args.explicit_pass
        == 'VALUE_SPECIFIED_IN_NO_LOG_PARAMETER'\n+      - no_log_invocation.invocation.module_args.fallback_pass
        == 'VALUE_SPECIFIED_IN_NO_LOG_PARAMETER'\n+      - no_log_invocation.invocation.module_args.normal
        == 'plaintext'\n+      - no_log_invocation.invocation.module_args.suboption.default_sub_pass
        == 'VALUE_SPECIFIED_IN_NO_LOG_PARAMETER'\n+      - no_log_invocation.invocation.module_args.suboption.explicit_sub_pass
        == 'VALUE_SPECIFIED_IN_NO_LOG_PARAMETER'\n+      - no_log_invocation.invocation.module_args.suboption.fallback_sub_pass
        == 'VALUE_SPECIFIED_IN_NO_LOG_PARAMETER'\n+      - no_log_invocation.invocation.module_args.suboption.normal
        == 'plaintext'\n"
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Content-Encoding:
      - gzip
      Content-Security-Policy:
      - 'default-src ''none''; base-uri ''self''; block-all-mixed-content; connect-src
        ''self'' uploads.github.com www.githubstatus.com collector.githubapp.com api.github.com
        github-cloud.s3.amazonaws.com github-production-repository-file-5c1aeb.s3.amazonaws.com
        github-production-upload-manifest-file-7fdce7.s3.amazonaws.com github-production-user-asset-6210df.s3.amazonaws.com
        cdn.optimizely.com logx.optimizely.com/v1/events wss://alive.github.com; font-src
        github.githubassets.com; form-action ''self'' github.com gist.github.com;
        frame-ancestors ''none''; frame-src render.githubusercontent.com; img-src
        ''self'' data: github.githubassets.com identicons.github.com collector.githubapp.com
        github-cloud.s3.amazonaws.com user-images.githubusercontent.com/ *.githubusercontent.com;
        manifest-src ''self''; media-src ''none''; script-src github.githubassets.com;
        style-src ''unsafe-inline'' github.githubassets.com; worker-src github.com/socket-worker-5029ae85.js
        gist.github.com/socket-worker-5029ae85.js'
      Content-Type:
      - text/plain; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:40 GMT
      Etag:
      - W/"0687d3ebbec1ca07d0b0dd032415ee3e"
      Expect-CT:
      - max-age=2592000, report-uri="https://api.github.com/_private/browser/errors"
      Referrer-Policy:
      - origin-when-cross-origin, strict-origin-when-cross-origin
      Server:
      - GitHub.com
      Set-Cookie:
      - logged_in=no; domain=.github.com; path=/; expires=Sun, 27 Feb 2022 07:10:40
        GMT; secure; HttpOnly; SameSite=Lax
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - X-PJAX
      - Accept-Encoding, Accept, X-Requested-With
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Request-Id:
      - D35C:1A52:95E295:B7199F:6039F070
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
    url: https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73487.diff
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Cookie:
      - logged_in=no
    method: GET
    uri: https://api.github.com/repos/ansible/ansible/pulls/73067
  response:
    body:
      string: "{\"url\":\"https://api.github.com/repos/ansible/ansible/pulls/73067\",\"id\":545812921,\"node_id\":\"MDExOlB1bGxSZXF1ZXN0NTQ1ODEyOTIx\",\"html_url\":\"https://github.com/ansible/ansible/pull/73067\",\"diff_url\":\"https://github.com/ansible/ansible/pull/73067.diff\",\"patch_url\":\"https://github.com/ansible/ansible/pull/73067.patch\",\"issue_url\":\"https://api.github.com/repos/ansible/ansible/issues/73067\",\"number\":73067,\"state\":\"closed\",\"locked\":true,\"title\":\"[2.9]
        docker_image: check output of load_image and react upon\",\"user\":{\"login\":\"felixfontein\",\"id\":5781356,\"node_id\":\"MDQ6VXNlcjU3ODEzNTY=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/5781356?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/felixfontein\",\"html_url\":\"https://github.com/felixfontein\",\"followers_url\":\"https://api.github.com/users/felixfontein/followers\",\"following_url\":\"https://api.github.com/users/felixfontein/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/felixfontein/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/felixfontein/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/felixfontein/subscriptions\",\"organizations_url\":\"https://api.github.com/users/felixfontein/orgs\",\"repos_url\":\"https://api.github.com/users/felixfontein/repos\",\"events_url\":\"https://api.github.com/users/felixfontein/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/felixfontein/received_events\",\"type\":\"User\",\"site_admin\":false},\"body\":\"#####
        SUMMARY\\r\\nBackport of ansible-collections/community.docker#55 to stable-2.9.\\r\\n\\r\\n#####
        ISSUE TYPE\\r\\n- Bugfix Pull Request\\r\\n\\r\\n##### COMPONENT NAME\\r\\ndocker_image\\r\\n\",\"created_at\":\"2020-12-27T14:14:02Z\",\"updated_at\":\"2021-02-07T14:00:07Z\",\"closed_at\":\"2021-01-10T22:12:26Z\",\"merged_at\":\"2021-01-10T22:12:26Z\",\"merge_commit_sha\":\"77ae0819f969f0700b9d849ec4a9720a259cee55\",\"assignee\":null,\"assignees\":[],\"requested_reviewers\":[],\"requested_teams\":[],\"labels\":[{\"id\":1316917295,\"node_id\":\"MDU6TGFiZWwxMzE2OTE3Mjk1\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/affects_2.9\",\"name\":\"affects_2.9\",\"color\":\"5319e7\",\"default\":false,\"description\":\"This
        issue/PR affects Ansible v2.9\"},{\"id\":266246971,\"node_id\":\"MDU6TGFiZWwyNjYyNDY5NzE=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/backport\",\"name\":\"backport\",\"color\":\"00ff00\",\"default\":false,\"description\":\"This
        PR does not target the devel branch.\"},{\"id\":785271699,\"node_id\":\"MDU6TGFiZWw3ODUyNzE2OTk=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/bug\",\"name\":\"bug\",\"color\":\"fbca04\",\"default\":true,\"description\":\"This
        issue/PR relates to a bug.\"},{\"id\":61528803,\"node_id\":\"MDU6TGFiZWw2MTUyODgwMw==\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/cloud\",\"name\":\"cloud\",\"color\":\"4071a5\",\"default\":false,\"description\":\"\"},{\"id\":1285191701,\"node_id\":\"MDU6TGFiZWwxMjg1MTkxNzAx\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/collection\",\"name\":\"collection\",\"color\":\"b60205\",\"default\":false,\"description\":\"Related
        to Ansible Collections work\"},{\"id\":1932404776,\"node_id\":\"MDU6TGFiZWwxOTMyNDA0Nzc2\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/collection:community.general\",\"name\":\"collection:community.general\",\"color\":\"ededed\",\"default\":false,\"description\":null},{\"id\":513652538,\"node_id\":\"MDU6TGFiZWw1MTM2NTI1Mzg=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/core_review\",\"name\":\"core_review\",\"color\":\"ededed\",\"default\":false,\"description\":\"In
        order to be merged, this PR must follow the core review workflow.\"},{\"id\":500715204,\"node_id\":\"MDU6TGFiZWw1MDA3MTUyMDQ=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/docker\",\"name\":\"docker\",\"color\":\"c5def5\",\"default\":false,\"description\":null},{\"id\":496359346,\"node_id\":\"MDU6TGFiZWw0OTYzNTkzNDY=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/module\",\"name\":\"module\",\"color\":\"1d76db\",\"default\":false,\"description\":\"This
        issue/PR relates to a module.\"},{\"id\":581543918,\"node_id\":\"MDU6TGFiZWw1ODE1NDM5MTg=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/stale_ci\",\"name\":\"stale_ci\",\"color\":\"fef2c0\",\"default\":false,\"description\":\"This
        PR has been tested by CI more than one week ago. Close and re-open this PR
        to get it retested.\"},{\"id\":636327968,\"node_id\":\"MDU6TGFiZWw2MzYzMjc5Njg=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/support:community\",\"name\":\"support:community\",\"color\":\"ededed\",\"default\":false,\"description\":\"This
        issue/PR relates to code supported by the Ansible community.\"},{\"id\":636352796,\"node_id\":\"MDU6TGFiZWw2MzYzNTI3OTY=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/support:core\",\"name\":\"support:core\",\"color\":\"ededed\",\"default\":false,\"description\":\"This
        issue/PR relates to code supported by the Ansible Engineering Team.\"},{\"id\":468273802,\"node_id\":\"MDU6TGFiZWw0NjgyNzM4MDI=\",\"url\":\"https://api.github.com/repos/ansible/ansible/labels/test\",\"name\":\"test\",\"color\":\"0e8a16\",\"default\":false,\"description\":\"This
        PR relates to tests.\"}],\"milestone\":null,\"draft\":false,\"commits_url\":\"https://api.github.com/repos/ansible/ansible/pulls/73067/commits\",\"review_comments_url\":\"https://api.github.com/repos/ansible/ansible/pulls/73067/comments\",\"review_comment_url\":\"https://api.github.com/repos/ansible/ansible/pulls/comments{/number}\",\"comments_url\":\"https://api.github.com/repos/ansible/ansible/issues/73067/comments\",\"statuses_url\":\"https://api.github.com/repos/ansible/ansible/statuses/f6d7ff5715b25b0c434b55ee0d3b194f255e1e5a\",\"head\":{\"label\":\"felixfontein:backport/2.9/community.docker-55\",\"ref\":\"backport/2.9/community.docker-55\",\"sha\":\"f6d7ff5715b25b0c434b55ee0d3b194f255e1e5a\",\"user\":{\"login\":\"felixfontein\",\"id\":5781356,\"node_id\":\"MDQ6VXNlcjU3ODEzNTY=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/5781356?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/felixfontein\",\"html_url\":\"https://github.com/felixfontein\",\"followers_url\":\"https://api.github.com/users/felixfontein/followers\",\"following_url\":\"https://api.github.com/users/felixfontein/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/felixfontein/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/felixfontein/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/felixfontein/subscriptions\",\"organizations_url\":\"https://api.github.com/users/felixfontein/orgs\",\"repos_url\":\"https://api.github.com/users/felixfontein/repos\",\"events_url\":\"https://api.github.com/users/felixfontein/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/felixfontein/received_events\",\"type\":\"User\",\"site_admin\":false},\"repo\":{\"id\":51219776,\"node_id\":\"MDEwOlJlcG9zaXRvcnk1MTIxOTc3Ng==\",\"name\":\"ansible\",\"full_name\":\"felixfontein/ansible\",\"private\":false,\"owner\":{\"login\":\"felixfontein\",\"id\":5781356,\"node_id\":\"MDQ6VXNlcjU3ODEzNTY=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/5781356?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/felixfontein\",\"html_url\":\"https://github.com/felixfontein\",\"followers_url\":\"https://api.github.com/users/felixfontein/followers\",\"following_url\":\"https://api.github.com/users/felixfontein/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/felixfontein/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/felixfontein/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/felixfontein/subscriptions\",\"organizations_url\":\"https://api.github.com/users/felixfontein/orgs\",\"repos_url\":\"https://api.github.com/users/felixfontein/repos\",\"events_url\":\"https://api.github.com/users/felixfontein/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/felixfontein/received_events\",\"type\":\"User\",\"site_admin\":false},\"html_url\":\"https://github.com/felixfontein/ansible\",\"description\":\"Ansible
        is a radically simple IT automation platform that makes your applications
        and systems easier to deploy. Avoid writing scripts or custom code to deploy
        and update your applications\u2014 automate in a language that approaches
        plain English, using SSH, with no agents to install on remote systems.\",\"fork\":true,\"url\":\"https://api.github.com/repos/felixfontein/ansible\",\"forks_url\":\"https://api.github.com/repos/felixfontein/ansible/forks\",\"keys_url\":\"https://api.github.com/repos/felixfontein/ansible/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/felixfontein/ansible/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/felixfontein/ansible/teams\",\"hooks_url\":\"https://api.github.com/repos/felixfontein/ansible/hooks\",\"issue_events_url\":\"https://api.github.com/repos/felixfontein/ansible/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/felixfontein/ansible/events\",\"assignees_url\":\"https://api.github.com/repos/felixfontein/ansible/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/felixfontein/ansible/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/felixfontein/ansible/tags\",\"blobs_url\":\"https://api.github.com/repos/felixfontein/ansible/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/felixfontein/ansible/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/felixfontein/ansible/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/felixfontein/ansible/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/felixfontein/ansible/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/felixfontein/ansible/languages\",\"stargazers_url\":\"https://api.github.com/repos/felixfontein/ansible/stargazers\",\"contributors_url\":\"https://api.github.com/repos/felixfontein/ansible/contributors\",\"subscribers_url\":\"https://api.github.com/repos/felixfontein/ansible/subscribers\",\"subscription_url\":\"https://api.github.com/repos/felixfontein/ansible/subscription\",\"commits_url\":\"https://api.github.com/repos/felixfontein/ansible/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/felixfontein/ansible/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/felixfontein/ansible/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/felixfontein/ansible/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/felixfontein/ansible/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/felixfontein/ansible/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/felixfontein/ansible/merges\",\"archive_url\":\"https://api.github.com/repos/felixfontein/ansible/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/felixfontein/ansible/downloads\",\"issues_url\":\"https://api.github.com/repos/felixfontein/ansible/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/felixfontein/ansible/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/felixfontein/ansible/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/felixfontein/ansible/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/felixfontein/ansible/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/felixfontein/ansible/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/felixfontein/ansible/deployments\",\"created_at\":\"2016-02-06T20:16:02Z\",\"updated_at\":\"2021-02-26T13:20:29Z\",\"pushed_at\":\"2021-02-26T13:26:12Z\",\"git_url\":\"git://github.com/felixfontein/ansible.git\",\"ssh_url\":\"git@github.com:felixfontein/ansible.git\",\"clone_url\":\"https://github.com/felixfontein/ansible.git\",\"svn_url\":\"https://github.com/felixfontein/ansible\",\"homepage\":\"http://ansible.com/\",\"size\":168979,\"stargazers_count\":1,\"watchers_count\":1,\"language\":\"Python\",\"has_issues\":false,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":false,\"has_pages\":false,\"forks_count\":0,\"mirror_url\":null,\"archived\":false,\"disabled\":false,\"open_issues_count\":0,\"license\":{\"key\":\"gpl-3.0\",\"name\":\"GNU
        General Public License v3.0\",\"spdx_id\":\"GPL-3.0\",\"url\":\"https://api.github.com/licenses/gpl-3.0\",\"node_id\":\"MDc6TGljZW5zZTk=\"},\"forks\":0,\"open_issues\":0,\"watchers\":1,\"default_branch\":\"devel\"}},\"base\":{\"label\":\"ansible:stable-2.9\",\"ref\":\"stable-2.9\",\"sha\":\"17effffad639c6edb99b5893b23483c52edb35ae\",\"user\":{\"login\":\"ansible\",\"id\":1507452,\"node_id\":\"MDEyOk9yZ2FuaXphdGlvbjE1MDc0NTI=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/1507452?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/ansible\",\"html_url\":\"https://github.com/ansible\",\"followers_url\":\"https://api.github.com/users/ansible/followers\",\"following_url\":\"https://api.github.com/users/ansible/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/ansible/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/ansible/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/ansible/subscriptions\",\"organizations_url\":\"https://api.github.com/users/ansible/orgs\",\"repos_url\":\"https://api.github.com/users/ansible/repos\",\"events_url\":\"https://api.github.com/users/ansible/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/ansible/received_events\",\"type\":\"Organization\",\"site_admin\":false},\"repo\":{\"id\":3638964,\"node_id\":\"MDEwOlJlcG9zaXRvcnkzNjM4OTY0\",\"name\":\"ansible\",\"full_name\":\"ansible/ansible\",\"private\":false,\"owner\":{\"login\":\"ansible\",\"id\":1507452,\"node_id\":\"MDEyOk9yZ2FuaXphdGlvbjE1MDc0NTI=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/1507452?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/ansible\",\"html_url\":\"https://github.com/ansible\",\"followers_url\":\"https://api.github.com/users/ansible/followers\",\"following_url\":\"https://api.github.com/users/ansible/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/ansible/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/ansible/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/ansible/subscriptions\",\"organizations_url\":\"https://api.github.com/users/ansible/orgs\",\"repos_url\":\"https://api.github.com/users/ansible/repos\",\"events_url\":\"https://api.github.com/users/ansible/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/ansible/received_events\",\"type\":\"Organization\",\"site_admin\":false},\"html_url\":\"https://github.com/ansible/ansible\",\"description\":\"Ansible
        is a radically simple IT automation platform that makes your applications
        and systems easier to deploy and maintain. Automate everything from code deployment
        to network configuration to cloud management, in a language that approaches
        plain English, using SSH, with no agents to install on remote systems. https://docs.ansible.com.\",\"fork\":false,\"url\":\"https://api.github.com/repos/ansible/ansible\",\"forks_url\":\"https://api.github.com/repos/ansible/ansible/forks\",\"keys_url\":\"https://api.github.com/repos/ansible/ansible/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/ansible/ansible/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/ansible/ansible/teams\",\"hooks_url\":\"https://api.github.com/repos/ansible/ansible/hooks\",\"issue_events_url\":\"https://api.github.com/repos/ansible/ansible/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/ansible/ansible/events\",\"assignees_url\":\"https://api.github.com/repos/ansible/ansible/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/ansible/ansible/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/ansible/ansible/tags\",\"blobs_url\":\"https://api.github.com/repos/ansible/ansible/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/ansible/ansible/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/ansible/ansible/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/ansible/ansible/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/ansible/ansible/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/ansible/ansible/languages\",\"stargazers_url\":\"https://api.github.com/repos/ansible/ansible/stargazers\",\"contributors_url\":\"https://api.github.com/repos/ansible/ansible/contributors\",\"subscribers_url\":\"https://api.github.com/repos/ansible/ansible/subscribers\",\"subscription_url\":\"https://api.github.com/repos/ansible/ansible/subscription\",\"commits_url\":\"https://api.github.com/repos/ansible/ansible/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/ansible/ansible/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/ansible/ansible/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/ansible/ansible/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/ansible/ansible/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/ansible/ansible/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/ansible/ansible/merges\",\"archive_url\":\"https://api.github.com/repos/ansible/ansible/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/ansible/ansible/downloads\",\"issues_url\":\"https://api.github.com/repos/ansible/ansible/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/ansible/ansible/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/ansible/ansible/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/ansible/ansible/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/ansible/ansible/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/ansible/ansible/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/ansible/ansible/deployments\",\"created_at\":\"2012-03-06T14:58:02Z\",\"updated_at\":\"2021-02-27T02:40:42Z\",\"pushed_at\":\"2021-02-27T06:00:14Z\",\"git_url\":\"git://github.com/ansible/ansible.git\",\"ssh_url\":\"org-1507452@github.com:ansible/ansible.git\",\"clone_url\":\"https://github.com/ansible/ansible.git\",\"svn_url\":\"https://github.com/ansible/ansible\",\"homepage\":\"https://www.ansible.com/\",\"size\":194931,\"stargazers_count\":47033,\"watchers_count\":47033,\"language\":\"Python\",\"has_issues\":true,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":false,\"has_pages\":false,\"forks_count\":20311,\"mirror_url\":null,\"archived\":false,\"disabled\":false,\"open_issues_count\":1892,\"license\":{\"key\":\"gpl-3.0\",\"name\":\"GNU
        General Public License v3.0\",\"spdx_id\":\"GPL-3.0\",\"url\":\"https://api.github.com/licenses/gpl-3.0\",\"node_id\":\"MDc6TGljZW5zZTk=\"},\"forks\":20311,\"open_issues\":1892,\"watchers\":47033,\"default_branch\":\"devel\"}},\"_links\":{\"self\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/73067\"},\"html\":{\"href\":\"https://github.com/ansible/ansible/pull/73067\"},\"issue\":{\"href\":\"https://api.github.com/repos/ansible/ansible/issues/73067\"},\"comments\":{\"href\":\"https://api.github.com/repos/ansible/ansible/issues/73067/comments\"},\"review_comments\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/73067/comments\"},\"review_comment\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/comments{/number}\"},\"commits\":{\"href\":\"https://api.github.com/repos/ansible/ansible/pulls/73067/commits\"},\"statuses\":{\"href\":\"https://api.github.com/repos/ansible/ansible/statuses/f6d7ff5715b25b0c434b55ee0d3b194f255e1e5a\"}},\"author_association\":\"MEMBER\",\"auto_merge\":null,\"active_lock_reason\":null,\"merged\":true,\"mergeable\":null,\"rebaseable\":null,\"mergeable_state\":\"unknown\",\"merged_by\":{\"login\":\"relrod\",\"id\":43930,\"node_id\":\"MDQ6VXNlcjQzOTMw\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/43930?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/relrod\",\"html_url\":\"https://github.com/relrod\",\"followers_url\":\"https://api.github.com/users/relrod/followers\",\"following_url\":\"https://api.github.com/users/relrod/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/relrod/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/relrod/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/relrod/subscriptions\",\"organizations_url\":\"https://api.github.com/users/relrod/orgs\",\"repos_url\":\"https://api.github.com/users/relrod/repos\",\"events_url\":\"https://api.github.com/users/relrod/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/relrod/received_events\",\"type\":\"User\",\"site_admin\":false},\"comments\":1,\"review_comments\":0,\"maintainer_can_modify\":false,\"commits\":1,\"additions\":62,\"deletions\":5,\"changed_files\":3}"
    headers:
      Access-Control-Allow-Origin:
      - '*'
      Access-Control-Expose-Headers:
      - ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining,
        X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes,
        X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset
      Cache-Control:
      - private, max-age=60, s-maxage=60
      Content-Encoding:
      - gzip
      Content-Security-Policy:
      - default-src 'none'
      Content-Type:
      - application/json; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:41 GMT
      Etag:
      - W/"2408c51e493ee0e6aa796904a24514db1d1239cf435fc57423a5a7a51311ee0a"
      Last-Modified:
      - Wed, 10 Feb 2021 19:50:21 GMT
      Referrer-Policy:
      - origin-when-cross-origin, strict-origin-when-cross-origin
      Server:
      - GitHub.com
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - Accept, Authorization, Cookie, X-GitHub-OTP
      - Accept-Encoding, Accept, X-Requested-With
      X-Accepted-OAuth-Scopes:
      - ''
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Media-Type:
      - github.cloak-preview, github.groot-preview; format=json
      X-GitHub-Request-Id:
      - AAC0:74C8:29538:1A8593:6039F071
      X-OAuth-Scopes:
      - repo, workflow
      X-RateLimit-Limit:
      - '5000'
      X-RateLimit-Remaining:
      - '4941'
      X-RateLimit-Reset:
      - '1614412319'
      X-XSS-Protection:
      - 1; mode=block
      x-ratelimit-used:
      - '59'
    status:
      code: 200
      message: OK
    url: https://api.github.com/repos/ansible/ansible/pulls/73067
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Accept-Encoding:
      - gzip, deflate
      Cookie:
      - logged_in=no
      Host:
      - github.com
      User-Agent:
      - Python/3.8 aiohttp/3.7.3
    method: GET
    uri: https://github.com/ansible/ansible/pull/73067.diff
  response:
    body: {}
    headers:
      Cache-Control:
      - no-cache
      Content-Security-Policy:
      - 'default-src ''none''; base-uri ''self''; block-all-mixed-content; connect-src
        ''self'' uploads.github.com www.githubstatus.com collector.githubapp.com api.github.com
        github-cloud.s3.amazonaws.com github-production-repository-file-5c1aeb.s3.amazonaws.com
        github-production-upload-manifest-file-7fdce7.s3.amazonaws.com github-production-user-asset-6210df.s3.amazonaws.com
        cdn.optimizely.com logx.optimizely.com/v1/events wss://alive.github.com online.visualstudio.com/api/v1/locations;
        font-src github.githubassets.com; form-action ''self'' github.com gist.github.com;
        frame-ancestors ''none''; frame-src render.githubusercontent.com; img-src
        ''self'' data: github.githubassets.com identicons.github.com collector.githubapp.com
        github-cloud.s3.amazonaws.com user-images.githubusercontent.com/ *.githubusercontent.com;
        manifest-src ''self''; media-src ''none''; script-src github.githubassets.com;
        style-src ''unsafe-inline'' github.githubassets.com; worker-src github.com/socket-worker-5029ae85.js
        gist.github.com/socket-worker-5029ae85.js'
      Content-Type:
      - text/html; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:41 GMT
      Expect-CT:
      - max-age=2592000, report-uri="https://api.github.com/_private/browser/errors"
      Location:
      - https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73067.diff
      Referrer-Policy:
      - no-referrer-when-downgrade
      Server:
      - GitHub.com
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - X-PJAX
      - Accept-Encoding, Accept, X-Requested-With
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Request-Id:
      - D35A:3DBA:657B57:854138:6039F071
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 302
      message: Found
    url: https://github.com/ansible/ansible/pull/73067.diff
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Accept-Encoding:
      - gzip, deflate
      Host:
      - patch-diff.githubusercontent.com
      User-Agent:
      - Python/3.8 aiohttp/3.7.3
    method: GET
    uri: https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73067.diff
  response:
    body:
      string: "diff --git a/changelogs/fragments/community.docker-55-docker_image-loading.yml
        b/changelogs/fragments/community.docker-55-docker_image-loading.yml\nnew file
        mode 100644\nindex 0000000000000..c7694f0594b3c\n--- /dev/null\n+++ b/changelogs/fragments/community.docker-55-docker_image-loading.yml\n@@
        -0,0 +1,3 @@\n+bugfixes:\n+- \"docker_image - report error when loading a
        broken archive that contains no image (https://github.com/ansible-collections/community.docker/issues/46,
        https://github.com/ansible-collections/community.docker/pull/55).\"\n+- \"docker_image
        - report error when the loaded archive does not contain the specified image
        (https://github.com/ansible-collections/community.docker/issues/41, https://github.com/ansible-collections/community.docker/pull/55).\"\ndiff
        --git a/lib/ansible/modules/cloud/docker/docker_image.py b/lib/ansible/modules/cloud/docker/docker_image.py\nindex
        363a66505fd65..f3323d3fd6342 100644\n--- a/lib/ansible/modules/cloud/docker/docker_image.py\n+++
        b/lib/ansible/modules/cloud/docker/docker_image.py\n@@ -786,17 +786,45 @@
        def load_image(self):\n \n         :return: image dict\n         '''\n+        #
        Load image(s) from file\n+        load_output = []\n         try:\n             self.log(\"Opening
        image %s\" % self.load_path)\n             with open(self.load_path, 'rb')
        as image_tar:\n                 self.log(\"Loading image from %s\" % self.load_path)\n-
        \               self.client.load_image(image_tar)\n+                for line
        in self.client.load_image(image_tar):\n+                    self.log(line,
        pretty_print=True)\n+                    if \"stream\" in line or \"status\"
        in line:\n+                        load_line = line.get(\"stream\") or line.get(\"status\")
        or ''\n+                        load_output.append(load_line)\n         except
        EnvironmentError as exc:\n             if exc.errno == errno.ENOENT:\n-                self.fail(\"Error
        opening image %s - %s\" % (self.load_path, str(exc)))\n-            self.fail(\"Error
        loading image %s - %s\" % (self.name, str(exc)))\n+                self.client.fail(\"Error
        opening image %s - %s\" % (self.load_path, str(exc)))\n+            self.client.fail(\"Error
        loading image %s - %s\" % (self.name, str(exc)), stdout='\\n'.join(load_output))\n
        \        except Exception as exc:\n-            self.fail(\"Error loading
        image %s - %s\" % (self.name, str(exc)))\n+            self.client.fail(\"Error
        loading image %s - %s\" % (self.name, str(exc)), stdout='\\n'.join(load_output))\n+\n+
        \       # Collect loaded images\n+        loaded_images = set()\n+        for
        line in load_output:\n+            if line.startswith('Loaded image:'):\n+
        \               loaded_images.add(line[len('Loaded image:'):].strip())\n+\n+
        \       if not loaded_images:\n+            self.client.fail(\"Detected no
        loaded images. Archive potentially corrupt?\", stdout='\\n'.join(load_output))\n+\n+
        \       expected_image = '%s:%s' % (self.name, self.tag)\n+        if expected_image
        not in loaded_images:\n+            self.client.fail(\n+                \"The
        archive did not contain image '%s'. Instead, found %s.\" % (\n+                    expected_image,
        ', '.join([\"'%s'\" % image for image in sorted(loaded_images)])),\n+                stdout='\\n'.join(load_output))\n+
        \       loaded_images.remove(expected_image)\n+\n+        if loaded_images:\n+
        \           self.client.module.warn(\n+                \"The archive contained
        more images than specified: %s\" % (\n+                    ', '.join([\"'%s'\"
        % image for image in sorted(loaded_images)]), ))\n \n         return self.client.find_image(self.name,
        self.tag)\n \ndiff --git a/test/integration/targets/docker_image/tasks/tests/options.yml
        b/test/integration/targets/docker_image/tasks/tests/options.yml\nindex 5564a38c9387a..1c045b9a282c4
        100644\n--- a/test/integration/targets/docker_image/tasks/tests/options.yml\n+++
        b/test/integration/targets/docker_image/tasks/tests/options.yml\n@@ -182,6
        +182,11 @@\n     source: pull\n   register: archive_image\n \n+- name: Create
        invalid archive\n+  copy:\n+    dest: \"{{ output_dir }}/image-invalid.tar\"\n+
        \   content: \"this is not a valid image\"\n+\n - name: remove image\n   docker_image:\n
        \    name: \"quay.io/ansible/docker-test-containers:hello-world\"\n@@ -202,11
        +207,32 @@\n     source: load\n   register: load_image_1\n \n+- name: load
        image (wrong name)\n+  docker_image:\n+    name: foo:bar\n+    load_path:
        \"{{ output_dir }}/image.tar\"\n+    source: load\n+  register: load_image_2\n+
        \ ignore_errors: true\n+\n+- name: load image (invalid image)\n+  docker_image:\n+
        \   name: foo:bar\n+    load_path: \"{{ output_dir }}/image-invalid.tar\"\n+
        \   source: load\n+  register: load_image_3\n+  ignore_errors: true\n+\n -
        assert:\n     that:\n     - load_image is changed\n-    - load_image_1 is
        not changed\n     - archive_image['image']['Id'] == load_image['image']['Id']\n+
        \   - load_image_1 is not changed\n+    - load_image_2 is failed\n+    - >-\n+
        \     \"The archive did not contain image 'foo:bar'. Instead, found 'quay.io/ansible/docker-test-containers:hello-world'.\"
        == load_image_2.msg\n+    - load_image_3 is failed\n+    - '\"Detected no
        loaded images. Archive potentially corrupt?\" == load_image_3.msg'\n \n ####################################################################\n
        ## path ############################################################\n"
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Content-Encoding:
      - gzip
      Content-Security-Policy:
      - 'default-src ''none''; base-uri ''self''; block-all-mixed-content; connect-src
        ''self'' uploads.github.com www.githubstatus.com collector.githubapp.com api.github.com
        github-cloud.s3.amazonaws.com github-production-repository-file-5c1aeb.s3.amazonaws.com
        github-production-upload-manifest-file-7fdce7.s3.amazonaws.com github-production-user-asset-6210df.s3.amazonaws.com
        cdn.optimizely.com logx.optimizely.com/v1/events wss://alive.github.com; font-src
        github.githubassets.com; form-action ''self'' github.com gist.github.com;
        frame-ancestors ''none''; frame-src render.githubusercontent.com; img-src
        ''self'' data: github.githubassets.com identicons.github.com collector.githubapp.com
        github-cloud.s3.amazonaws.com user-images.githubusercontent.com/ *.githubusercontent.com;
        manifest-src ''self''; media-src ''none''; script-src github.githubassets.com;
        style-src ''unsafe-inline'' github.githubassets.com; worker-src github.com/socket-worker-5029ae85.js
        gist.github.com/socket-worker-5029ae85.js'
      Content-Type:
      - text/plain; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:41 GMT
      Etag:
      - W/"5bb8fe511b6bc742abb231f0bc1af073"
      Expect-CT:
      - max-age=2592000, report-uri="https://api.github.com/_private/browser/errors"
      Referrer-Policy:
      - origin-when-cross-origin, strict-origin-when-cross-origin
      Server:
      - GitHub.com
      Set-Cookie:
      - logged_in=no; domain=.github.com; path=/; expires=Sun, 27 Feb 2022 07:10:41
        GMT; secure; HttpOnly; SameSite=Lax
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - X-PJAX
      - Accept-Encoding, Accept, X-Requested-With
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Request-Id:
      - D35C:1A52:95E2E9:B719FF:6039F071
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
    url: https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73067.diff
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Cookie:
      - logged_in=no
    method: GET
    uri: https://api.github.com/repos/ansible-collections/community.docker/pulls/55
  response:
    body:
      string: '{"url":"https://api.github.com/repos/ansible-collections/community.docker/pulls/55","id":544676269,"node_id":"MDExOlB1bGxSZXF1ZXN0NTQ0Njc2MjY5","html_url":"https://github.com/ansible-collections/community.docker/pull/55","diff_url":"https://github.com/ansible-collections/community.docker/pull/55.diff","patch_url":"https://github.com/ansible-collections/community.docker/pull/55.patch","issue_url":"https://api.github.com/repos/ansible-collections/community.docker/issues/55","number":55,"state":"closed","locked":false,"title":"docker_image:
        check output of load_image and react upon","user":{"login":"felixfontein","id":5781356,"node_id":"MDQ6VXNlcjU3ODEzNTY=","avatar_url":"https://avatars.githubusercontent.com/u/5781356?v=4","gravatar_id":"","url":"https://api.github.com/users/felixfontein","html_url":"https://github.com/felixfontein","followers_url":"https://api.github.com/users/felixfontein/followers","following_url":"https://api.github.com/users/felixfontein/following{/other_user}","gists_url":"https://api.github.com/users/felixfontein/gists{/gist_id}","starred_url":"https://api.github.com/users/felixfontein/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixfontein/subscriptions","organizations_url":"https://api.github.com/users/felixfontein/orgs","repos_url":"https://api.github.com/users/felixfontein/repos","events_url":"https://api.github.com/users/felixfontein/events{/privacy}","received_events_url":"https://api.github.com/users/felixfontein/received_events","type":"User","site_admin":false},"body":"#####
        SUMMARY\r\nFixes #41, fixes #46.\r\n\r\n##### ISSUE TYPE\r\n- Bugfix Pull
        Request\r\n\r\n##### COMPONENT NAME\r\ndocker_image\r\n","created_at":"2020-12-23T09:37:55Z","updated_at":"2021-02-17T15:08:36Z","closed_at":"2020-12-27T14:04:39Z","merged_at":"2020-12-27T14:04:38Z","merge_commit_sha":"5eef093e994ce4bb10529b1c5da38c4992f5b3c4","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/ansible-collections/community.docker/pulls/55/commits","review_comments_url":"https://api.github.com/repos/ansible-collections/community.docker/pulls/55/comments","review_comment_url":"https://api.github.com/repos/ansible-collections/community.docker/pulls/comments{/number}","comments_url":"https://api.github.com/repos/ansible-collections/community.docker/issues/55/comments","statuses_url":"https://api.github.com/repos/ansible-collections/community.docker/statuses/9765947ac0af25ab95771b9745efb1a55cf6b14d","head":{"label":"felixfontein:docker_image-loading","ref":"docker_image-loading","sha":"9765947ac0af25ab95771b9745efb1a55cf6b14d","user":{"login":"felixfontein","id":5781356,"node_id":"MDQ6VXNlcjU3ODEzNTY=","avatar_url":"https://avatars.githubusercontent.com/u/5781356?v=4","gravatar_id":"","url":"https://api.github.com/users/felixfontein","html_url":"https://github.com/felixfontein","followers_url":"https://api.github.com/users/felixfontein/followers","following_url":"https://api.github.com/users/felixfontein/following{/other_user}","gists_url":"https://api.github.com/users/felixfontein/gists{/gist_id}","starred_url":"https://api.github.com/users/felixfontein/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixfontein/subscriptions","organizations_url":"https://api.github.com/users/felixfontein/orgs","repos_url":"https://api.github.com/users/felixfontein/repos","events_url":"https://api.github.com/users/felixfontein/events{/privacy}","received_events_url":"https://api.github.com/users/felixfontein/received_events","type":"User","site_admin":false},"repo":{"id":307958254,"node_id":"MDEwOlJlcG9zaXRvcnkzMDc5NTgyNTQ=","name":"community.docker","full_name":"felixfontein/community.docker","private":false,"owner":{"login":"felixfontein","id":5781356,"node_id":"MDQ6VXNlcjU3ODEzNTY=","avatar_url":"https://avatars.githubusercontent.com/u/5781356?v=4","gravatar_id":"","url":"https://api.github.com/users/felixfontein","html_url":"https://github.com/felixfontein","followers_url":"https://api.github.com/users/felixfontein/followers","following_url":"https://api.github.com/users/felixfontein/following{/other_user}","gists_url":"https://api.github.com/users/felixfontein/gists{/gist_id}","starred_url":"https://api.github.com/users/felixfontein/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixfontein/subscriptions","organizations_url":"https://api.github.com/users/felixfontein/orgs","repos_url":"https://api.github.com/users/felixfontein/repos","events_url":"https://api.github.com/users/felixfontein/events{/privacy}","received_events_url":"https://api.github.com/users/felixfontein/received_events","type":"User","site_admin":false},"html_url":"https://github.com/felixfontein/community.docker","description":null,"fork":true,"url":"https://api.github.com/repos/felixfontein/community.docker","forks_url":"https://api.github.com/repos/felixfontein/community.docker/forks","keys_url":"https://api.github.com/repos/felixfontein/community.docker/keys{/key_id}","collaborators_url":"https://api.github.com/repos/felixfontein/community.docker/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/felixfontein/community.docker/teams","hooks_url":"https://api.github.com/repos/felixfontein/community.docker/hooks","issue_events_url":"https://api.github.com/repos/felixfontein/community.docker/issues/events{/number}","events_url":"https://api.github.com/repos/felixfontein/community.docker/events","assignees_url":"https://api.github.com/repos/felixfontein/community.docker/assignees{/user}","branches_url":"https://api.github.com/repos/felixfontein/community.docker/branches{/branch}","tags_url":"https://api.github.com/repos/felixfontein/community.docker/tags","blobs_url":"https://api.github.com/repos/felixfontein/community.docker/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/felixfontein/community.docker/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/felixfontein/community.docker/git/refs{/sha}","trees_url":"https://api.github.com/repos/felixfontein/community.docker/git/trees{/sha}","statuses_url":"https://api.github.com/repos/felixfontein/community.docker/statuses/{sha}","languages_url":"https://api.github.com/repos/felixfontein/community.docker/languages","stargazers_url":"https://api.github.com/repos/felixfontein/community.docker/stargazers","contributors_url":"https://api.github.com/repos/felixfontein/community.docker/contributors","subscribers_url":"https://api.github.com/repos/felixfontein/community.docker/subscribers","subscription_url":"https://api.github.com/repos/felixfontein/community.docker/subscription","commits_url":"https://api.github.com/repos/felixfontein/community.docker/commits{/sha}","git_commits_url":"https://api.github.com/repos/felixfontein/community.docker/git/commits{/sha}","comments_url":"https://api.github.com/repos/felixfontein/community.docker/comments{/number}","issue_comment_url":"https://api.github.com/repos/felixfontein/community.docker/issues/comments{/number}","contents_url":"https://api.github.com/repos/felixfontein/community.docker/contents/{+path}","compare_url":"https://api.github.com/repos/felixfontein/community.docker/compare/{base}...{head}","merges_url":"https://api.github.com/repos/felixfontein/community.docker/merges","archive_url":"https://api.github.com/repos/felixfontein/community.docker/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/felixfontein/community.docker/downloads","issues_url":"https://api.github.com/repos/felixfontein/community.docker/issues{/number}","pulls_url":"https://api.github.com/repos/felixfontein/community.docker/pulls{/number}","milestones_url":"https://api.github.com/repos/felixfontein/community.docker/milestones{/number}","notifications_url":"https://api.github.com/repos/felixfontein/community.docker/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/felixfontein/community.docker/labels{/name}","releases_url":"https://api.github.com/repos/felixfontein/community.docker/releases{/id}","deployments_url":"https://api.github.com/repos/felixfontein/community.docker/deployments","created_at":"2020-10-28T08:55:31Z","updated_at":"2021-02-24T22:46:18Z","pushed_at":"2021-02-24T22:46:15Z","git_url":"git://github.com/felixfontein/community.docker.git","ssh_url":"git@github.com:felixfontein/community.docker.git","clone_url":"https://github.com/felixfontein/community.docker.git","svn_url":"https://github.com/felixfontein/community.docker","homepage":null,"size":575,"stargazers_count":1,"watchers_count":1,"language":"Python","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"gpl-3.0","name":"GNU
        General Public License v3.0","spdx_id":"GPL-3.0","url":"https://api.github.com/licenses/gpl-3.0","node_id":"MDc6TGljZW5zZTk="},"forks":0,"open_issues":0,"watchers":1,"default_branch":"main"}},"base":{"label":"ansible-collections:main","ref":"main","sha":"a1a7692e747bc08aeeb3130c705d1fe1e689b7ed","user":{"login":"ansible-collections","id":44586252,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ0NTg2MjUy","avatar_url":"https://avatars.githubusercontent.com/u/44586252?v=4","gravatar_id":"","url":"https://api.github.com/users/ansible-collections","html_url":"https://github.com/ansible-collections","followers_url":"https://api.github.com/users/ansible-collections/followers","following_url":"https://api.github.com/users/ansible-collections/following{/other_user}","gists_url":"https://api.github.com/users/ansible-collections/gists{/gist_id}","starred_url":"https://api.github.com/users/ansible-collections/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ansible-collections/subscriptions","organizations_url":"https://api.github.com/users/ansible-collections/orgs","repos_url":"https://api.github.com/users/ansible-collections/repos","events_url":"https://api.github.com/users/ansible-collections/events{/privacy}","received_events_url":"https://api.github.com/users/ansible-collections/received_events","type":"Organization","site_admin":false},"repo":{"id":307940262,"node_id":"MDEwOlJlcG9zaXRvcnkzMDc5NDAyNjI=","name":"community.docker","full_name":"ansible-collections/community.docker","private":false,"owner":{"login":"ansible-collections","id":44586252,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ0NTg2MjUy","avatar_url":"https://avatars.githubusercontent.com/u/44586252?v=4","gravatar_id":"","url":"https://api.github.com/users/ansible-collections","html_url":"https://github.com/ansible-collections","followers_url":"https://api.github.com/users/ansible-collections/followers","following_url":"https://api.github.com/users/ansible-collections/following{/other_user}","gists_url":"https://api.github.com/users/ansible-collections/gists{/gist_id}","starred_url":"https://api.github.com/users/ansible-collections/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ansible-collections/subscriptions","organizations_url":"https://api.github.com/users/ansible-collections/orgs","repos_url":"https://api.github.com/users/ansible-collections/repos","events_url":"https://api.github.com/users/ansible-collections/events{/privacy}","received_events_url":"https://api.github.com/users/ansible-collections/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/ansible-collections/community.docker","description":"Community
        Docker Collection for Ansible: modules and plugins for working with Docker","fork":false,"url":"https://api.github.com/repos/ansible-collections/community.docker","forks_url":"https://api.github.com/repos/ansible-collections/community.docker/forks","keys_url":"https://api.github.com/repos/ansible-collections/community.docker/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ansible-collections/community.docker/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ansible-collections/community.docker/teams","hooks_url":"https://api.github.com/repos/ansible-collections/community.docker/hooks","issue_events_url":"https://api.github.com/repos/ansible-collections/community.docker/issues/events{/number}","events_url":"https://api.github.com/repos/ansible-collections/community.docker/events","assignees_url":"https://api.github.com/repos/ansible-collections/community.docker/assignees{/user}","branches_url":"https://api.github.com/repos/ansible-collections/community.docker/branches{/branch}","tags_url":"https://api.github.com/repos/ansible-collections/community.docker/tags","blobs_url":"https://api.github.com/repos/ansible-collections/community.docker/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ansible-collections/community.docker/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ansible-collections/community.docker/git/refs{/sha}","trees_url":"https://api.github.com/repos/ansible-collections/community.docker/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ansible-collections/community.docker/statuses/{sha}","languages_url":"https://api.github.com/repos/ansible-collections/community.docker/languages","stargazers_url":"https://api.github.com/repos/ansible-collections/community.docker/stargazers","contributors_url":"https://api.github.com/repos/ansible-collections/community.docker/contributors","subscribers_url":"https://api.github.com/repos/ansible-collections/community.docker/subscribers","subscription_url":"https://api.github.com/repos/ansible-collections/community.docker/subscription","commits_url":"https://api.github.com/repos/ansible-collections/community.docker/commits{/sha}","git_commits_url":"https://api.github.com/repos/ansible-collections/community.docker/git/commits{/sha}","comments_url":"https://api.github.com/repos/ansible-collections/community.docker/comments{/number}","issue_comment_url":"https://api.github.com/repos/ansible-collections/community.docker/issues/comments{/number}","contents_url":"https://api.github.com/repos/ansible-collections/community.docker/contents/{+path}","compare_url":"https://api.github.com/repos/ansible-collections/community.docker/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ansible-collections/community.docker/merges","archive_url":"https://api.github.com/repos/ansible-collections/community.docker/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ansible-collections/community.docker/downloads","issues_url":"https://api.github.com/repos/ansible-collections/community.docker/issues{/number}","pulls_url":"https://api.github.com/repos/ansible-collections/community.docker/pulls{/number}","milestones_url":"https://api.github.com/repos/ansible-collections/community.docker/milestones{/number}","notifications_url":"https://api.github.com/repos/ansible-collections/community.docker/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ansible-collections/community.docker/labels{/name}","releases_url":"https://api.github.com/repos/ansible-collections/community.docker/releases{/id}","deployments_url":"https://api.github.com/repos/ansible-collections/community.docker/deployments","created_at":"2020-10-28T07:39:12Z","updated_at":"2021-02-24T22:45:37Z","pushed_at":"2021-02-24T22:45:34Z","git_url":"git://github.com/ansible-collections/community.docker.git","ssh_url":"git@github.com:ansible-collections/community.docker.git","clone_url":"https://github.com/ansible-collections/community.docker.git","svn_url":"https://github.com/ansible-collections/community.docker","homepage":"https://galaxy.ansible.com/community/docker/","size":517,"stargazers_count":12,"watchers_count":12,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":12,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":24,"license":{"key":"gpl-3.0","name":"GNU
        General Public License v3.0","spdx_id":"GPL-3.0","url":"https://api.github.com/licenses/gpl-3.0","node_id":"MDc6TGljZW5zZTk="},"forks":12,"open_issues":24,"watchers":12,"default_branch":"main"}},"_links":{"self":{"href":"https://api.github.com/repos/ansible-collections/community.docker/pulls/55"},"html":{"href":"https://github.com/ansible-collections/community.docker/pull/55"},"issue":{"href":"https://api.github.com/repos/ansible-collections/community.docker/issues/55"},"comments":{"href":"https://api.github.com/repos/ansible-collections/community.docker/issues/55/comments"},"review_comments":{"href":"https://api.github.com/repos/ansible-collections/community.docker/pulls/55/comments"},"review_comment":{"href":"https://api.github.com/repos/ansible-collections/community.docker/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/ansible-collections/community.docker/pulls/55/commits"},"statuses":{"href":"https://api.github.com/repos/ansible-collections/community.docker/statuses/9765947ac0af25ab95771b9745efb1a55cf6b14d"}},"author_association":"COLLABORATOR","auto_merge":null,"active_lock_reason":null,"merged":true,"mergeable":null,"rebaseable":null,"mergeable_state":"unknown","merged_by":{"login":"felixfontein","id":5781356,"node_id":"MDQ6VXNlcjU3ODEzNTY=","avatar_url":"https://avatars.githubusercontent.com/u/5781356?v=4","gravatar_id":"","url":"https://api.github.com/users/felixfontein","html_url":"https://github.com/felixfontein","followers_url":"https://api.github.com/users/felixfontein/followers","following_url":"https://api.github.com/users/felixfontein/following{/other_user}","gists_url":"https://api.github.com/users/felixfontein/gists{/gist_id}","starred_url":"https://api.github.com/users/felixfontein/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixfontein/subscriptions","organizations_url":"https://api.github.com/users/felixfontein/orgs","repos_url":"https://api.github.com/users/felixfontein/repos","events_url":"https://api.github.com/users/felixfontein/events{/privacy}","received_events_url":"https://api.github.com/users/felixfontein/received_events","type":"User","site_admin":false},"comments":11,"review_comments":3,"maintainer_can_modify":false,"commits":1,"additions":63,"deletions":6,"changed_files":3}'
    headers:
      Access-Control-Allow-Origin:
      - '*'
      Access-Control-Expose-Headers:
      - ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining,
        X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes,
        X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset
      Cache-Control:
      - private, max-age=60, s-maxage=60
      Content-Encoding:
      - gzip
      Content-Security-Policy:
      - default-src 'none'
      Content-Type:
      - application/json; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:41 GMT
      Etag:
      - W/"8dab374e1adc1ef217a9412da783b2f2b23553e098aa789ae964820403c0e02e"
      Last-Modified:
      - Wed, 17 Feb 2021 15:08:36 GMT
      Referrer-Policy:
      - origin-when-cross-origin, strict-origin-when-cross-origin
      Server:
      - GitHub.com
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - Accept, Authorization, Cookie, X-GitHub-OTP
      - Accept-Encoding, Accept, X-Requested-With
      X-Accepted-OAuth-Scopes:
      - ''
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Media-Type:
      - github.cloak-preview, github.groot-preview; format=json
      X-GitHub-Request-Id:
      - AAC0:74C8:29539:1A859E:6039F071
      X-OAuth-Scopes:
      - repo, workflow
      X-RateLimit-Limit:
      - '5000'
      X-RateLimit-Remaining:
      - '4940'
      X-RateLimit-Reset:
      - '1614412319'
      X-XSS-Protection:
      - 1; mode=block
      x-ratelimit-used:
      - '60'
    status:
      code: 200
      message: OK
    url: https://api.github.com/repos/ansible-collections/community.docker/pulls/55
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Accept-Encoding:
      - gzip, deflate
      Cookie:
      - logged_in=no
      Host:
      - github.com
      User-Agent:
      - Python/3.8 aiohttp/3.7.3
    method: GET
    uri: https://github.com/ansible-collections/community.docker/pull/55.diff
  response:
    body: {}
    headers:
      Cache-Control:
      - no-cache
      Content-Security-Policy:
      - 'default-src ''none''; base-uri ''self''; block-all-mixed-content; connect-src
        ''self'' uploads.github.com www.githubstatus.com collector.githubapp.com api.github.com
        github-cloud.s3.amazonaws.com github-production-repository-file-5c1aeb.s3.amazonaws.com
        github-production-upload-manifest-file-7fdce7.s3.amazonaws.com github-production-user-asset-6210df.s3.amazonaws.com
        cdn.optimizely.com logx.optimizely.com/v1/events wss://alive.github.com online.visualstudio.com/api/v1/locations;
        font-src github.githubassets.com; form-action ''self'' github.com gist.github.com;
        frame-ancestors ''none''; frame-src render.githubusercontent.com; img-src
        ''self'' data: github.githubassets.com identicons.github.com collector.githubapp.com
        github-cloud.s3.amazonaws.com user-images.githubusercontent.com/ *.githubusercontent.com;
        manifest-src ''self''; media-src ''none''; script-src github.githubassets.com;
        style-src ''unsafe-inline'' github.githubassets.com; worker-src github.com/socket-worker-5029ae85.js
        gist.github.com/socket-worker-5029ae85.js'
      Content-Type:
      - text/html; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:41 GMT
      Expect-CT:
      - max-age=2592000, report-uri="https://api.github.com/_private/browser/errors"
      Location:
      - https://patch-diff.githubusercontent.com/raw/ansible-collections/community.docker/pull/55.diff
      Referrer-Policy:
      - no-referrer-when-downgrade
      Server:
      - GitHub.com
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - X-PJAX
      - Accept-Encoding, Accept, X-Requested-With
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Request-Id:
      - D35A:3DBA:657B92:854186:6039F071
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 302
      message: Found
    url: https://github.com/ansible-collections/community.docker/pull/55.diff
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Accept-Encoding:
      - gzip, deflate
      Host:
      - patch-diff.githubusercontent.com
      User-Agent:
      - Python/3.8 aiohttp/3.7.3
    method: GET
    uri: https://patch-diff.githubusercontent.com/raw/ansible-collections/community.docker/pull/55.diff
  response:
    body:
      string: "diff --git a/changelogs/fragments/55-docker_image-loading.yml b/changelogs/fragments/55-docker_image-loading.yml\nnew
        file mode 100644\nindex 0000000..c7694f0\n--- /dev/null\n+++ b/changelogs/fragments/55-docker_image-loading.yml\n@@
        -0,0 +1,3 @@\n+bugfixes:\n+- \"docker_image - report error when loading a
        broken archive that contains no image (https://github.com/ansible-collections/community.docker/issues/46,
        https://github.com/ansible-collections/community.docker/pull/55).\"\n+- \"docker_image
        - report error when the loaded archive does not contain the specified image
        (https://github.com/ansible-collections/community.docker/issues/41, https://github.com/ansible-collections/community.docker/pull/55).\"\ndiff
        --git a/plugins/modules/docker_image.py b/plugins/modules/docker_image.py\nindex
        3daf009..0ee048b 100644\n--- a/plugins/modules/docker_image.py\n+++ b/plugins/modules/docker_image.py\n@@
        -640,7 +640,7 @@ def build_image(self):\n             # line = json.loads(line)\n
        \            self.log(line, pretty_print=True)\n             if \"stream\"
        in line or \"status\" in line:\n-                build_line = line.get(\"stream\")
        or line.get(\"status\")\n+                build_line = line.get(\"stream\")
        or line.get(\"status\") or ''\n                 build_output.append(build_line)\n
        \n             if line.get('error'):\n@@ -665,17 +665,45 @@ def load_image(self):\n
        \n         :return: image dict\n         '''\n+        # Load image(s) from
        file\n+        load_output = []\n         try:\n             self.log(\"Opening
        image %s\" % self.load_path)\n             with open(self.load_path, 'rb')
        as image_tar:\n                 self.log(\"Loading image from %s\" % self.load_path)\n-
        \               self.client.load_image(image_tar)\n+                for line
        in self.client.load_image(image_tar):\n+                    self.log(line,
        pretty_print=True)\n+                    if \"stream\" in line or \"status\"
        in line:\n+                        load_line = line.get(\"stream\") or line.get(\"status\")
        or ''\n+                        load_output.append(load_line)\n         except
        EnvironmentError as exc:\n             if exc.errno == errno.ENOENT:\n-                self.fail(\"Error
        opening image %s - %s\" % (self.load_path, str(exc)))\n-            self.fail(\"Error
        loading image %s - %s\" % (self.name, str(exc)))\n+                self.client.fail(\"Error
        opening image %s - %s\" % (self.load_path, str(exc)))\n+            self.client.fail(\"Error
        loading image %s - %s\" % (self.name, str(exc)), stdout='\\n'.join(load_output))\n
        \        except Exception as exc:\n-            self.fail(\"Error loading
        image %s - %s\" % (self.name, str(exc)))\n+            self.client.fail(\"Error
        loading image %s - %s\" % (self.name, str(exc)), stdout='\\n'.join(load_output))\n+\n+
        \       # Collect loaded images\n+        loaded_images = set()\n+        for
        line in load_output:\n+            if line.startswith('Loaded image:'):\n+
        \               loaded_images.add(line[len('Loaded image:'):].strip())\n+\n+
        \       if not loaded_images:\n+            self.client.fail(\"Detected no
        loaded images. Archive potentially corrupt?\", stdout='\\n'.join(load_output))\n+\n+
        \       expected_image = '%s:%s' % (self.name, self.tag)\n+        if expected_image
        not in loaded_images:\n+            self.client.fail(\n+                \"The
        archive did not contain image '%s'. Instead, found %s.\" % (\n+                    expected_image,
        ', '.join([\"'%s'\" % image for image in sorted(loaded_images)])),\n+                stdout='\\n'.join(load_output))\n+
        \       loaded_images.remove(expected_image)\n+\n+        if loaded_images:\n+
        \           self.client.module.warn(\n+                \"The archive contained
        more images than specified: %s\" % (\n+                    ', '.join([\"'%s'\"
        % image for image in sorted(loaded_images)]), ))\n \n         return self.client.find_image(self.name,
        self.tag)\n \ndiff --git a/tests/integration/targets/docker_image/tasks/tests/options.yml
        b/tests/integration/targets/docker_image/tasks/tests/options.yml\nindex b04fa8e..576f5d4
        100644\n--- a/tests/integration/targets/docker_image/tasks/tests/options.yml\n+++
        b/tests/integration/targets/docker_image/tasks/tests/options.yml\n@@ -189,6
        +189,11 @@\n     source: pull\n   register: archive_image\n \n+- name: Create
        invalid archive\n+  copy:\n+    dest: \"{{ output_dir }}/image-invalid.tar\"\n+
        \   content: \"this is not a valid image\"\n+\n - name: remove image\n   docker_image:\n
        \    name: \"{{ docker_test_image_hello_world }}\"\n@@ -209,11 +214,32 @@\n
        \    source: load\n   register: load_image_1\n \n+- name: load image (wrong
        name)\n+  docker_image:\n+    name: foo:bar\n+    load_path: \"{{ output_dir
        }}/image.tar\"\n+    source: load\n+  register: load_image_2\n+  ignore_errors:
        true\n+\n+- name: load image (invalid image)\n+  docker_image:\n+    name:
        foo:bar\n+    load_path: \"{{ output_dir }}/image-invalid.tar\"\n+    source:
        load\n+  register: load_image_3\n+  ignore_errors: true\n+\n - assert:\n     that:\n
        \    - load_image is changed\n-    - load_image_1 is not changed\n     - archive_image['image']['Id']
        == load_image['image']['Id']\n+    - load_image_1 is not changed\n+    - load_image_2
        is failed\n+    - >-\n+      \"The archive did not contain image 'foo:bar'.
        Instead, found '\" ~ docker_test_image_hello_world ~ \"'.\" == load_image_2.msg\n+
        \   - load_image_3 is failed\n+    - '\"Detected no loaded images. Archive
        potentially corrupt?\" == load_image_3.msg'\n \n ####################################################################\n
        ## path ############################################################\n"
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Content-Encoding:
      - gzip
      Content-Security-Policy:
      - 'default-src ''none''; base-uri ''self''; block-all-mixed-content; connect-src
        ''self'' uploads.github.com www.githubstatus.com collector.githubapp.com api.github.com
        github-cloud.s3.amazonaws.com github-production-repository-file-5c1aeb.s3.amazonaws.com
        github-production-upload-manifest-file-7fdce7.s3.amazonaws.com github-production-user-asset-6210df.s3.amazonaws.com
        cdn.optimizely.com logx.optimizely.com/v1/events wss://alive.github.com; font-src
        github.githubassets.com; form-action ''self'' github.com gist.github.com;
        frame-ancestors ''none''; frame-src render.githubusercontent.com; img-src
        ''self'' data: github.githubassets.com identicons.github.com collector.githubapp.com
        github-cloud.s3.amazonaws.com user-images.githubusercontent.com/ *.githubusercontent.com;
        manifest-src ''self''; media-src ''none''; script-src github.githubassets.com;
        style-src ''unsafe-inline'' github.githubassets.com; worker-src github.com/socket-worker-5029ae85.js
        gist.github.com/socket-worker-5029ae85.js'
      Content-Type:
      - text/plain; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:41 GMT
      Etag:
      - W/"90824d3a346e0c47df1a07cbd7c067ed"
      Expect-CT:
      - max-age=2592000, report-uri="https://api.github.com/_private/browser/errors"
      Referrer-Policy:
      - origin-when-cross-origin, strict-origin-when-cross-origin
      Server:
      - GitHub.com
      Set-Cookie:
      - logged_in=no; domain=.github.com; path=/; expires=Sun, 27 Feb 2022 07:10:41
        GMT; secure; HttpOnly; SameSite=Lax
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - X-PJAX
      - Accept-Encoding, Accept, X-Requested-With
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Request-Id:
      - D35C:1A52:95E33B:B71A66:6039F071
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
    url: https://patch-diff.githubusercontent.com/raw/ansible-collections/community.docker/pull/55.diff
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Cookie:
      - logged_in=no
    method: GET
    uri: https://api.github.com/repos/ansible/ansible/pulls/73556
  response:
    body:
      string: '{"url":"https://api.github.com/repos/ansible/ansible/pulls/73556","id":570687276,"node_id":"MDExOlB1bGxSZXF1ZXN0NTcwNjg3Mjc2","html_url":"https://github.com/ansible/ansible/pull/73556","diff_url":"https://github.com/ansible/ansible/pull/73556.diff","patch_url":"https://github.com/ansible/ansible/pull/73556.patch","issue_url":"https://api.github.com/repos/ansible/ansible/issues/73556","number":73556,"state":"open","locked":false,"title":"Fix
        for private_key overriding in synchronize module","user":{"login":"holser","id":954156,"node_id":"MDQ6VXNlcjk1NDE1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/954156?v=4","gravatar_id":"","url":"https://api.github.com/users/holser","html_url":"https://github.com/holser","followers_url":"https://api.github.com/users/holser/followers","following_url":"https://api.github.com/users/holser/following{/other_user}","gists_url":"https://api.github.com/users/holser/gists{/gist_id}","starred_url":"https://api.github.com/users/holser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/holser/subscriptions","organizations_url":"https://api.github.com/users/holser/orgs","repos_url":"https://api.github.com/users/holser/repos","events_url":"https://api.github.com/users/holser/events{/privacy}","received_events_url":"https://api.github.com/users/holser/received_events","type":"User","site_admin":false},"body":"SUMMARY\r\nBackport
        of https://github.com/ansible-collections/ansible.posix/commit/4b0b50439d3b7fd232291795ca0deec36e4b59de\r\n\r\nISSUE
        TYPE\r\nBug\r\n\r\nBugfix Pull Request\r\nhttps://github.com/ansible/ansible/pull/73556\r\n\r\nDocs
        Pull Request\r\nFeature Pull Request\r\nTest Pull Request\r\nCOMPONENT NAME\r\n\r\nADDITIONAL
        INFORMATION","created_at":"2021-02-09T23:25:44Z","updated_at":"2021-02-18T16:43:40Z","closed_at":null,"merged_at":null,"merge_commit_sha":"ff3d7fd0eac35fe9f8341b76c07d079b8a345c2f","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1316917295,"node_id":"MDU6TGFiZWwxMzE2OTE3Mjk1","url":"https://api.github.com/repos/ansible/ansible/labels/affects_2.9","name":"affects_2.9","color":"5319e7","default":false,"description":"This
        issue/PR affects Ansible v2.9"},{"id":266246971,"node_id":"MDU6TGFiZWwyNjYyNDY5NzE=","url":"https://api.github.com/repos/ansible/ansible/labels/backport","name":"backport","color":"00ff00","default":false,"description":"This
        PR does not target the devel branch."},{"id":785271699,"node_id":"MDU6TGFiZWw3ODUyNzE2OTk=","url":"https://api.github.com/repos/ansible/ansible/labels/bug","name":"bug","color":"fbca04","default":true,"description":"This
        issue/PR relates to a bug."},{"id":1285191701,"node_id":"MDU6TGFiZWwxMjg1MTkxNzAx","url":"https://api.github.com/repos/ansible/ansible/labels/collection","name":"collection","color":"b60205","default":false,"description":"Related
        to Ansible Collections work"},{"id":1991397378,"node_id":"MDU6TGFiZWwxOTkxMzk3Mzc4","url":"https://api.github.com/repos/ansible/ansible/labels/collection:ansible.posix","name":"collection:ansible.posix","color":"ededed","default":false,"description":null},{"id":513652538,"node_id":"MDU6TGFiZWw1MTM2NTI1Mzg=","url":"https://api.github.com/repos/ansible/ansible/labels/core_review","name":"core_review","color":"ededed","default":false,"description":"In
        order to be merged, this PR must follow the core review workflow."},{"id":503572087,"node_id":"MDU6TGFiZWw1MDM1NzIwODc=","url":"https://api.github.com/repos/ansible/ansible/labels/needs_triage","name":"needs_triage","color":"0e8a16","default":false,"description":"Needs
        a first human triage before being processed."},{"id":723150340,"node_id":"MDU6TGFiZWw3MjMxNTAzNDA=","url":"https://api.github.com/repos/ansible/ansible/labels/new_contributor","name":"new_contributor","color":"c2e0c6","default":false,"description":"This
        PR is the first contribution by a new community member."},{"id":153577825,"node_id":"MDU6TGFiZWwxNTM1Nzc4MjU=","url":"https://api.github.com/repos/ansible/ansible/labels/new_plugin","name":"new_plugin","color":"bfe5bf","default":false,"description":"This
        PR includes a new plugin."},{"id":581543918,"node_id":"MDU6TGFiZWw1ODE1NDM5MTg=","url":"https://api.github.com/repos/ansible/ansible/labels/stale_ci","name":"stale_ci","color":"fef2c0","default":false,"description":"This
        PR has been tested by CI more than one week ago. Close and re-open this PR
        to get it retested."},{"id":636327968,"node_id":"MDU6TGFiZWw2MzYzMjc5Njg=","url":"https://api.github.com/repos/ansible/ansible/labels/support:community","name":"support:community","color":"ededed","default":false,"description":"This
        issue/PR relates to code supported by the Ansible community."},{"id":636352796,"node_id":"MDU6TGFiZWw2MzYzNTI3OTY=","url":"https://api.github.com/repos/ansible/ansible/labels/support:core","name":"support:core","color":"ededed","default":false,"description":"This
        issue/PR relates to code supported by the Ansible Engineering Team."},{"id":468273802,"node_id":"MDU6TGFiZWw0NjgyNzM4MDI=","url":"https://api.github.com/repos/ansible/ansible/labels/test","name":"test","color":"0e8a16","default":false,"description":"This
        PR relates to tests."}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/ansible/ansible/pulls/73556/commits","review_comments_url":"https://api.github.com/repos/ansible/ansible/pulls/73556/comments","review_comment_url":"https://api.github.com/repos/ansible/ansible/pulls/comments{/number}","comments_url":"https://api.github.com/repos/ansible/ansible/issues/73556/comments","statuses_url":"https://api.github.com/repos/ansible/ansible/statuses/c38a0ed55403d508b77d1ba7dc91c4e7ce14780f","head":{"label":"holser:fix_synchronize","ref":"fix_synchronize","sha":"c38a0ed55403d508b77d1ba7dc91c4e7ce14780f","user":{"login":"holser","id":954156,"node_id":"MDQ6VXNlcjk1NDE1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/954156?v=4","gravatar_id":"","url":"https://api.github.com/users/holser","html_url":"https://github.com/holser","followers_url":"https://api.github.com/users/holser/followers","following_url":"https://api.github.com/users/holser/following{/other_user}","gists_url":"https://api.github.com/users/holser/gists{/gist_id}","starred_url":"https://api.github.com/users/holser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/holser/subscriptions","organizations_url":"https://api.github.com/users/holser/orgs","repos_url":"https://api.github.com/users/holser/repos","events_url":"https://api.github.com/users/holser/events{/privacy}","received_events_url":"https://api.github.com/users/holser/received_events","type":"User","site_admin":false},"repo":{"id":331725409,"node_id":"MDEwOlJlcG9zaXRvcnkzMzE3MjU0MDk=","name":"ansible","full_name":"holser/ansible","private":false,"owner":{"login":"holser","id":954156,"node_id":"MDQ6VXNlcjk1NDE1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/954156?v=4","gravatar_id":"","url":"https://api.github.com/users/holser","html_url":"https://github.com/holser","followers_url":"https://api.github.com/users/holser/followers","following_url":"https://api.github.com/users/holser/following{/other_user}","gists_url":"https://api.github.com/users/holser/gists{/gist_id}","starred_url":"https://api.github.com/users/holser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/holser/subscriptions","organizations_url":"https://api.github.com/users/holser/orgs","repos_url":"https://api.github.com/users/holser/repos","events_url":"https://api.github.com/users/holser/events{/privacy}","received_events_url":"https://api.github.com/users/holser/received_events","type":"User","site_admin":false},"html_url":"https://github.com/holser/ansible","description":"Ansible
        is a radically simple IT automation platform that makes your applications
        and systems easier to deploy and maintain. Automate everything from code deployment
        to network configuration to cloud management, in a language that approaches
        plain English, using SSH, with no agents to install on remote systems. https://docs.ansible.com.","fork":true,"url":"https://api.github.com/repos/holser/ansible","forks_url":"https://api.github.com/repos/holser/ansible/forks","keys_url":"https://api.github.com/repos/holser/ansible/keys{/key_id}","collaborators_url":"https://api.github.com/repos/holser/ansible/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/holser/ansible/teams","hooks_url":"https://api.github.com/repos/holser/ansible/hooks","issue_events_url":"https://api.github.com/repos/holser/ansible/issues/events{/number}","events_url":"https://api.github.com/repos/holser/ansible/events","assignees_url":"https://api.github.com/repos/holser/ansible/assignees{/user}","branches_url":"https://api.github.com/repos/holser/ansible/branches{/branch}","tags_url":"https://api.github.com/repos/holser/ansible/tags","blobs_url":"https://api.github.com/repos/holser/ansible/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/holser/ansible/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/holser/ansible/git/refs{/sha}","trees_url":"https://api.github.com/repos/holser/ansible/git/trees{/sha}","statuses_url":"https://api.github.com/repos/holser/ansible/statuses/{sha}","languages_url":"https://api.github.com/repos/holser/ansible/languages","stargazers_url":"https://api.github.com/repos/holser/ansible/stargazers","contributors_url":"https://api.github.com/repos/holser/ansible/contributors","subscribers_url":"https://api.github.com/repos/holser/ansible/subscribers","subscription_url":"https://api.github.com/repos/holser/ansible/subscription","commits_url":"https://api.github.com/repos/holser/ansible/commits{/sha}","git_commits_url":"https://api.github.com/repos/holser/ansible/git/commits{/sha}","comments_url":"https://api.github.com/repos/holser/ansible/comments{/number}","issue_comment_url":"https://api.github.com/repos/holser/ansible/issues/comments{/number}","contents_url":"https://api.github.com/repos/holser/ansible/contents/{+path}","compare_url":"https://api.github.com/repos/holser/ansible/compare/{base}...{head}","merges_url":"https://api.github.com/repos/holser/ansible/merges","archive_url":"https://api.github.com/repos/holser/ansible/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/holser/ansible/downloads","issues_url":"https://api.github.com/repos/holser/ansible/issues{/number}","pulls_url":"https://api.github.com/repos/holser/ansible/pulls{/number}","milestones_url":"https://api.github.com/repos/holser/ansible/milestones{/number}","notifications_url":"https://api.github.com/repos/holser/ansible/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/holser/ansible/labels{/name}","releases_url":"https://api.github.com/repos/holser/ansible/releases{/id}","deployments_url":"https://api.github.com/repos/holser/ansible/deployments","created_at":"2021-01-21T18:58:57Z","updated_at":"2021-02-09T23:11:57Z","pushed_at":"2021-02-10T00:13:41Z","git_url":"git://github.com/holser/ansible.git","ssh_url":"git@github.com:holser/ansible.git","clone_url":"https://github.com/holser/ansible.git","svn_url":"https://github.com/holser/ansible","homepage":"https://www.ansible.com/","size":186484,"stargazers_count":0,"watchers_count":0,"language":"Python","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"gpl-3.0","name":"GNU
        General Public License v3.0","spdx_id":"GPL-3.0","url":"https://api.github.com/licenses/gpl-3.0","node_id":"MDc6TGljZW5zZTk="},"forks":0,"open_issues":0,"watchers":0,"default_branch":"devel"}},"base":{"label":"ansible:stable-2.9","ref":"stable-2.9","sha":"7a7f5a700660c9ea9028062b6714540df57910e2","user":{"login":"ansible","id":1507452,"node_id":"MDEyOk9yZ2FuaXphdGlvbjE1MDc0NTI=","avatar_url":"https://avatars.githubusercontent.com/u/1507452?v=4","gravatar_id":"","url":"https://api.github.com/users/ansible","html_url":"https://github.com/ansible","followers_url":"https://api.github.com/users/ansible/followers","following_url":"https://api.github.com/users/ansible/following{/other_user}","gists_url":"https://api.github.com/users/ansible/gists{/gist_id}","starred_url":"https://api.github.com/users/ansible/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ansible/subscriptions","organizations_url":"https://api.github.com/users/ansible/orgs","repos_url":"https://api.github.com/users/ansible/repos","events_url":"https://api.github.com/users/ansible/events{/privacy}","received_events_url":"https://api.github.com/users/ansible/received_events","type":"Organization","site_admin":false},"repo":{"id":3638964,"node_id":"MDEwOlJlcG9zaXRvcnkzNjM4OTY0","name":"ansible","full_name":"ansible/ansible","private":false,"owner":{"login":"ansible","id":1507452,"node_id":"MDEyOk9yZ2FuaXphdGlvbjE1MDc0NTI=","avatar_url":"https://avatars.githubusercontent.com/u/1507452?v=4","gravatar_id":"","url":"https://api.github.com/users/ansible","html_url":"https://github.com/ansible","followers_url":"https://api.github.com/users/ansible/followers","following_url":"https://api.github.com/users/ansible/following{/other_user}","gists_url":"https://api.github.com/users/ansible/gists{/gist_id}","starred_url":"https://api.github.com/users/ansible/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ansible/subscriptions","organizations_url":"https://api.github.com/users/ansible/orgs","repos_url":"https://api.github.com/users/ansible/repos","events_url":"https://api.github.com/users/ansible/events{/privacy}","received_events_url":"https://api.github.com/users/ansible/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/ansible/ansible","description":"Ansible
        is a radically simple IT automation platform that makes your applications
        and systems easier to deploy and maintain. Automate everything from code deployment
        to network configuration to cloud management, in a language that approaches
        plain English, using SSH, with no agents to install on remote systems. https://docs.ansible.com.","fork":false,"url":"https://api.github.com/repos/ansible/ansible","forks_url":"https://api.github.com/repos/ansible/ansible/forks","keys_url":"https://api.github.com/repos/ansible/ansible/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ansible/ansible/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ansible/ansible/teams","hooks_url":"https://api.github.com/repos/ansible/ansible/hooks","issue_events_url":"https://api.github.com/repos/ansible/ansible/issues/events{/number}","events_url":"https://api.github.com/repos/ansible/ansible/events","assignees_url":"https://api.github.com/repos/ansible/ansible/assignees{/user}","branches_url":"https://api.github.com/repos/ansible/ansible/branches{/branch}","tags_url":"https://api.github.com/repos/ansible/ansible/tags","blobs_url":"https://api.github.com/repos/ansible/ansible/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ansible/ansible/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ansible/ansible/git/refs{/sha}","trees_url":"https://api.github.com/repos/ansible/ansible/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ansible/ansible/statuses/{sha}","languages_url":"https://api.github.com/repos/ansible/ansible/languages","stargazers_url":"https://api.github.com/repos/ansible/ansible/stargazers","contributors_url":"https://api.github.com/repos/ansible/ansible/contributors","subscribers_url":"https://api.github.com/repos/ansible/ansible/subscribers","subscription_url":"https://api.github.com/repos/ansible/ansible/subscription","commits_url":"https://api.github.com/repos/ansible/ansible/commits{/sha}","git_commits_url":"https://api.github.com/repos/ansible/ansible/git/commits{/sha}","comments_url":"https://api.github.com/repos/ansible/ansible/comments{/number}","issue_comment_url":"https://api.github.com/repos/ansible/ansible/issues/comments{/number}","contents_url":"https://api.github.com/repos/ansible/ansible/contents/{+path}","compare_url":"https://api.github.com/repos/ansible/ansible/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ansible/ansible/merges","archive_url":"https://api.github.com/repos/ansible/ansible/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ansible/ansible/downloads","issues_url":"https://api.github.com/repos/ansible/ansible/issues{/number}","pulls_url":"https://api.github.com/repos/ansible/ansible/pulls{/number}","milestones_url":"https://api.github.com/repos/ansible/ansible/milestones{/number}","notifications_url":"https://api.github.com/repos/ansible/ansible/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ansible/ansible/labels{/name}","releases_url":"https://api.github.com/repos/ansible/ansible/releases{/id}","deployments_url":"https://api.github.com/repos/ansible/ansible/deployments","created_at":"2012-03-06T14:58:02Z","updated_at":"2021-02-27T02:40:42Z","pushed_at":"2021-02-27T06:00:14Z","git_url":"git://github.com/ansible/ansible.git","ssh_url":"org-1507452@github.com:ansible/ansible.git","clone_url":"https://github.com/ansible/ansible.git","svn_url":"https://github.com/ansible/ansible","homepage":"https://www.ansible.com/","size":194931,"stargazers_count":47033,"watchers_count":47033,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"forks_count":20311,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1892,"license":{"key":"gpl-3.0","name":"GNU
        General Public License v3.0","spdx_id":"GPL-3.0","url":"https://api.github.com/licenses/gpl-3.0","node_id":"MDc6TGljZW5zZTk="},"forks":20311,"open_issues":1892,"watchers":47033,"default_branch":"devel"}},"_links":{"self":{"href":"https://api.github.com/repos/ansible/ansible/pulls/73556"},"html":{"href":"https://github.com/ansible/ansible/pull/73556"},"issue":{"href":"https://api.github.com/repos/ansible/ansible/issues/73556"},"comments":{"href":"https://api.github.com/repos/ansible/ansible/issues/73556/comments"},"review_comments":{"href":"https://api.github.com/repos/ansible/ansible/pulls/73556/comments"},"review_comment":{"href":"https://api.github.com/repos/ansible/ansible/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/ansible/ansible/pulls/73556/commits"},"statuses":{"href":"https://api.github.com/repos/ansible/ansible/statuses/c38a0ed55403d508b77d1ba7dc91c4e7ce14780f"}},"author_association":"FIRST_TIME_CONTRIBUTOR","auto_merge":null,"active_lock_reason":null,"merged":false,"mergeable":true,"rebaseable":true,"mergeable_state":"clean","merged_by":null,"comments":1,"review_comments":0,"maintainer_can_modify":true,"commits":1,"additions":1943,"deletions":5,"changed_files":12}'
    headers:
      Access-Control-Allow-Origin:
      - '*'
      Access-Control-Expose-Headers:
      - ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining,
        X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes,
        X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset
      Cache-Control:
      - private, max-age=60, s-maxage=60
      Content-Encoding:
      - gzip
      Content-Security-Policy:
      - default-src 'none'
      Content-Type:
      - application/json; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:42 GMT
      Etag:
      - W/"d9025a416b31fe9125b26c3ced320e90c88ce66269a1288d29f3b1937b110dc3"
      Last-Modified:
      - Wed, 24 Feb 2021 11:34:34 GMT
      Referrer-Policy:
      - origin-when-cross-origin, strict-origin-when-cross-origin
      Server:
      - GitHub.com
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - Accept, Authorization, Cookie, X-GitHub-OTP
      - Accept-Encoding, Accept, X-Requested-With
      X-Accepted-OAuth-Scopes:
      - ''
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Media-Type:
      - github.cloak-preview, github.groot-preview; format=json
      X-GitHub-Request-Id:
      - AAC0:74C8:2953B:1A85AD:6039F071
      X-OAuth-Scopes:
      - repo, workflow
      X-RateLimit-Limit:
      - '5000'
      X-RateLimit-Remaining:
      - '4939'
      X-RateLimit-Reset:
      - '1614412319'
      X-XSS-Protection:
      - 1; mode=block
      x-ratelimit-used:
      - '61'
    status:
      code: 200
      message: OK
    url: https://api.github.com/repos/ansible/ansible/pulls/73556
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Accept-Encoding:
      - gzip, deflate
      Cookie:
      - logged_in=no
      Host:
      - github.com
      User-Agent:
      - Python/3.8 aiohttp/3.7.3
    method: GET
    uri: https://github.com/ansible/ansible/pull/73556.diff
  response:
    body: {}
    headers:
      Cache-Control:
      - no-cache
      Content-Security-Policy:
      - 'default-src ''none''; base-uri ''self''; block-all-mixed-content; connect-src
        ''self'' uploads.github.com www.githubstatus.com collector.githubapp.com api.github.com
        github-cloud.s3.amazonaws.com github-production-repository-file-5c1aeb.s3.amazonaws.com
        github-production-upload-manifest-file-7fdce7.s3.amazonaws.com github-production-user-asset-6210df.s3.amazonaws.com
        cdn.optimizely.com logx.optimizely.com/v1/events wss://alive.github.com online.visualstudio.com/api/v1/locations;
        font-src github.githubassets.com; form-action ''self'' github.com gist.github.com;
        frame-ancestors ''none''; frame-src render.githubusercontent.com; img-src
        ''self'' data: github.githubassets.com identicons.github.com collector.githubapp.com
        github-cloud.s3.amazonaws.com user-images.githubusercontent.com/ *.githubusercontent.com;
        manifest-src ''self''; media-src ''none''; script-src github.githubassets.com;
        style-src ''unsafe-inline'' github.githubassets.com; worker-src github.com/socket-worker-5029ae85.js
        gist.github.com/socket-worker-5029ae85.js'
      Content-Type:
      - text/html; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:42 GMT
      Expect-CT:
      - max-age=2592000, report-uri="https://api.github.com/_private/browser/errors"
      Location:
      - https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73556.diff
      Referrer-Policy:
      - no-referrer-when-downgrade
      Server:
      - GitHub.com
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - X-PJAX
      - Accept-Encoding, Accept, X-Requested-With
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Request-Id:
      - D35A:3DBA:657BDE:8541D9:6039F072
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 302
      message: Found
    url: https://github.com/ansible/ansible/pull/73556.diff
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Accept-Encoding:
      - gzip, deflate
      Host:
      - patch-diff.githubusercontent.com
      User-Agent:
      - Python/3.8 aiohttp/3.7.3
    method: GET
    uri: https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73556.diff
  response:
    body:
      string: "diff --git a/changelogs/fragments/73556-private-key-override-fix.yml-private-key-override-fix.yml
        b/changelogs/fragments/73556-private-key-override-fix.yml-private-key-override-fix.yml\nnew
        file mode 100644\nindex 0000000000000..fabb66fef4e23\n--- /dev/null\n+++ b/changelogs/fragments/73556-private-key-override-fix.yml-private-key-override-fix.yml\n@@
        -0,0 +1,3 @@\n+---\n+bugfixes:\n+  - synchronize - Fix for private_key overriding
        in synchronize module\ndiff --git a/lib/ansible/plugins/action/synchronize.py
        b/lib/ansible/plugins/action/synchronize.py\nindex 0385cc9a72d19..0ff1751607b78
        100644\n--- a/lib/ansible/plugins/action/synchronize.py\n+++ b/lib/ansible/plugins/action/synchronize.py\n@@
        -332,11 +332,8 @@ def run(self, tmp=None, task_vars=None):\n                 else:\n
        \                    user = task_vars.get('ansible_ssh_user') or self._play_context.remote_user\n
        \n-            # Private key handling\n-            private_key = self._play_context.private_key_file\n-\n-
        \           if private_key is not None:\n-                _tmp_args['private_key']
        = private_key\n+            # Use the private_key parameter if passed else
        use context private_key_file\n+            _tmp_args['private_key'] = _tmp_args.get('private_key',
        self._play_context.private_key_file)\n \n             # use the mode to define
        src and dest's url\n             if _tmp_args.get('mode', 'push') == 'pull':\ndiff
        --git a/test/units/plugins/action/fixtures/synchronize/basic_with_private_key/meta.yaml
        b/test/units/plugins/action/fixtures/synchronize/basic_with_private_key/meta.yaml\nnew
        file mode 100644\nindex 0000000000000..9b227e075b167\n--- /dev/null\n+++ b/test/units/plugins/action/fixtures/synchronize/basic_with_private_key/meta.yaml\n@@
        -0,0 +1,25 @@\n+fixtures:\n+    taskvars_in: taskvars_in.json\n+    taskvars_out:
        taskvars_out.json\n+connection:\n+    transport: 'ssh'\n+hostvars:\n+    '127.0.0.1':
        {}\n+    '::1': {}\n+    'localhost': {}\n+_play_context:\n+   private_key_file:
        ~/test.pem\n+task_args:\n+   private_key: ~/.ssh/id_rsa\n+   dest: /tmp/deleteme\n+
        \  src: /tmp/deleteme\n+\n+asserts:\n+    - \"hasattr(SAM._connection, 'ismock')\"\n+
        \   - \"SAM._connection.transport == 'local'\"\n+    - \"self._play_context.shell
        == 'sh'\"\n+    - \"self.execute_called\"\n+    - \"self.final_module_args['_local_rsync_path']
        == 'rsync'\"\n+    - \"self.final_module_args['src'] == '/tmp/deleteme'\"\n+
        \   - \"self.final_module_args['dest'] == 'root@el6host:/tmp/deleteme'\"\n+
        \   - \"self.final_module_args['private_key'] == '~/.ssh/id_rsa'\"\ndiff --git
        a/test/units/plugins/action/fixtures/synchronize/basic_with_private_key/taskvars_in.json
        b/test/units/plugins/action/fixtures/synchronize/basic_with_private_key/taskvars_in.json\nnew
        file mode 100644\nindex 0000000000000..9eb5d50ad1fc1\n--- /dev/null\n+++ b/test/units/plugins/action/fixtures/synchronize/basic_with_private_key/taskvars_in.json\n@@
        -0,0 +1,151 @@\n+{\n+  \"ansible_pipelining\": false, \n+  \"ansible_docker_extra_args\":
        \"\", \n+  \"ansible_scp_extra_args\": \"\", \n+  \"ansible_user\": \"root\",
        \n+  \"ansible_play_hosts\": [\n+    \"el6host\"\n+  ], \n+  \"ansible_connection\":
        \"smart\", \n+  \"ansible_ssh_common_args\": \"\", \n+  \"environment\": [],
        \n+  \"inventory_hostname\": \"el6host\", \n+  \"vars\": {\n+    \"ansible_check_mode\":
        false, \n+    \"inventory_hostname\": \"el6host\", \n+    \"inventory_file\":
        \"inventory\", \n+    \"inventory_hostname_short\": \"el6host\", \n+    \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+    \"role_names\": [], \n+
        \   \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+    \"environment\":
        [], \n+    \"play_hosts\": [\n+      \"el6host\"\n+    ], \n+    \"ansible_play_hosts\":
        [\n+      \"el6host\"\n+    ], \n+    \"hostvars\": {\n+      \"el6host\":
        {\n+        \"inventory_file\": \"inventory\", \n+        \"group_names\":
        [\n+          \"ungrouped\"\n+        ], \n+        \"groups\": {\n+          \"ungrouped\":
        [\n+            \"el6host\"\n+          ], \n+          \"all\": [\n+            \"el6host\"\n+
        \         ]\n+        }, \n+        \"inventory_hostname\": \"el6host\", \n+
        \       \"inventory_hostname_short\": \"el6host\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__03600813b83569c710bf5cb2a040d6e01da927c6\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }\n+    }, \n+    \"groups\":
        {\n+      \"ungrouped\": [\n+        \"el6host\"\n+      ], \n+      \"all\":
        [\n+        \"el6host\"\n+      ]\n+    }, \n+    \"group_names\": [\n+      \"ungrouped\"\n+
        \   ], \n+    \"omit\": \"__omit_place_holder__03600813b83569c710bf5cb2a040d6e01da927c6\",
        \n+    \"ansible_version\": {\n+      \"major\": 2, \n+      \"full\": \"2.2.0\",
        \n+      \"string\": \"2.2.0\", \n+      \"minor\": 2, \n+      \"revision\":
        0\n+    }, \n+    \"ansible_ssh_user\": \"root\"\n+  }, \n+  \"ansible_accelerate_port\":
        5099, \n+  \"roledir\": null, \n+  \"ansible_ssh_extra_args\": \"\", \n+  \"ansible_ssh_host\":
        \"el6host\", \n+  \"ansible_current_hosts\": [\n+    \"el6host\"\n+  ], \n+
        \ \"hostvars\": {\n+    \"el6host\": {\n+      \"inventory_file\": \"inventory\",
        \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ], \n+      \"groups\":
        {\n+        \"ungrouped\": [\n+          \"el6host\"\n+        ], \n+        \"all\":
        [\n+          \"el6host\"\n+        ]\n+      }, \n+      \"inventory_hostname\":
        \"el6host\", \n+      \"inventory_hostname_short\": \"el6host\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"omit\": \"__omit_place_holder__03600813b83569c710bf5cb2a040d6e01da927c6\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }\n+  }, \n+  \"group_names\": [\n+
        \   \"ungrouped\"\n+  ], \n+  \"ansible_version\": {\n+    \"major\": 2, \n+
        \   \"full\": \"2.2.0\", \n+    \"string\": \"2.2.0\", \n+    \"minor\": 2,
        \n+    \"revision\": 0\n+  }, \n+  \"ansible_ssh_pipelining\": false, \n+
        \ \"inventory_file\": \"inventory\", \n+  \"ansible_module_compression\":
        \"ZIP_DEFLATED\", \n+  \"ansible_failed_hosts\": [], \n+  \"ansible_check_mode\":
        false, \n+  \"groups\": {\n+    \"ungrouped\": [\n+      \"el6host\"\n+    ],
        \n+    \"all\": [\n+      \"el6host\"\n+    ]\n+  }, \n+  \"ansible_host\":
        \"el6host\", \n+  \"ansible_shell_executable\": \"/bin/sh\", \n+  \"inventory_hostname_short\":
        \"el6host\", \n+  \"omit\": \"__omit_place_holder__03600813b83569c710bf5cb2a040d6e01da927c6\",
        \n+  \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+  \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+  \"ansible_ssh_user\": \"root\",
        \n+  \"role_names\": [], \n+  \"play_hosts\": [\n+    \"el6host\"\n+  ], \n+
        \ \"ansible_sftp_extra_args\": \"\"\n+}\n\\ No newline at end of file\ndiff
        --git a/test/units/plugins/action/fixtures/synchronize/basic_with_private_key/taskvars_out.json
        b/test/units/plugins/action/fixtures/synchronize/basic_with_private_key/taskvars_out.json\nnew
        file mode 100644\nindex 0000000000000..01ebee25296cf\n--- /dev/null\n+++ b/test/units/plugins/action/fixtures/synchronize/basic_with_private_key/taskvars_out.json\n@@
        -0,0 +1,156 @@\n+{\n+  \"ansible_pipelining\": false, \n+  \"ansible_docker_extra_args\":
        \"\", \n+  \"ansible_scp_extra_args\": \"\", \n+  \"ansible_user\": \"root\",
        \n+  \"ansible_play_hosts\": [\n+    \"el6host\"\n+  ], \n+  \"ansible_connection\":
        \"smart\", \n+  \"ansible_ssh_common_args\": \"\", \n+  \"environment\": [],
        \n+  \"inventory_hostname\": \"el6host\", \n+  \"vars\": {\n+    \"ansible_check_mode\":
        false, \n+    \"inventory_hostname\": \"el6host\", \n+    \"inventory_file\":
        \"inventory\", \n+    \"inventory_hostname_short\": \"el6host\", \n+    \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+    \"role_names\": [], \n+
        \   \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+    \"environment\":
        [], \n+    \"play_hosts\": [\n+      \"el6host\"\n+    ], \n+    \"ansible_play_hosts\":
        [\n+      \"el6host\"\n+    ], \n+    \"hostvars\": {\n+      \"el6host\":
        {\n+        \"inventory_file\": \"inventory\", \n+        \"group_names\":
        [\n+          \"ungrouped\"\n+        ], \n+        \"groups\": {\n+          \"ungrouped\":
        [\n+            \"el6host\", \n+            \"::1\"\n+          ], \n+          \"all\":
        [\n+            \"el6host\", \n+            \"::1\"\n+          ]\n+        },
        \n+        \"inventory_hostname\": \"el6host\", \n+        \"inventory_hostname_short\":
        \"el6host\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"omit\": \"__omit_place_holder__03600813b83569c710bf5cb2a040d6e01da927c6\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }\n+    }, \n+    \"groups\":
        {\n+      \"ungrouped\": [\n+        \"el6host\"\n+      ], \n+      \"all\":
        [\n+        \"el6host\"\n+      ]\n+    }, \n+    \"group_names\": [\n+      \"ungrouped\"\n+
        \   ], \n+    \"omit\": \"__omit_place_holder__03600813b83569c710bf5cb2a040d6e01da927c6\",
        \n+    \"ansible_version\": {\n+      \"major\": 2, \n+      \"full\": \"2.2.0\",
        \n+      \"string\": \"2.2.0\", \n+      \"minor\": 2, \n+      \"revision\":
        0\n+    }, \n+    \"ansible_ssh_user\": \"root\"\n+  }, \n+  \"ansible_accelerate_port\":
        5099, \n+  \"roledir\": null, \n+  \"ansible_ssh_extra_args\": \"\", \n+  \"ansible_ssh_host\":
        \"el6host\", \n+  \"ansible_current_hosts\": [\n+    \"el6host\"\n+  ], \n+
        \ \"hostvars\": {\n+    \"el6host\": {\n+      \"inventory_file\": \"inventory\",
        \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ], \n+      \"groups\":
        {\n+        \"ungrouped\": [\n+          \"el6host\", \n+          \"::1\"\n+
        \       ], \n+        \"all\": [\n+          \"el6host\", \n+          \"::1\"\n+
        \       ]\n+      }, \n+      \"inventory_hostname\": \"el6host\", \n+      \"inventory_hostname_short\":
        \"el6host\", \n+      \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__03600813b83569c710bf5cb2a040d6e01da927c6\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }\n+  }, \n+  \"group_names\": [\n+
        \   \"ungrouped\"\n+  ], \n+  \"ansible_version\": {\n+    \"major\": 2, \n+
        \   \"full\": \"2.2.0\", \n+    \"string\": \"2.2.0\", \n+    \"minor\": 2,
        \n+    \"revision\": 0\n+  }, \n+  \"ansible_ssh_pipelining\": false, \n+
        \ \"inventory_file\": \"inventory\", \n+  \"ansible_module_compression\":
        \"ZIP_DEFLATED\", \n+  \"ansible_failed_hosts\": [], \n+  \"ansible_check_mode\":
        false, \n+  \"groups\": {\n+    \"ungrouped\": [\n+      \"el6host\"\n+    ],
        \n+    \"all\": [\n+      \"el6host\"\n+    ]\n+  }, \n+  \"ansible_host\":
        \"el6host\", \n+  \"ansible_shell_executable\": \"/bin/sh\", \n+  \"inventory_hostname_short\":
        \"el6host\", \n+  \"omit\": \"__omit_place_holder__03600813b83569c710bf5cb2a040d6e01da927c6\",
        \n+  \"ansible_python_interpreter\": \"/usr/bin/python\", \n+  \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+  \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+  \"ansible_ssh_user\": \"root\", \n+  \"role_names\": [], \n+  \"play_hosts\":
        [\n+    \"el6host\"\n+  ], \n+  \"ansible_sftp_extra_args\": \"\"\n+}\n\\
        No newline at end of file\ndiff --git a/test/units/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/meta.yaml
        b/test/units/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/meta.yaml\nnew
        file mode 100644\nindex 0000000000000..31939caffdc61\n--- /dev/null\n+++ b/test/units/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/meta.yaml\n@@
        -0,0 +1,28 @@\n+fixtures:\n+    taskvars_in: task_vars_in.json\n+    taskvars_out:
        task_vars_out.json\n+task_args:\n+    src: /tmp/deleteme\n+    dest: /tmp/deleteme\n+_task:\n+
        \   delegate_to: u1404    \n+_play_context:\n+    shell: None\n+    remote_addr:
        u1404\n+    remote_user: root\n+    private_key_file: ~/test.pem\n+connection:\n+
        \   transport: 'ssh'\n+hostvars:\n+    '127.0.0.1': {}\n+    '::1': {}\n+
        \   'localhost': {}\n+asserts:\n+    - \"hasattr(SAM._connection, 'ismock')\"\n+
        \   - \"SAM._connection.transport == 'ssh'\"\n+    - \"self._play_context.shell
        == None\"\n+    - \"self.execute_called\"\n+    - \"self.final_module_args['_local_rsync_path']
        == 'rsync'\"\n+    - \"self.final_module_args['src'] == '/tmp/deleteme'\"\n+
        \   - \"self.final_module_args['dest'] == 'root@el6host:/tmp/deleteme'\"\n+
        \   - \"self.final_module_args['private_key'] == '~/test.pem'\"\ndiff --git
        a/test/units/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/task_vars_in.json
        b/test/units/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/task_vars_in.json\nnew
        file mode 100644\nindex 0000000000000..b8893eef85cf8\n--- /dev/null\n+++ b/test/units/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/task_vars_in.json\n@@
        -0,0 +1,379 @@\n+{\n+  \"ansible_pipelining\": false, \n+  \"ansible_docker_extra_args\":
        \"\", \n+  \"ansible_scp_extra_args\": \"\", \n+  \"ansible_user\": \"root\",
        \n+  \"ansible_play_hosts\": [\n+    \"el6host\"\n+  ], \n+  \"ansible_connection\":
        \"smart\", \n+  \"ansible_ssh_common_args\": \"\", \n+  \"environment\": [],
        \n+  \"inventory_hostname\": \"el6host\", \n+  \"vars\": {\n+    \"ansible_check_mode\":
        false, \n+    \"inventory_hostname\": \"el6host\", \n+    \"inventory_file\":
        \"inventory\", \n+    \"ansible_delegated_vars\": {\n+      \"u1404\": {\n+
        \       \"inventory_hostname\": \"u1404\", \n+        \"inventory_file\":
        \"inventory\", \n+        \"vars\": {\n+          \"inventory_file\": \"inventory\",
        \n+          \"role_names\": [], \n+          \"ansible_play_hosts\": [\n+
        \           \"el6host\"\n+          ], \n+          \"groups\": {\n+            \"ungrouped\":
        [\n+              \"el6host\", \n+              \"u1404\"\n+            ],
        \n+            \"all\": [\n+              \"el6host\", \n+              \"u1404\"\n+
        \           ]\n+          }, \n+          \"ansible_check_mode\": false, \n+
        \         \"inventory_hostname\": \"u1404\", \n+          \"inventory_hostname_short\":
        \"u1404\", \n+          \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+          \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+          \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+          \"environment\": [], \n+          \"ansible_ssh_user\": \"root\",
        \n+          \"group_names\": [\n+            \"ungrouped\"\n+          ],
        \n+          \"play_hosts\": [\n+            \"el6host\"\n+          ], \n+
        \         \"ansible_version\": {\n+            \"major\": 2, \n+            \"full\":
        \"2.2.0\", \n+            \"string\": \"2.2.0\", \n+            \"minor\":
        2, \n+            \"revision\": 0\n+          }\n+        }, \n+        \"inventory_hostname_short\":
        \"u1404\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"group_names\": [\n+          \"ungrouped\"\n+        ], \n+        \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"ansible_host\": \"u1404\", \n+        \"environment\": [], \n+
        \       \"ansible_play_hosts\": [\n+          \"el6host\"\n+        ], \n+
        \       \"groups\": {\n+          \"ungrouped\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ]\n+        }, \n+        \"ansible_check_mode\":
        false, \n+        \"play_hosts\": [\n+          \"el6host\"\n+        ], \n+
        \       \"role_names\": [], \n+        \"ansible_port\": null, \n+        \"ansible_version\":
        {\n+          \"major\": 2, \n+          \"full\": \"2.2.0\", \n+          \"string\":
        \"2.2.0\", \n+          \"minor\": 2, \n+          \"revision\": 0\n+        },
        \n+        \"ansible_ssh_user\": \"root\"\n+      }\n+    }, \n+    \"inventory_hostname_short\":
        \"el6host\", \n+    \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+    \"role_names\": [], \n+    \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+    \"environment\": [], \n+    \"play_hosts\": [\n+      \"el6host\"\n+
        \   ], \n+    \"ansible_play_hosts\": [\n+      \"el6host\"\n+    ], \n+    \"hostvars\":
        {\n+      \"el6host\": {\n+        \"inventory_file\": \"inventory\", \n+
        \       \"group_names\": [\n+          \"ungrouped\"\n+        ], \n+        \"groups\":
        {\n+          \"ungrouped\": [\n+            \"el6host\", \n+            \"u1404\"\n+
        \         ], \n+          \"all\": [\n+            \"el6host\", \n+            \"u1404\"\n+
        \         ]\n+        }, \n+        \"inventory_hostname\": \"el6host\", \n+
        \       \"inventory_hostname_short\": \"el6host\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }, \n+      \"u1404\": {\n+
        \       \"inventory_file\": \"inventory\", \n+        \"group_names\": [\n+
        \         \"ungrouped\"\n+        ], \n+        \"groups\": {\n+          \"ungrouped\":
        [\n+            \"el6host\", \n+            \"u1404\"\n+          ], \n+          \"all\":
        [\n+            \"el6host\", \n+            \"u1404\"\n+          ]\n+        },
        \n+        \"inventory_hostname\": \"u1404\", \n+        \"inventory_hostname_short\":
        \"u1404\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }\n+    }, \n+    \"groups\":
        {\n+      \"ungrouped\": [\n+        \"el6host\", \n+        \"u1404\"\n+
        \     ], \n+      \"all\": [\n+        \"el6host\", \n+        \"u1404\"\n+
        \     ]\n+    }, \n+    \"group_names\": [\n+      \"ungrouped\"\n+    ],
        \n+    \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+    \"ansible_version\": {\n+      \"major\": 2, \n+      \"full\": \"2.2.0\",
        \n+      \"string\": \"2.2.0\", \n+      \"minor\": 2, \n+      \"revision\":
        0\n+    }, \n+    \"ansible_ssh_user\": \"root\"\n+  }, \n+  \"ansible_accelerate_port\":
        5099, \n+  \"roledir\": null, \n+  \"ansible_ssh_extra_args\": \"\", \n+  \"ansible_ssh_host\":
        \"u1404\", \n+  \"ansible_current_hosts\": [\n+    \"el6host\"\n+  ], \n+
        \ \"hostvars\": {\n+    \"el6host\": {\n+      \"inventory_file\": \"inventory\",
        \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ], \n+      \"groups\":
        {\n+        \"ungrouped\": [\n+          \"el6host\", \n+          \"u1404\"\n+
        \       ], \n+        \"all\": [\n+          \"el6host\", \n+          \"u1404\"\n+
        \       ]\n+      }, \n+      \"inventory_hostname\": \"el6host\", \n+      \"inventory_hostname_short\":
        \"el6host\", \n+      \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }, \n+    \"u1404\": {\n+      \"inventory_file\":
        \"inventory\", \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ],
        \n+      \"groups\": {\n+        \"ungrouped\": [\n+          \"el6host\",
        \n+          \"u1404\"\n+        ], \n+        \"all\": [\n+          \"el6host\",
        \n+          \"u1404\"\n+        ]\n+      }, \n+      \"inventory_hostname\":
        \"u1404\", \n+      \"inventory_hostname_short\": \"u1404\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }\n+  }, \n+  \"group_names\": [\n+
        \   \"ungrouped\"\n+  ], \n+  \"ansible_version\": {\n+    \"major\": 2, \n+
        \   \"full\": \"2.2.0\", \n+    \"string\": \"2.2.0\", \n+    \"minor\": 2,
        \n+    \"revision\": 0\n+  }, \n+  \"ansible_ssh_pipelining\": false, \n+
        \ \"inventory_file\": \"inventory\", \n+  \"ansible_delegated_vars\": {\n+
        \   \"u1404\": {\n+      \"inventory_hostname\": \"u1404\", \n+      \"inventory_file\":
        \"inventory\", \n+      \"vars\": {\n+        \"ansible_check_mode\": false,
        \n+        \"inventory_hostname\": \"u1404\", \n+        \"inventory_file\":
        \"inventory\", \n+        \"inventory_hostname_short\": \"u1404\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"environment\": [], \n+        \"ansible_ssh_user\": \"root\",
        \n+        \"ansible_play_hosts\": [\n+          \"el6host\"\n+        ],
        \n+        \"groups\": {\n+          \"ungrouped\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ]\n+        }, \n+        \"group_names\":
        [\n+          \"ungrouped\"\n+        ], \n+        \"play_hosts\": [\n+          \"el6host\"\n+
        \       ], \n+        \"ansible_version\": {\n+          \"major\": 2, \n+
        \         \"full\": \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\":
        2, \n+          \"revision\": 0\n+        }, \n+        \"role_names\": []\n+
        \     }, \n+      \"inventory_hostname_short\": \"u1404\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"group_names\": [\n+
        \       \"ungrouped\"\n+      ], \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"ansible_host\": \"u1404\", \n+      \"environment\": [], \n+      \"ansible_play_hosts\":
        [\n+        \"el6host\"\n+      ], \n+      \"groups\": {\n+        \"ungrouped\":
        [\n+          \"el6host\", \n+          \"u1404\"\n+        ], \n+        \"all\":
        [\n+          \"el6host\", \n+          \"u1404\"\n+        ]\n+      }, \n+
        \     \"ansible_check_mode\": false, \n+      \"play_hosts\": [\n+        \"el6host\"\n+
        \     ], \n+      \"role_names\": [], \n+      \"ansible_port\": null, \n+
        \     \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }, \n+      \"ansible_ssh_user\": \"root\"\n+
        \   }\n+  }, \n+  \"ansible_module_compression\": \"ZIP_DEFLATED\", \n+  \"ansible_failed_hosts\":
        [], \n+  \"ansible_check_mode\": false, \n+  \"groups\": {\n+    \"ungrouped\":
        [\n+      \"el6host\", \n+      \"u1404\"\n+    ], \n+    \"all\": [\n+      \"el6host\",
        \n+      \"u1404\"\n+    ]\n+  }, \n+  \"ansible_host\": \"u1404\", \n+  \"ansible_shell_executable\":
        \"/bin/sh\", \n+  \"inventory_hostname_short\": \"el6host\", \n+  \"omit\":
        \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\", \n+  \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+  \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+  \"ansible_ssh_user\": \"root\", \n+  \"role_names\": [], \n+  \"play_hosts\":
        [\n+    \"el6host\"\n+  ], \n+  \"ansible_sftp_extra_args\": \"\"\n+}\n\\
        No newline at end of file\ndiff --git a/test/units/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/task_vars_out.json
        b/test/units/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/task_vars_out.json\nnew
        file mode 100644\nindex 0000000000000..0b551f041d412\n--- /dev/null\n+++ b/test/units/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/task_vars_out.json\n@@
        -0,0 +1,387 @@\n+{\n+  \"ansible_pipelining\": false, \n+  \"ansible_docker_extra_args\":
        \"\", \n+  \"ansible_scp_extra_args\": \"\", \n+  \"ansible_user\": \"root\",
        \n+  \"ansible_play_hosts\": [\n+    \"el6host\"\n+  ], \n+  \"ansible_connection\":
        \"smart\", \n+  \"ansible_ssh_common_args\": \"\", \n+  \"environment\": [],
        \n+  \"inventory_hostname\": \"el6host\", \n+  \"vars\": {\n+    \"ansible_check_mode\":
        false, \n+    \"inventory_hostname\": \"el6host\", \n+    \"inventory_file\":
        \"inventory\", \n+    \"ansible_delegated_vars\": {\n+      \"u1404\": {\n+
        \       \"inventory_hostname\": \"u1404\", \n+        \"inventory_file\":
        \"inventory\", \n+        \"vars\": {\n+          \"inventory_file\": \"inventory\",
        \n+          \"role_names\": [], \n+          \"ansible_play_hosts\": [\n+
        \           \"el6host\"\n+          ], \n+          \"groups\": {\n+            \"ungrouped\":
        [\n+              \"el6host\", \n+              \"u1404\"\n+            ],
        \n+            \"all\": [\n+              \"el6host\", \n+              \"u1404\"\n+
        \           ]\n+          }, \n+          \"ansible_check_mode\": false, \n+
        \         \"inventory_hostname\": \"u1404\", \n+          \"inventory_hostname_short\":
        \"u1404\", \n+          \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+          \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+          \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+          \"environment\": [], \n+          \"ansible_ssh_user\": \"root\",
        \n+          \"group_names\": [\n+            \"ungrouped\"\n+          ],
        \n+          \"play_hosts\": [\n+            \"el6host\"\n+          ], \n+
        \         \"ansible_version\": {\n+            \"major\": 2, \n+            \"full\":
        \"2.2.0\", \n+            \"string\": \"2.2.0\", \n+            \"minor\":
        2, \n+            \"revision\": 0\n+          }\n+        }, \n+        \"inventory_hostname_short\":
        \"u1404\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"group_names\": [\n+          \"ungrouped\"\n+        ], \n+        \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"ansible_host\": \"u1404\", \n+        \"environment\": [], \n+
        \       \"ansible_play_hosts\": [\n+          \"el6host\"\n+        ], \n+
        \       \"groups\": {\n+          \"ungrouped\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ]\n+        }, \n+        \"ansible_check_mode\":
        false, \n+        \"play_hosts\": [\n+          \"el6host\"\n+        ], \n+
        \       \"role_names\": [], \n+        \"ansible_port\": null, \n+        \"ansible_version\":
        {\n+          \"major\": 2, \n+          \"full\": \"2.2.0\", \n+          \"string\":
        \"2.2.0\", \n+          \"minor\": 2, \n+          \"revision\": 0\n+        },
        \n+        \"ansible_ssh_user\": \"root\"\n+      }\n+    }, \n+    \"inventory_hostname_short\":
        \"el6host\", \n+    \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+    \"role_names\": [], \n+    \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+    \"environment\": [], \n+    \"play_hosts\": [\n+      \"el6host\"\n+
        \   ], \n+    \"ansible_play_hosts\": [\n+      \"el6host\"\n+    ], \n+    \"hostvars\":
        {\n+      \"el6host\": {\n+        \"inventory_file\": \"inventory\", \n+
        \       \"group_names\": [\n+          \"ungrouped\"\n+        ], \n+        \"groups\":
        {\n+          \"ungrouped\": [\n+            \"el6host\", \n+            \"u1404\",
        \n+            \"::1\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\", \n+            \"::1\"\n+          ]\n+        },
        \n+        \"inventory_hostname\": \"el6host\", \n+        \"inventory_hostname_short\":
        \"el6host\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }, \n+      \"u1404\": {\n+
        \       \"inventory_file\": \"inventory\", \n+        \"group_names\": [\n+
        \         \"ungrouped\"\n+        ], \n+        \"groups\": {\n+          \"ungrouped\":
        [\n+            \"el6host\", \n+            \"u1404\", \n+            \"::1\"\n+
        \         ], \n+          \"all\": [\n+            \"el6host\", \n+            \"u1404\",
        \n+            \"::1\"\n+          ]\n+        }, \n+        \"inventory_hostname\":
        \"u1404\", \n+        \"inventory_hostname_short\": \"u1404\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }\n+    }, \n+    \"groups\":
        {\n+      \"ungrouped\": [\n+        \"el6host\", \n+        \"u1404\"\n+
        \     ], \n+      \"all\": [\n+        \"el6host\", \n+        \"u1404\"\n+
        \     ]\n+    }, \n+    \"group_names\": [\n+      \"ungrouped\"\n+    ],
        \n+    \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+    \"ansible_version\": {\n+      \"major\": 2, \n+      \"full\": \"2.2.0\",
        \n+      \"string\": \"2.2.0\", \n+      \"minor\": 2, \n+      \"revision\":
        0\n+    }, \n+    \"ansible_ssh_user\": \"root\"\n+  }, \n+  \"ansible_accelerate_port\":
        5099, \n+  \"roledir\": null, \n+  \"ansible_ssh_extra_args\": \"\", \n+  \"ansible_ssh_host\":
        \"u1404\", \n+  \"ansible_current_hosts\": [\n+    \"el6host\"\n+  ], \n+
        \ \"hostvars\": {\n+    \"el6host\": {\n+      \"inventory_file\": \"inventory\",
        \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ], \n+      \"groups\":
        {\n+        \"ungrouped\": [\n+          \"el6host\", \n+          \"u1404\",
        \n+          \"::1\"\n+        ], \n+        \"all\": [\n+          \"el6host\",
        \n+          \"u1404\", \n+          \"::1\"\n+        ]\n+      }, \n+      \"inventory_hostname\":
        \"el6host\", \n+      \"inventory_hostname_short\": \"el6host\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }, \n+    \"u1404\": {\n+      \"inventory_file\":
        \"inventory\", \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ],
        \n+      \"groups\": {\n+        \"ungrouped\": [\n+          \"el6host\",
        \n+          \"u1404\", \n+          \"::1\"\n+        ], \n+        \"all\":
        [\n+          \"el6host\", \n+          \"u1404\", \n+          \"::1\"\n+
        \       ]\n+      }, \n+      \"inventory_hostname\": \"u1404\", \n+      \"inventory_hostname_short\":
        \"u1404\", \n+      \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }\n+  }, \n+  \"group_names\": [\n+
        \   \"ungrouped\"\n+  ], \n+  \"ansible_version\": {\n+    \"major\": 2, \n+
        \   \"full\": \"2.2.0\", \n+    \"string\": \"2.2.0\", \n+    \"minor\": 2,
        \n+    \"revision\": 0\n+  }, \n+  \"ansible_ssh_pipelining\": false, \n+
        \ \"inventory_file\": \"inventory\", \n+  \"ansible_delegated_vars\": {\n+
        \   \"u1404\": {\n+      \"inventory_hostname\": \"u1404\", \n+      \"inventory_file\":
        \"inventory\", \n+      \"vars\": {\n+        \"ansible_check_mode\": false,
        \n+        \"inventory_hostname\": \"u1404\", \n+        \"inventory_file\":
        \"inventory\", \n+        \"inventory_hostname_short\": \"u1404\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"environment\": [], \n+        \"ansible_ssh_user\": \"root\",
        \n+        \"ansible_play_hosts\": [\n+          \"el6host\"\n+        ],
        \n+        \"groups\": {\n+          \"ungrouped\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ]\n+        }, \n+        \"group_names\":
        [\n+          \"ungrouped\"\n+        ], \n+        \"play_hosts\": [\n+          \"el6host\"\n+
        \       ], \n+        \"ansible_version\": {\n+          \"major\": 2, \n+
        \         \"full\": \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\":
        2, \n+          \"revision\": 0\n+        }, \n+        \"role_names\": []\n+
        \     }, \n+      \"inventory_hostname_short\": \"u1404\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"group_names\": [\n+
        \       \"ungrouped\"\n+      ], \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"ansible_host\": \"u1404\", \n+      \"environment\": [], \n+      \"ansible_play_hosts\":
        [\n+        \"el6host\"\n+      ], \n+      \"groups\": {\n+        \"ungrouped\":
        [\n+          \"el6host\", \n+          \"u1404\"\n+        ], \n+        \"all\":
        [\n+          \"el6host\", \n+          \"u1404\"\n+        ]\n+      }, \n+
        \     \"ansible_check_mode\": false, \n+      \"play_hosts\": [\n+        \"el6host\"\n+
        \     ], \n+      \"role_names\": [], \n+      \"ansible_port\": null, \n+
        \     \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }, \n+      \"ansible_ssh_user\": \"root\"\n+
        \   }\n+  }, \n+  \"ansible_module_compression\": \"ZIP_DEFLATED\", \n+  \"ansible_failed_hosts\":
        [], \n+  \"ansible_check_mode\": false, \n+  \"groups\": {\n+    \"ungrouped\":
        [\n+      \"el6host\", \n+      \"u1404\"\n+    ], \n+    \"all\": [\n+      \"el6host\",
        \n+      \"u1404\"\n+    ]\n+  }, \n+  \"ansible_host\": \"u1404\", \n+  \"ansible_shell_executable\":
        \"/bin/sh\", \n+  \"inventory_hostname_short\": \"el6host\", \n+  \"omit\":
        \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\", \n+  \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+  \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+  \"ansible_ssh_user\": \"root\", \n+  \"role_names\": [], \n+  \"play_hosts\":
        [\n+    \"el6host\"\n+  ], \n+  \"ansible_sftp_extra_args\": \"\"\n+}\n\\
        No newline at end of file\ndiff --git a/test/units/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/meta.yaml
        b/test/units/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/meta.yaml\nnew
        file mode 100644\nindex 0000000000000..1242b1d390c95\n--- /dev/null\n+++ b/test/units/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/meta.yaml\n@@
        -0,0 +1,29 @@\n+fixtures:\n+    taskvars_in: task_vars_in.json\n+    taskvars_out:
        task_vars_out.json\n+task_args:\n+    src: /tmp/deleteme\n+    dest: /tmp/deleteme\n+
        \   private_key: ~/.ssh/id_rsa\n+_task:\n+    delegate_to: u1404    \n+_play_context:\n+
        \   shell: None\n+    remote_addr: u1404\n+    remote_user: root\n+    private_key_file:
        ~/test.pem\n+connection:\n+    transport: 'ssh'\n+hostvars:\n+    '127.0.0.1':
        {}\n+    '::1': {}\n+    'localhost': {}\n+asserts:\n+    - \"hasattr(SAM._connection,
        'ismock')\"\n+    - \"SAM._connection.transport == 'ssh'\"\n+    - \"self._play_context.shell
        == None\"\n+    - \"self.execute_called\"\n+    - \"self.final_module_args['_local_rsync_path']
        == 'rsync'\"\n+    - \"self.final_module_args['src'] == '/tmp/deleteme'\"\n+
        \   - \"self.final_module_args['dest'] == 'root@el6host:/tmp/deleteme'\"\n+
        \   - \"self.final_module_args['private_key'] == '~/.ssh/id_rsa'\"\ndiff --git
        a/test/units/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/task_vars_in.json
        b/test/units/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/task_vars_in.json\nnew
        file mode 100644\nindex 0000000000000..b8893eef85cf8\n--- /dev/null\n+++ b/test/units/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/task_vars_in.json\n@@
        -0,0 +1,379 @@\n+{\n+  \"ansible_pipelining\": false, \n+  \"ansible_docker_extra_args\":
        \"\", \n+  \"ansible_scp_extra_args\": \"\", \n+  \"ansible_user\": \"root\",
        \n+  \"ansible_play_hosts\": [\n+    \"el6host\"\n+  ], \n+  \"ansible_connection\":
        \"smart\", \n+  \"ansible_ssh_common_args\": \"\", \n+  \"environment\": [],
        \n+  \"inventory_hostname\": \"el6host\", \n+  \"vars\": {\n+    \"ansible_check_mode\":
        false, \n+    \"inventory_hostname\": \"el6host\", \n+    \"inventory_file\":
        \"inventory\", \n+    \"ansible_delegated_vars\": {\n+      \"u1404\": {\n+
        \       \"inventory_hostname\": \"u1404\", \n+        \"inventory_file\":
        \"inventory\", \n+        \"vars\": {\n+          \"inventory_file\": \"inventory\",
        \n+          \"role_names\": [], \n+          \"ansible_play_hosts\": [\n+
        \           \"el6host\"\n+          ], \n+          \"groups\": {\n+            \"ungrouped\":
        [\n+              \"el6host\", \n+              \"u1404\"\n+            ],
        \n+            \"all\": [\n+              \"el6host\", \n+              \"u1404\"\n+
        \           ]\n+          }, \n+          \"ansible_check_mode\": false, \n+
        \         \"inventory_hostname\": \"u1404\", \n+          \"inventory_hostname_short\":
        \"u1404\", \n+          \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+          \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+          \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+          \"environment\": [], \n+          \"ansible_ssh_user\": \"root\",
        \n+          \"group_names\": [\n+            \"ungrouped\"\n+          ],
        \n+          \"play_hosts\": [\n+            \"el6host\"\n+          ], \n+
        \         \"ansible_version\": {\n+            \"major\": 2, \n+            \"full\":
        \"2.2.0\", \n+            \"string\": \"2.2.0\", \n+            \"minor\":
        2, \n+            \"revision\": 0\n+          }\n+        }, \n+        \"inventory_hostname_short\":
        \"u1404\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"group_names\": [\n+          \"ungrouped\"\n+        ], \n+        \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"ansible_host\": \"u1404\", \n+        \"environment\": [], \n+
        \       \"ansible_play_hosts\": [\n+          \"el6host\"\n+        ], \n+
        \       \"groups\": {\n+          \"ungrouped\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ]\n+        }, \n+        \"ansible_check_mode\":
        false, \n+        \"play_hosts\": [\n+          \"el6host\"\n+        ], \n+
        \       \"role_names\": [], \n+        \"ansible_port\": null, \n+        \"ansible_version\":
        {\n+          \"major\": 2, \n+          \"full\": \"2.2.0\", \n+          \"string\":
        \"2.2.0\", \n+          \"minor\": 2, \n+          \"revision\": 0\n+        },
        \n+        \"ansible_ssh_user\": \"root\"\n+      }\n+    }, \n+    \"inventory_hostname_short\":
        \"el6host\", \n+    \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+    \"role_names\": [], \n+    \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+    \"environment\": [], \n+    \"play_hosts\": [\n+      \"el6host\"\n+
        \   ], \n+    \"ansible_play_hosts\": [\n+      \"el6host\"\n+    ], \n+    \"hostvars\":
        {\n+      \"el6host\": {\n+        \"inventory_file\": \"inventory\", \n+
        \       \"group_names\": [\n+          \"ungrouped\"\n+        ], \n+        \"groups\":
        {\n+          \"ungrouped\": [\n+            \"el6host\", \n+            \"u1404\"\n+
        \         ], \n+          \"all\": [\n+            \"el6host\", \n+            \"u1404\"\n+
        \         ]\n+        }, \n+        \"inventory_hostname\": \"el6host\", \n+
        \       \"inventory_hostname_short\": \"el6host\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }, \n+      \"u1404\": {\n+
        \       \"inventory_file\": \"inventory\", \n+        \"group_names\": [\n+
        \         \"ungrouped\"\n+        ], \n+        \"groups\": {\n+          \"ungrouped\":
        [\n+            \"el6host\", \n+            \"u1404\"\n+          ], \n+          \"all\":
        [\n+            \"el6host\", \n+            \"u1404\"\n+          ]\n+        },
        \n+        \"inventory_hostname\": \"u1404\", \n+        \"inventory_hostname_short\":
        \"u1404\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }\n+    }, \n+    \"groups\":
        {\n+      \"ungrouped\": [\n+        \"el6host\", \n+        \"u1404\"\n+
        \     ], \n+      \"all\": [\n+        \"el6host\", \n+        \"u1404\"\n+
        \     ]\n+    }, \n+    \"group_names\": [\n+      \"ungrouped\"\n+    ],
        \n+    \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+    \"ansible_version\": {\n+      \"major\": 2, \n+      \"full\": \"2.2.0\",
        \n+      \"string\": \"2.2.0\", \n+      \"minor\": 2, \n+      \"revision\":
        0\n+    }, \n+    \"ansible_ssh_user\": \"root\"\n+  }, \n+  \"ansible_accelerate_port\":
        5099, \n+  \"roledir\": null, \n+  \"ansible_ssh_extra_args\": \"\", \n+  \"ansible_ssh_host\":
        \"u1404\", \n+  \"ansible_current_hosts\": [\n+    \"el6host\"\n+  ], \n+
        \ \"hostvars\": {\n+    \"el6host\": {\n+      \"inventory_file\": \"inventory\",
        \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ], \n+      \"groups\":
        {\n+        \"ungrouped\": [\n+          \"el6host\", \n+          \"u1404\"\n+
        \       ], \n+        \"all\": [\n+          \"el6host\", \n+          \"u1404\"\n+
        \       ]\n+      }, \n+      \"inventory_hostname\": \"el6host\", \n+      \"inventory_hostname_short\":
        \"el6host\", \n+      \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }, \n+    \"u1404\": {\n+      \"inventory_file\":
        \"inventory\", \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ],
        \n+      \"groups\": {\n+        \"ungrouped\": [\n+          \"el6host\",
        \n+          \"u1404\"\n+        ], \n+        \"all\": [\n+          \"el6host\",
        \n+          \"u1404\"\n+        ]\n+      }, \n+      \"inventory_hostname\":
        \"u1404\", \n+      \"inventory_hostname_short\": \"u1404\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }\n+  }, \n+  \"group_names\": [\n+
        \   \"ungrouped\"\n+  ], \n+  \"ansible_version\": {\n+    \"major\": 2, \n+
        \   \"full\": \"2.2.0\", \n+    \"string\": \"2.2.0\", \n+    \"minor\": 2,
        \n+    \"revision\": 0\n+  }, \n+  \"ansible_ssh_pipelining\": false, \n+
        \ \"inventory_file\": \"inventory\", \n+  \"ansible_delegated_vars\": {\n+
        \   \"u1404\": {\n+      \"inventory_hostname\": \"u1404\", \n+      \"inventory_file\":
        \"inventory\", \n+      \"vars\": {\n+        \"ansible_check_mode\": false,
        \n+        \"inventory_hostname\": \"u1404\", \n+        \"inventory_file\":
        \"inventory\", \n+        \"inventory_hostname_short\": \"u1404\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"environment\": [], \n+        \"ansible_ssh_user\": \"root\",
        \n+        \"ansible_play_hosts\": [\n+          \"el6host\"\n+        ],
        \n+        \"groups\": {\n+          \"ungrouped\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ]\n+        }, \n+        \"group_names\":
        [\n+          \"ungrouped\"\n+        ], \n+        \"play_hosts\": [\n+          \"el6host\"\n+
        \       ], \n+        \"ansible_version\": {\n+          \"major\": 2, \n+
        \         \"full\": \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\":
        2, \n+          \"revision\": 0\n+        }, \n+        \"role_names\": []\n+
        \     }, \n+      \"inventory_hostname_short\": \"u1404\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"group_names\": [\n+
        \       \"ungrouped\"\n+      ], \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"ansible_host\": \"u1404\", \n+      \"environment\": [], \n+      \"ansible_play_hosts\":
        [\n+        \"el6host\"\n+      ], \n+      \"groups\": {\n+        \"ungrouped\":
        [\n+          \"el6host\", \n+          \"u1404\"\n+        ], \n+        \"all\":
        [\n+          \"el6host\", \n+          \"u1404\"\n+        ]\n+      }, \n+
        \     \"ansible_check_mode\": false, \n+      \"play_hosts\": [\n+        \"el6host\"\n+
        \     ], \n+      \"role_names\": [], \n+      \"ansible_port\": null, \n+
        \     \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }, \n+      \"ansible_ssh_user\": \"root\"\n+
        \   }\n+  }, \n+  \"ansible_module_compression\": \"ZIP_DEFLATED\", \n+  \"ansible_failed_hosts\":
        [], \n+  \"ansible_check_mode\": false, \n+  \"groups\": {\n+    \"ungrouped\":
        [\n+      \"el6host\", \n+      \"u1404\"\n+    ], \n+    \"all\": [\n+      \"el6host\",
        \n+      \"u1404\"\n+    ]\n+  }, \n+  \"ansible_host\": \"u1404\", \n+  \"ansible_shell_executable\":
        \"/bin/sh\", \n+  \"inventory_hostname_short\": \"el6host\", \n+  \"omit\":
        \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\", \n+  \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+  \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+  \"ansible_ssh_user\": \"root\", \n+  \"role_names\": [], \n+  \"play_hosts\":
        [\n+    \"el6host\"\n+  ], \n+  \"ansible_sftp_extra_args\": \"\"\n+}\n\\
        No newline at end of file\ndiff --git a/test/units/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/task_vars_out.json
        b/test/units/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/task_vars_out.json\nnew
        file mode 100644\nindex 0000000000000..0b551f041d412\n--- /dev/null\n+++ b/test/units/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/task_vars_out.json\n@@
        -0,0 +1,387 @@\n+{\n+  \"ansible_pipelining\": false, \n+  \"ansible_docker_extra_args\":
        \"\", \n+  \"ansible_scp_extra_args\": \"\", \n+  \"ansible_user\": \"root\",
        \n+  \"ansible_play_hosts\": [\n+    \"el6host\"\n+  ], \n+  \"ansible_connection\":
        \"smart\", \n+  \"ansible_ssh_common_args\": \"\", \n+  \"environment\": [],
        \n+  \"inventory_hostname\": \"el6host\", \n+  \"vars\": {\n+    \"ansible_check_mode\":
        false, \n+    \"inventory_hostname\": \"el6host\", \n+    \"inventory_file\":
        \"inventory\", \n+    \"ansible_delegated_vars\": {\n+      \"u1404\": {\n+
        \       \"inventory_hostname\": \"u1404\", \n+        \"inventory_file\":
        \"inventory\", \n+        \"vars\": {\n+          \"inventory_file\": \"inventory\",
        \n+          \"role_names\": [], \n+          \"ansible_play_hosts\": [\n+
        \           \"el6host\"\n+          ], \n+          \"groups\": {\n+            \"ungrouped\":
        [\n+              \"el6host\", \n+              \"u1404\"\n+            ],
        \n+            \"all\": [\n+              \"el6host\", \n+              \"u1404\"\n+
        \           ]\n+          }, \n+          \"ansible_check_mode\": false, \n+
        \         \"inventory_hostname\": \"u1404\", \n+          \"inventory_hostname_short\":
        \"u1404\", \n+          \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+          \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+          \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+          \"environment\": [], \n+          \"ansible_ssh_user\": \"root\",
        \n+          \"group_names\": [\n+            \"ungrouped\"\n+          ],
        \n+          \"play_hosts\": [\n+            \"el6host\"\n+          ], \n+
        \         \"ansible_version\": {\n+            \"major\": 2, \n+            \"full\":
        \"2.2.0\", \n+            \"string\": \"2.2.0\", \n+            \"minor\":
        2, \n+            \"revision\": 0\n+          }\n+        }, \n+        \"inventory_hostname_short\":
        \"u1404\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"group_names\": [\n+          \"ungrouped\"\n+        ], \n+        \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"ansible_host\": \"u1404\", \n+        \"environment\": [], \n+
        \       \"ansible_play_hosts\": [\n+          \"el6host\"\n+        ], \n+
        \       \"groups\": {\n+          \"ungrouped\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ]\n+        }, \n+        \"ansible_check_mode\":
        false, \n+        \"play_hosts\": [\n+          \"el6host\"\n+        ], \n+
        \       \"role_names\": [], \n+        \"ansible_port\": null, \n+        \"ansible_version\":
        {\n+          \"major\": 2, \n+          \"full\": \"2.2.0\", \n+          \"string\":
        \"2.2.0\", \n+          \"minor\": 2, \n+          \"revision\": 0\n+        },
        \n+        \"ansible_ssh_user\": \"root\"\n+      }\n+    }, \n+    \"inventory_hostname_short\":
        \"el6host\", \n+    \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+    \"role_names\": [], \n+    \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+    \"environment\": [], \n+    \"play_hosts\": [\n+      \"el6host\"\n+
        \   ], \n+    \"ansible_play_hosts\": [\n+      \"el6host\"\n+    ], \n+    \"hostvars\":
        {\n+      \"el6host\": {\n+        \"inventory_file\": \"inventory\", \n+
        \       \"group_names\": [\n+          \"ungrouped\"\n+        ], \n+        \"groups\":
        {\n+          \"ungrouped\": [\n+            \"el6host\", \n+            \"u1404\",
        \n+            \"::1\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\", \n+            \"::1\"\n+          ]\n+        },
        \n+        \"inventory_hostname\": \"el6host\", \n+        \"inventory_hostname_short\":
        \"el6host\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }, \n+      \"u1404\": {\n+
        \       \"inventory_file\": \"inventory\", \n+        \"group_names\": [\n+
        \         \"ungrouped\"\n+        ], \n+        \"groups\": {\n+          \"ungrouped\":
        [\n+            \"el6host\", \n+            \"u1404\", \n+            \"::1\"\n+
        \         ], \n+          \"all\": [\n+            \"el6host\", \n+            \"u1404\",
        \n+            \"::1\"\n+          ]\n+        }, \n+        \"inventory_hostname\":
        \"u1404\", \n+        \"inventory_hostname_short\": \"u1404\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }\n+    }, \n+    \"groups\":
        {\n+      \"ungrouped\": [\n+        \"el6host\", \n+        \"u1404\"\n+
        \     ], \n+      \"all\": [\n+        \"el6host\", \n+        \"u1404\"\n+
        \     ]\n+    }, \n+    \"group_names\": [\n+      \"ungrouped\"\n+    ],
        \n+    \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+    \"ansible_version\": {\n+      \"major\": 2, \n+      \"full\": \"2.2.0\",
        \n+      \"string\": \"2.2.0\", \n+      \"minor\": 2, \n+      \"revision\":
        0\n+    }, \n+    \"ansible_ssh_user\": \"root\"\n+  }, \n+  \"ansible_accelerate_port\":
        5099, \n+  \"roledir\": null, \n+  \"ansible_ssh_extra_args\": \"\", \n+  \"ansible_ssh_host\":
        \"u1404\", \n+  \"ansible_current_hosts\": [\n+    \"el6host\"\n+  ], \n+
        \ \"hostvars\": {\n+    \"el6host\": {\n+      \"inventory_file\": \"inventory\",
        \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ], \n+      \"groups\":
        {\n+        \"ungrouped\": [\n+          \"el6host\", \n+          \"u1404\",
        \n+          \"::1\"\n+        ], \n+        \"all\": [\n+          \"el6host\",
        \n+          \"u1404\", \n+          \"::1\"\n+        ]\n+      }, \n+      \"inventory_hostname\":
        \"el6host\", \n+      \"inventory_hostname_short\": \"el6host\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }, \n+    \"u1404\": {\n+      \"inventory_file\":
        \"inventory\", \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ],
        \n+      \"groups\": {\n+        \"ungrouped\": [\n+          \"el6host\",
        \n+          \"u1404\", \n+          \"::1\"\n+        ], \n+        \"all\":
        [\n+          \"el6host\", \n+          \"u1404\", \n+          \"::1\"\n+
        \       ]\n+      }, \n+      \"inventory_hostname\": \"u1404\", \n+      \"inventory_hostname_short\":
        \"u1404\", \n+      \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }\n+  }, \n+  \"group_names\": [\n+
        \   \"ungrouped\"\n+  ], \n+  \"ansible_version\": {\n+    \"major\": 2, \n+
        \   \"full\": \"2.2.0\", \n+    \"string\": \"2.2.0\", \n+    \"minor\": 2,
        \n+    \"revision\": 0\n+  }, \n+  \"ansible_ssh_pipelining\": false, \n+
        \ \"inventory_file\": \"inventory\", \n+  \"ansible_delegated_vars\": {\n+
        \   \"u1404\": {\n+      \"inventory_hostname\": \"u1404\", \n+      \"inventory_file\":
        \"inventory\", \n+      \"vars\": {\n+        \"ansible_check_mode\": false,
        \n+        \"inventory_hostname\": \"u1404\", \n+        \"inventory_file\":
        \"inventory\", \n+        \"inventory_hostname_short\": \"u1404\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"environment\": [], \n+        \"ansible_ssh_user\": \"root\",
        \n+        \"ansible_play_hosts\": [\n+          \"el6host\"\n+        ],
        \n+        \"groups\": {\n+          \"ungrouped\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ]\n+        }, \n+        \"group_names\":
        [\n+          \"ungrouped\"\n+        ], \n+        \"play_hosts\": [\n+          \"el6host\"\n+
        \       ], \n+        \"ansible_version\": {\n+          \"major\": 2, \n+
        \         \"full\": \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\":
        2, \n+          \"revision\": 0\n+        }, \n+        \"role_names\": []\n+
        \     }, \n+      \"inventory_hostname_short\": \"u1404\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"group_names\": [\n+
        \       \"ungrouped\"\n+      ], \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"ansible_host\": \"u1404\", \n+      \"environment\": [], \n+      \"ansible_play_hosts\":
        [\n+        \"el6host\"\n+      ], \n+      \"groups\": {\n+        \"ungrouped\":
        [\n+          \"el6host\", \n+          \"u1404\"\n+        ], \n+        \"all\":
        [\n+          \"el6host\", \n+          \"u1404\"\n+        ]\n+      }, \n+
        \     \"ansible_check_mode\": false, \n+      \"play_hosts\": [\n+        \"el6host\"\n+
        \     ], \n+      \"role_names\": [], \n+      \"ansible_port\": null, \n+
        \     \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }, \n+      \"ansible_ssh_user\": \"root\"\n+
        \   }\n+  }, \n+  \"ansible_module_compression\": \"ZIP_DEFLATED\", \n+  \"ansible_failed_hosts\":
        [], \n+  \"ansible_check_mode\": false, \n+  \"groups\": {\n+    \"ungrouped\":
        [\n+      \"el6host\", \n+      \"u1404\"\n+    ], \n+    \"all\": [\n+      \"el6host\",
        \n+      \"u1404\"\n+    ]\n+  }, \n+  \"ansible_host\": \"u1404\", \n+  \"ansible_shell_executable\":
        \"/bin/sh\", \n+  \"inventory_hostname_short\": \"el6host\", \n+  \"omit\":
        \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\", \n+  \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+  \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+  \"ansible_ssh_user\": \"root\", \n+  \"role_names\": [], \n+  \"play_hosts\":
        [\n+    \"el6host\"\n+  ], \n+  \"ansible_sftp_extra_args\": \"\"\n+}\n\\
        No newline at end of file\ndiff --git a/test/units/plugins/action/test_synchronize.py
        b/test/units/plugins/action/test_synchronize.py\nindex 7d40f7b70e299..f83443377eefb
        100644\n--- a/test/units/plugins/action/test_synchronize.py\n+++ b/test/units/plugins/action/test_synchronize.py\n@@
        -251,6 +251,23 @@ def test_delegate_remote_su(self):\n         x = SynchronizeTester()\n
        \        x.runtest(fixturepath=os.path.join(self.fixturedir, 'delegate_remote_su'))\n
        \n+    @patch('ansible.plugins.action.synchronize.connection_loader', FakePluginLoader)\n+
        \   def test_basic_with_private_key(self):\n+        x = SynchronizeTester()\n+
        \       x.runtest(fixturepath=os.path.join(self.fixturedir, 'basic_with_private_key'))\n+\n+
        \   @patch('ansible.plugins.action.synchronize.connection_loader', FakePluginLoader)\n+
        \   def test_delegate_remote_with_private_key(self):\n+        # delegate
        to other remote host and use the module param private_key\n+        x = SynchronizeTester()\n+
        \       x.runtest(fixturepath=os.path.join(self.fixturedir, 'delegate_remote_with_private_key'))\n+\n+
        \   @patch('ansible.plugins.action.synchronize.connection_loader', FakePluginLoader)\n+
        \   def test_delegate_remote_play_context_private_key(self):\n+        # delegate
        to other remote host and use the play context private_key\n+        x = SynchronizeTester()\n+
        \       x.runtest(fixturepath=os.path.join(self.fixturedir, 'delegate_remote_play_context_private_key'))\n+\n
        \    @patch.object(ActionModule, '_low_level_execute_command', side_effect=BreakPoint)\n
        \    @patch.object(ActionModule, '_remote_expand_user', side_effect=ActionModule._remote_expand_user,
        autospec=True)\n     def test_remote_user_not_in_local_tmpdir(self, spy_remote_expand_user,
        ll_ec):\n"
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Content-Encoding:
      - gzip
      Content-Security-Policy:
      - 'default-src ''none''; base-uri ''self''; block-all-mixed-content; connect-src
        ''self'' uploads.github.com www.githubstatus.com collector.githubapp.com api.github.com
        github-cloud.s3.amazonaws.com github-production-repository-file-5c1aeb.s3.amazonaws.com
        github-production-upload-manifest-file-7fdce7.s3.amazonaws.com github-production-user-asset-6210df.s3.amazonaws.com
        cdn.optimizely.com logx.optimizely.com/v1/events wss://alive.github.com; font-src
        github.githubassets.com; form-action ''self'' github.com gist.github.com;
        frame-ancestors ''none''; frame-src render.githubusercontent.com; img-src
        ''self'' data: github.githubassets.com identicons.github.com collector.githubapp.com
        github-cloud.s3.amazonaws.com user-images.githubusercontent.com/ *.githubusercontent.com;
        manifest-src ''self''; media-src ''none''; script-src github.githubassets.com;
        style-src ''unsafe-inline'' github.githubassets.com; worker-src github.com/socket-worker-5029ae85.js
        gist.github.com/socket-worker-5029ae85.js'
      Content-Type:
      - text/plain; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:42 GMT
      Etag:
      - W/"e2ae899a04cb834ca4ae7b9ef1689ade"
      Expect-CT:
      - max-age=2592000, report-uri="https://api.github.com/_private/browser/errors"
      Referrer-Policy:
      - origin-when-cross-origin, strict-origin-when-cross-origin
      Server:
      - GitHub.com
      Set-Cookie:
      - logged_in=no; domain=.github.com; path=/; expires=Sun, 27 Feb 2022 07:10:42
        GMT; secure; HttpOnly; SameSite=Lax
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - X-PJAX
      - Accept-Encoding, Accept, X-Requested-With
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Request-Id:
      - D35C:1A52:95E379:B71ABC:6039F072
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
    url: https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73556.diff
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Cookie:
      - logged_in=no
    method: GET
    uri: https://api.github.com/search/commits?per_page=100&q=hash:4b0b50439d3b7fd232291795ca0deec36e4b59de+org:ansible+org:ansible-collections+is:public
  response:
    body:
      string: '{"total_count":1,"incomplete_results":false,"items":[{"url":"https://api.github.com/repos/ansible-collections/ansible.posix/commits/4b0b50439d3b7fd232291795ca0deec36e4b59de","sha":"4b0b50439d3b7fd232291795ca0deec36e4b59de","node_id":"MDY6Q29tbWl0MjQ0Njc4MTQyOjRiMGI1MDQzOWQzYjdmZDIzMjI5MTc5NWNhMGRlZWMzNmU0YjU5ZGU=","html_url":"https://github.com/ansible-collections/ansible.posix/commit/4b0b50439d3b7fd232291795ca0deec36e4b59de","comments_url":"https://api.github.com/repos/ansible-collections/ansible.posix/commits/4b0b50439d3b7fd232291795ca0deec36e4b59de/comments","commit":{"url":"https://api.github.com/repos/ansible-collections/ansible.posix/git/commits/4b0b50439d3b7fd232291795ca0deec36e4b59de","author":{"date":"2020-08-15T08:16:54.000-04:00","name":"vishwas","email":"bmvishwas@gmail.com"},"committer":{"date":"2020-09-04T04:16:43.000-04:00","name":"vishwas","email":"bmvishwas@gmail.com"},"message":"Fix
        for private_key overriding in synchronize module","tree":{"url":"https://api.github.com/repos/ansible-collections/ansible.posix/git/trees/72a586dca646489f2a56348b848bfe38ad27dbf5","sha":"72a586dca646489f2a56348b848bfe38ad27dbf5"},"comment_count":0},"author":{"login":"bmv126","id":20056956,"node_id":"MDQ6VXNlcjIwMDU2OTU2","avatar_url":"https://avatars.githubusercontent.com/u/20056956?v=4","gravatar_id":"","url":"https://api.github.com/users/bmv126","html_url":"https://github.com/bmv126","followers_url":"https://api.github.com/users/bmv126/followers","following_url":"https://api.github.com/users/bmv126/following{/other_user}","gists_url":"https://api.github.com/users/bmv126/gists{/gist_id}","starred_url":"https://api.github.com/users/bmv126/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmv126/subscriptions","organizations_url":"https://api.github.com/users/bmv126/orgs","repos_url":"https://api.github.com/users/bmv126/repos","events_url":"https://api.github.com/users/bmv126/events{/privacy}","received_events_url":"https://api.github.com/users/bmv126/received_events","type":"User","site_admin":false},"committer":{"login":"bmv126","id":20056956,"node_id":"MDQ6VXNlcjIwMDU2OTU2","avatar_url":"https://avatars.githubusercontent.com/u/20056956?v=4","gravatar_id":"","url":"https://api.github.com/users/bmv126","html_url":"https://github.com/bmv126","followers_url":"https://api.github.com/users/bmv126/followers","following_url":"https://api.github.com/users/bmv126/following{/other_user}","gists_url":"https://api.github.com/users/bmv126/gists{/gist_id}","starred_url":"https://api.github.com/users/bmv126/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmv126/subscriptions","organizations_url":"https://api.github.com/users/bmv126/orgs","repos_url":"https://api.github.com/users/bmv126/repos","events_url":"https://api.github.com/users/bmv126/events{/privacy}","received_events_url":"https://api.github.com/users/bmv126/received_events","type":"User","site_admin":false},"parents":[{"url":"https://api.github.com/repos/ansible-collections/ansible.posix/commits/06efaeb108775ec339cdb9eee56a3b34b0ffd076","html_url":"https://github.com/ansible-collections/ansible.posix/commit/06efaeb108775ec339cdb9eee56a3b34b0ffd076","sha":"06efaeb108775ec339cdb9eee56a3b34b0ffd076"}],"repository":{"id":244678142,"node_id":"MDEwOlJlcG9zaXRvcnkyNDQ2NzgxNDI=","name":"ansible.posix","full_name":"ansible-collections/ansible.posix","private":false,"owner":{"login":"ansible-collections","id":44586252,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ0NTg2MjUy","avatar_url":"https://avatars.githubusercontent.com/u/44586252?v=4","gravatar_id":"","url":"https://api.github.com/users/ansible-collections","html_url":"https://github.com/ansible-collections","followers_url":"https://api.github.com/users/ansible-collections/followers","following_url":"https://api.github.com/users/ansible-collections/following{/other_user}","gists_url":"https://api.github.com/users/ansible-collections/gists{/gist_id}","starred_url":"https://api.github.com/users/ansible-collections/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ansible-collections/subscriptions","organizations_url":"https://api.github.com/users/ansible-collections/orgs","repos_url":"https://api.github.com/users/ansible-collections/repos","events_url":"https://api.github.com/users/ansible-collections/events{/privacy}","received_events_url":"https://api.github.com/users/ansible-collections/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/ansible-collections/ansible.posix","description":"Ansible
        Collection for Posix","fork":false,"url":"https://api.github.com/repos/ansible-collections/ansible.posix","forks_url":"https://api.github.com/repos/ansible-collections/ansible.posix/forks","keys_url":"https://api.github.com/repos/ansible-collections/ansible.posix/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ansible-collections/ansible.posix/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ansible-collections/ansible.posix/teams","hooks_url":"https://api.github.com/repos/ansible-collections/ansible.posix/hooks","issue_events_url":"https://api.github.com/repos/ansible-collections/ansible.posix/issues/events{/number}","events_url":"https://api.github.com/repos/ansible-collections/ansible.posix/events","assignees_url":"https://api.github.com/repos/ansible-collections/ansible.posix/assignees{/user}","branches_url":"https://api.github.com/repos/ansible-collections/ansible.posix/branches{/branch}","tags_url":"https://api.github.com/repos/ansible-collections/ansible.posix/tags","blobs_url":"https://api.github.com/repos/ansible-collections/ansible.posix/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ansible-collections/ansible.posix/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ansible-collections/ansible.posix/git/refs{/sha}","trees_url":"https://api.github.com/repos/ansible-collections/ansible.posix/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ansible-collections/ansible.posix/statuses/{sha}","languages_url":"https://api.github.com/repos/ansible-collections/ansible.posix/languages","stargazers_url":"https://api.github.com/repos/ansible-collections/ansible.posix/stargazers","contributors_url":"https://api.github.com/repos/ansible-collections/ansible.posix/contributors","subscribers_url":"https://api.github.com/repos/ansible-collections/ansible.posix/subscribers","subscription_url":"https://api.github.com/repos/ansible-collections/ansible.posix/subscription","commits_url":"https://api.github.com/repos/ansible-collections/ansible.posix/commits{/sha}","git_commits_url":"https://api.github.com/repos/ansible-collections/ansible.posix/git/commits{/sha}","comments_url":"https://api.github.com/repos/ansible-collections/ansible.posix/comments{/number}","issue_comment_url":"https://api.github.com/repos/ansible-collections/ansible.posix/issues/comments{/number}","contents_url":"https://api.github.com/repos/ansible-collections/ansible.posix/contents/{+path}","compare_url":"https://api.github.com/repos/ansible-collections/ansible.posix/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ansible-collections/ansible.posix/merges","archive_url":"https://api.github.com/repos/ansible-collections/ansible.posix/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ansible-collections/ansible.posix/downloads","issues_url":"https://api.github.com/repos/ansible-collections/ansible.posix/issues{/number}","pulls_url":"https://api.github.com/repos/ansible-collections/ansible.posix/pulls{/number}","milestones_url":"https://api.github.com/repos/ansible-collections/ansible.posix/milestones{/number}","notifications_url":"https://api.github.com/repos/ansible-collections/ansible.posix/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ansible-collections/ansible.posix/labels{/name}","releases_url":"https://api.github.com/repos/ansible-collections/ansible.posix/releases{/id}","deployments_url":"https://api.github.com/repos/ansible-collections/ansible.posix/deployments"},"score":1.0}]}'
    headers:
      Access-Control-Allow-Origin:
      - '*'
      Access-Control-Expose-Headers:
      - ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining,
        X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes,
        X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset
      Cache-Control:
      - no-cache
      Content-Encoding:
      - gzip
      Content-Security-Policy:
      - default-src 'none'
      Content-Type:
      - application/json; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:42 GMT
      Referrer-Policy:
      - origin-when-cross-origin, strict-origin-when-cross-origin
      Server:
      - GitHub.com
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - Accept, Authorization, Cookie, X-GitHub-OTP
      - Accept-Encoding, Accept, X-Requested-With
      X-Accepted-OAuth-Scopes:
      - ''
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Media-Type:
      - github.cloak-preview, github.groot-preview; format=json
      X-GitHub-Request-Id:
      - AAC0:74C8:2953C:1A85B7:6039F072
      X-OAuth-Scopes:
      - repo, workflow
      X-RateLimit-Limit:
      - '30'
      X-RateLimit-Remaining:
      - '27'
      X-RateLimit-Reset:
      - '1614409897'
      X-XSS-Protection:
      - 1; mode=block
      x-ratelimit-used:
      - '3'
    status:
      code: 200
      message: OK
    url: https://api.github.com/search/commits?per_page=100&q=hash:4b0b50439d3b7fd232291795ca0deec36e4b59de+org:ansible+org:ansible-collections+is:public
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Cookie:
      - logged_in=no
    method: GET
    uri: https://api.github.com/repos/ansible-collections/ansible.posix/commits/4b0b50439d3b7fd232291795ca0deec36e4b59de/pulls?per_page=100
  response:
    body:
      string: '[{"url":"https://api.github.com/repos/ansible-collections/ansible.posix/pulls/82","id":468300739,"node_id":"MDExOlB1bGxSZXF1ZXN0NDY4MzAwNzM5","html_url":"https://github.com/ansible-collections/ansible.posix/pull/82","diff_url":"https://github.com/ansible-collections/ansible.posix/pull/82.diff","patch_url":"https://github.com/ansible-collections/ansible.posix/pull/82.patch","issue_url":"https://api.github.com/repos/ansible-collections/ansible.posix/issues/82","number":82,"state":"closed","locked":false,"title":"Fix
        for private_key overriding in synchronize module","user":{"login":"bmv126","id":20056956,"node_id":"MDQ6VXNlcjIwMDU2OTU2","avatar_url":"https://avatars.githubusercontent.com/u/20056956?v=4","gravatar_id":"","url":"https://api.github.com/users/bmv126","html_url":"https://github.com/bmv126","followers_url":"https://api.github.com/users/bmv126/followers","following_url":"https://api.github.com/users/bmv126/following{/other_user}","gists_url":"https://api.github.com/users/bmv126/gists{/gist_id}","starred_url":"https://api.github.com/users/bmv126/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmv126/subscriptions","organizations_url":"https://api.github.com/users/bmv126/orgs","repos_url":"https://api.github.com/users/bmv126/repos","events_url":"https://api.github.com/users/bmv126/events{/privacy}","received_events_url":"https://api.github.com/users/bmv126/received_events","type":"User","site_admin":false},"body":"#####
        SUMMARY\r\nThe private_key parameter of synchronize module task gets overridden
        by the playbook --private-key variable path.\r\nThis PR is used to fix this.
        \r\n\r\n<!--- HINT: Include \"Fixes #nnn\" if you are fixing an existing issue
        -->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest -->\r\n-
        Bugfix Pull Request\r\n\r\n##### COMPONENT NAME\r\nsynchronize\r\n\r\n#####
        ADDITIONAL INFORMATION\r\n<!--- Include additional information to help people
        understand the change here -->\r\n<!--- A step-by-step reproduction of the
        problem is helpful if there is no related issue -->\r\n\r\n<!--- Paste verbatim
        command output below, e.g. before and after your change -->\r\n##### Playbook
        content\r\n```\r\ncat play.yml\r\n- hosts: agents\r\n  remote_user: vbm\r\n  tasks:\r\n    -
        name: Fetching the /etc/hosts from manager to agent nodes\r\n      synchronize:\r\n        src:  \"/etc/hosts\"\r\n        dest:
        \"/home/vbm/\"\r\n        private_key: \"/home/vbm/test.pem\"\r\n      delegate_to:
        \"{{item}}\"\r\n      with_items: \"{{groups[''manager'']}}\"\r\n```\r\n#####
        Playbook invocation command\r\n```\r\nansible-playbook --private-key=/home/vbm/access.pem
        -i inventory play.yml -vvv\r\n```\r\n##### Error message:\r\n```\t  \r\nfailed:
        [10.75.180.184 -> 10.75.180.139] (item=10.75.180.139) => {\r\n    \"ansible_loop_var\":
        \"item\",\r\n    \"changed\": false,\r\n    \"cmd\": \"/usr/bin/rsync --delay-updates
        -F --compress --archive --rsh=/usr/bin/ssh -S none -i /home/vbm/access.pem
        -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null --out-format=<<CHANGED>>%i
        %n%L /etc/hosts vbm@10.75.180.184:/home/vbm/\",\r\n    \"invocation\": {\r\n        \"module_args\":
        {\r\n            \"_local_rsync_password\": null,\r\n            ...\r\n            \"perms\":
        null,\r\n            \"private_key\": \"/home/vbm/access.pem\",\r\n            ...\r\n            \"src\":
        \"/etc/hosts\",\r\n            \"ssh_args\": null,\r\n            ...\r\n        }\r\n    },\r\n    \"item\":
        \"10.75.180.139\",\r\n    \"msg\": \"Warning: Identity file /home/vbm/access.pem
        not accessible: No such file or directory.\\nWarning: Permanently added ''10.75.180.184''
        (ECDSA) to the list of known hosts.\\r\\n\\\\S\\nKernel \\\\r on an \\\\m\\nPermission
        denied (publickey,gssapi-keyex,gssapi-with-mic).\\r\\nrsync: connection unexpectedly
        closed (0 bytes received so far) [sender]\\nrsync error: error in rsync protocol
        data stream (code 12) at io.c(226) [sender=3.1.2]\\n\",\r\n    \"rc\": 12\r\n}\r\n```\r\n\r\n####
        Expectation:\r\n##### The private_key parameter in the module_args should
        have been `/home/vbm/test.pem` instead of `/home/vbm/access.pem`","created_at":"2020-08-15T12:28:39Z","updated_at":"2020-09-18T05:24:12Z","closed_at":"2020-09-18T05:24:12Z","merged_at":"2020-09-18T05:24:12Z","merge_commit_sha":"d1fff45191e12f9cacefc9f6ed54359960c49ebe","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":2130308405,"node_id":"MDU6TGFiZWwyMTMwMzA4NDA1","url":"https://api.github.com/repos/ansible-collections/ansible.posix/labels/gate","name":"gate","color":"41B6E6","default":false,"description":"Gate
        PR in Zuul CI"}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/ansible-collections/ansible.posix/pulls/82/commits","review_comments_url":"https://api.github.com/repos/ansible-collections/ansible.posix/pulls/82/comments","review_comment_url":"https://api.github.com/repos/ansible-collections/ansible.posix/pulls/comments{/number}","comments_url":"https://api.github.com/repos/ansible-collections/ansible.posix/issues/82/comments","statuses_url":"https://api.github.com/repos/ansible-collections/ansible.posix/statuses/4b0b50439d3b7fd232291795ca0deec36e4b59de","head":{"label":"bmv126:synchronize_private_key_issue","ref":"synchronize_private_key_issue","sha":"4b0b50439d3b7fd232291795ca0deec36e4b59de","user":{"login":"bmv126","id":20056956,"node_id":"MDQ6VXNlcjIwMDU2OTU2","avatar_url":"https://avatars.githubusercontent.com/u/20056956?v=4","gravatar_id":"","url":"https://api.github.com/users/bmv126","html_url":"https://github.com/bmv126","followers_url":"https://api.github.com/users/bmv126/followers","following_url":"https://api.github.com/users/bmv126/following{/other_user}","gists_url":"https://api.github.com/users/bmv126/gists{/gist_id}","starred_url":"https://api.github.com/users/bmv126/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmv126/subscriptions","organizations_url":"https://api.github.com/users/bmv126/orgs","repos_url":"https://api.github.com/users/bmv126/repos","events_url":"https://api.github.com/users/bmv126/events{/privacy}","received_events_url":"https://api.github.com/users/bmv126/received_events","type":"User","site_admin":false},"repo":{"id":287728517,"node_id":"MDEwOlJlcG9zaXRvcnkyODc3Mjg1MTc=","name":"ansible.posix","full_name":"bmv126/ansible.posix","private":false,"owner":{"login":"bmv126","id":20056956,"node_id":"MDQ6VXNlcjIwMDU2OTU2","avatar_url":"https://avatars.githubusercontent.com/u/20056956?v=4","gravatar_id":"","url":"https://api.github.com/users/bmv126","html_url":"https://github.com/bmv126","followers_url":"https://api.github.com/users/bmv126/followers","following_url":"https://api.github.com/users/bmv126/following{/other_user}","gists_url":"https://api.github.com/users/bmv126/gists{/gist_id}","starred_url":"https://api.github.com/users/bmv126/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmv126/subscriptions","organizations_url":"https://api.github.com/users/bmv126/orgs","repos_url":"https://api.github.com/users/bmv126/repos","events_url":"https://api.github.com/users/bmv126/events{/privacy}","received_events_url":"https://api.github.com/users/bmv126/received_events","type":"User","site_admin":false},"html_url":"https://github.com/bmv126/ansible.posix","description":"Ansible
        Collection for Posix","fork":true,"url":"https://api.github.com/repos/bmv126/ansible.posix","forks_url":"https://api.github.com/repos/bmv126/ansible.posix/forks","keys_url":"https://api.github.com/repos/bmv126/ansible.posix/keys{/key_id}","collaborators_url":"https://api.github.com/repos/bmv126/ansible.posix/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/bmv126/ansible.posix/teams","hooks_url":"https://api.github.com/repos/bmv126/ansible.posix/hooks","issue_events_url":"https://api.github.com/repos/bmv126/ansible.posix/issues/events{/number}","events_url":"https://api.github.com/repos/bmv126/ansible.posix/events","assignees_url":"https://api.github.com/repos/bmv126/ansible.posix/assignees{/user}","branches_url":"https://api.github.com/repos/bmv126/ansible.posix/branches{/branch}","tags_url":"https://api.github.com/repos/bmv126/ansible.posix/tags","blobs_url":"https://api.github.com/repos/bmv126/ansible.posix/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/bmv126/ansible.posix/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/bmv126/ansible.posix/git/refs{/sha}","trees_url":"https://api.github.com/repos/bmv126/ansible.posix/git/trees{/sha}","statuses_url":"https://api.github.com/repos/bmv126/ansible.posix/statuses/{sha}","languages_url":"https://api.github.com/repos/bmv126/ansible.posix/languages","stargazers_url":"https://api.github.com/repos/bmv126/ansible.posix/stargazers","contributors_url":"https://api.github.com/repos/bmv126/ansible.posix/contributors","subscribers_url":"https://api.github.com/repos/bmv126/ansible.posix/subscribers","subscription_url":"https://api.github.com/repos/bmv126/ansible.posix/subscription","commits_url":"https://api.github.com/repos/bmv126/ansible.posix/commits{/sha}","git_commits_url":"https://api.github.com/repos/bmv126/ansible.posix/git/commits{/sha}","comments_url":"https://api.github.com/repos/bmv126/ansible.posix/comments{/number}","issue_comment_url":"https://api.github.com/repos/bmv126/ansible.posix/issues/comments{/number}","contents_url":"https://api.github.com/repos/bmv126/ansible.posix/contents/{+path}","compare_url":"https://api.github.com/repos/bmv126/ansible.posix/compare/{base}...{head}","merges_url":"https://api.github.com/repos/bmv126/ansible.posix/merges","archive_url":"https://api.github.com/repos/bmv126/ansible.posix/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/bmv126/ansible.posix/downloads","issues_url":"https://api.github.com/repos/bmv126/ansible.posix/issues{/number}","pulls_url":"https://api.github.com/repos/bmv126/ansible.posix/pulls{/number}","milestones_url":"https://api.github.com/repos/bmv126/ansible.posix/milestones{/number}","notifications_url":"https://api.github.com/repos/bmv126/ansible.posix/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/bmv126/ansible.posix/labels{/name}","releases_url":"https://api.github.com/repos/bmv126/ansible.posix/releases{/id}","deployments_url":"https://api.github.com/repos/bmv126/ansible.posix/deployments","created_at":"2020-08-15T10:52:35Z","updated_at":"2020-08-15T10:52:36Z","pushed_at":"2020-09-04T08:22:38Z","git_url":"git://github.com/bmv126/ansible.posix.git","ssh_url":"git@github.com:bmv126/ansible.posix.git","clone_url":"https://github.com/bmv126/ansible.posix.git","svn_url":"https://github.com/bmv126/ansible.posix","homepage":"","size":257,"stargazers_count":0,"watchers_count":0,"language":null,"has_issues":false,"has_projects":true,"has_downloads":false,"has_wiki":false,"has_pages":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"gpl-3.0","name":"GNU
        General Public License v3.0","spdx_id":"GPL-3.0","url":"https://api.github.com/licenses/gpl-3.0","node_id":"MDc6TGljZW5zZTk="},"forks":0,"open_issues":0,"watchers":0,"default_branch":"main"}},"base":{"label":"ansible-collections:main","ref":"main","sha":"0177b87cbcc5fb3b0318a4996e68be8c8ba6b642","user":{"login":"ansible-collections","id":44586252,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ0NTg2MjUy","avatar_url":"https://avatars.githubusercontent.com/u/44586252?v=4","gravatar_id":"","url":"https://api.github.com/users/ansible-collections","html_url":"https://github.com/ansible-collections","followers_url":"https://api.github.com/users/ansible-collections/followers","following_url":"https://api.github.com/users/ansible-collections/following{/other_user}","gists_url":"https://api.github.com/users/ansible-collections/gists{/gist_id}","starred_url":"https://api.github.com/users/ansible-collections/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ansible-collections/subscriptions","organizations_url":"https://api.github.com/users/ansible-collections/orgs","repos_url":"https://api.github.com/users/ansible-collections/repos","events_url":"https://api.github.com/users/ansible-collections/events{/privacy}","received_events_url":"https://api.github.com/users/ansible-collections/received_events","type":"Organization","site_admin":false},"repo":{"id":244678142,"node_id":"MDEwOlJlcG9zaXRvcnkyNDQ2NzgxNDI=","name":"ansible.posix","full_name":"ansible-collections/ansible.posix","private":false,"owner":{"login":"ansible-collections","id":44586252,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ0NTg2MjUy","avatar_url":"https://avatars.githubusercontent.com/u/44586252?v=4","gravatar_id":"","url":"https://api.github.com/users/ansible-collections","html_url":"https://github.com/ansible-collections","followers_url":"https://api.github.com/users/ansible-collections/followers","following_url":"https://api.github.com/users/ansible-collections/following{/other_user}","gists_url":"https://api.github.com/users/ansible-collections/gists{/gist_id}","starred_url":"https://api.github.com/users/ansible-collections/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ansible-collections/subscriptions","organizations_url":"https://api.github.com/users/ansible-collections/orgs","repos_url":"https://api.github.com/users/ansible-collections/repos","events_url":"https://api.github.com/users/ansible-collections/events{/privacy}","received_events_url":"https://api.github.com/users/ansible-collections/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/ansible-collections/ansible.posix","description":"Ansible
        Collection for Posix","fork":false,"url":"https://api.github.com/repos/ansible-collections/ansible.posix","forks_url":"https://api.github.com/repos/ansible-collections/ansible.posix/forks","keys_url":"https://api.github.com/repos/ansible-collections/ansible.posix/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ansible-collections/ansible.posix/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ansible-collections/ansible.posix/teams","hooks_url":"https://api.github.com/repos/ansible-collections/ansible.posix/hooks","issue_events_url":"https://api.github.com/repos/ansible-collections/ansible.posix/issues/events{/number}","events_url":"https://api.github.com/repos/ansible-collections/ansible.posix/events","assignees_url":"https://api.github.com/repos/ansible-collections/ansible.posix/assignees{/user}","branches_url":"https://api.github.com/repos/ansible-collections/ansible.posix/branches{/branch}","tags_url":"https://api.github.com/repos/ansible-collections/ansible.posix/tags","blobs_url":"https://api.github.com/repos/ansible-collections/ansible.posix/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ansible-collections/ansible.posix/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ansible-collections/ansible.posix/git/refs{/sha}","trees_url":"https://api.github.com/repos/ansible-collections/ansible.posix/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ansible-collections/ansible.posix/statuses/{sha}","languages_url":"https://api.github.com/repos/ansible-collections/ansible.posix/languages","stargazers_url":"https://api.github.com/repos/ansible-collections/ansible.posix/stargazers","contributors_url":"https://api.github.com/repos/ansible-collections/ansible.posix/contributors","subscribers_url":"https://api.github.com/repos/ansible-collections/ansible.posix/subscribers","subscription_url":"https://api.github.com/repos/ansible-collections/ansible.posix/subscription","commits_url":"https://api.github.com/repos/ansible-collections/ansible.posix/commits{/sha}","git_commits_url":"https://api.github.com/repos/ansible-collections/ansible.posix/git/commits{/sha}","comments_url":"https://api.github.com/repos/ansible-collections/ansible.posix/comments{/number}","issue_comment_url":"https://api.github.com/repos/ansible-collections/ansible.posix/issues/comments{/number}","contents_url":"https://api.github.com/repos/ansible-collections/ansible.posix/contents/{+path}","compare_url":"https://api.github.com/repos/ansible-collections/ansible.posix/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ansible-collections/ansible.posix/merges","archive_url":"https://api.github.com/repos/ansible-collections/ansible.posix/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ansible-collections/ansible.posix/downloads","issues_url":"https://api.github.com/repos/ansible-collections/ansible.posix/issues{/number}","pulls_url":"https://api.github.com/repos/ansible-collections/ansible.posix/pulls{/number}","milestones_url":"https://api.github.com/repos/ansible-collections/ansible.posix/milestones{/number}","notifications_url":"https://api.github.com/repos/ansible-collections/ansible.posix/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ansible-collections/ansible.posix/labels{/name}","releases_url":"https://api.github.com/repos/ansible-collections/ansible.posix/releases{/id}","deployments_url":"https://api.github.com/repos/ansible-collections/ansible.posix/deployments","created_at":"2020-03-03T15:53:21Z","updated_at":"2021-02-20T20:27:14Z","pushed_at":"2021-02-25T19:51:00Z","git_url":"git://github.com/ansible-collections/ansible.posix.git","ssh_url":"git@github.com:ansible-collections/ansible.posix.git","clone_url":"https://github.com/ansible-collections/ansible.posix.git","svn_url":"https://github.com/ansible-collections/ansible.posix","homepage":"","size":287,"stargazers_count":28,"watchers_count":28,"language":"Python","has_issues":true,"has_projects":false,"has_downloads":false,"has_wiki":false,"has_pages":false,"forks_count":48,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":59,"license":{"key":"gpl-3.0","name":"GNU
        General Public License v3.0","spdx_id":"GPL-3.0","url":"https://api.github.com/licenses/gpl-3.0","node_id":"MDc6TGljZW5zZTk="},"forks":48,"open_issues":59,"watchers":28,"default_branch":"main"}},"_links":{"self":{"href":"https://api.github.com/repos/ansible-collections/ansible.posix/pulls/82"},"html":{"href":"https://github.com/ansible-collections/ansible.posix/pull/82"},"issue":{"href":"https://api.github.com/repos/ansible-collections/ansible.posix/issues/82"},"comments":{"href":"https://api.github.com/repos/ansible-collections/ansible.posix/issues/82/comments"},"review_comments":{"href":"https://api.github.com/repos/ansible-collections/ansible.posix/pulls/82/comments"},"review_comment":{"href":"https://api.github.com/repos/ansible-collections/ansible.posix/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/ansible-collections/ansible.posix/pulls/82/commits"},"statuses":{"href":"https://api.github.com/repos/ansible-collections/ansible.posix/statuses/4b0b50439d3b7fd232291795ca0deec36e4b59de"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null}]'
    headers:
      Access-Control-Allow-Origin:
      - '*'
      Access-Control-Expose-Headers:
      - ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining,
        X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes,
        X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset
      Cache-Control:
      - private, max-age=60, s-maxage=60
      Content-Encoding:
      - gzip
      Content-Security-Policy:
      - default-src 'none'
      Content-Type:
      - application/json; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:42 GMT
      Etag:
      - W/"7541c9e43d1684d3049bdcacf6a5ab005dbbe3f403db85dc2900e7e8c463b609"
      Referrer-Policy:
      - origin-when-cross-origin, strict-origin-when-cross-origin
      Server:
      - GitHub.com
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - Accept, Authorization, Cookie, X-GitHub-OTP
      - Accept-Encoding, Accept, X-Requested-With
      X-Accepted-OAuth-Scopes:
      - ''
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Media-Type:
      - github.cloak-preview, github.groot-preview; format=json
      X-GitHub-Request-Id:
      - AAC0:74C8:2953D:1A85B8:6039F072
      X-OAuth-Scopes:
      - repo, workflow
      X-RateLimit-Limit:
      - '5000'
      X-RateLimit-Remaining:
      - '4938'
      X-RateLimit-Reset:
      - '1614412319'
      X-XSS-Protection:
      - 1; mode=block
      x-ratelimit-used:
      - '62'
    status:
      code: 200
      message: OK
    url: https://api.github.com/repos/ansible-collections/ansible.posix/commits/4b0b50439d3b7fd232291795ca0deec36e4b59de/pulls?per_page=100
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Cookie:
      - logged_in=no
    method: GET
    uri: https://api.github.com/repos/ansible-collections/ansible.posix/pulls/82
  response:
    body:
      string: '{"url":"https://api.github.com/repos/ansible-collections/ansible.posix/pulls/82","id":468300739,"node_id":"MDExOlB1bGxSZXF1ZXN0NDY4MzAwNzM5","html_url":"https://github.com/ansible-collections/ansible.posix/pull/82","diff_url":"https://github.com/ansible-collections/ansible.posix/pull/82.diff","patch_url":"https://github.com/ansible-collections/ansible.posix/pull/82.patch","issue_url":"https://api.github.com/repos/ansible-collections/ansible.posix/issues/82","number":82,"state":"closed","locked":false,"title":"Fix
        for private_key overriding in synchronize module","user":{"login":"bmv126","id":20056956,"node_id":"MDQ6VXNlcjIwMDU2OTU2","avatar_url":"https://avatars.githubusercontent.com/u/20056956?v=4","gravatar_id":"","url":"https://api.github.com/users/bmv126","html_url":"https://github.com/bmv126","followers_url":"https://api.github.com/users/bmv126/followers","following_url":"https://api.github.com/users/bmv126/following{/other_user}","gists_url":"https://api.github.com/users/bmv126/gists{/gist_id}","starred_url":"https://api.github.com/users/bmv126/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmv126/subscriptions","organizations_url":"https://api.github.com/users/bmv126/orgs","repos_url":"https://api.github.com/users/bmv126/repos","events_url":"https://api.github.com/users/bmv126/events{/privacy}","received_events_url":"https://api.github.com/users/bmv126/received_events","type":"User","site_admin":false},"body":"#####
        SUMMARY\r\nThe private_key parameter of synchronize module task gets overridden
        by the playbook --private-key variable path.\r\nThis PR is used to fix this.
        \r\n\r\n<!--- HINT: Include \"Fixes #nnn\" if you are fixing an existing issue
        -->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest -->\r\n-
        Bugfix Pull Request\r\n\r\n##### COMPONENT NAME\r\nsynchronize\r\n\r\n#####
        ADDITIONAL INFORMATION\r\n<!--- Include additional information to help people
        understand the change here -->\r\n<!--- A step-by-step reproduction of the
        problem is helpful if there is no related issue -->\r\n\r\n<!--- Paste verbatim
        command output below, e.g. before and after your change -->\r\n##### Playbook
        content\r\n```\r\ncat play.yml\r\n- hosts: agents\r\n  remote_user: vbm\r\n  tasks:\r\n    -
        name: Fetching the /etc/hosts from manager to agent nodes\r\n      synchronize:\r\n        src:  \"/etc/hosts\"\r\n        dest:
        \"/home/vbm/\"\r\n        private_key: \"/home/vbm/test.pem\"\r\n      delegate_to:
        \"{{item}}\"\r\n      with_items: \"{{groups[''manager'']}}\"\r\n```\r\n#####
        Playbook invocation command\r\n```\r\nansible-playbook --private-key=/home/vbm/access.pem
        -i inventory play.yml -vvv\r\n```\r\n##### Error message:\r\n```\t  \r\nfailed:
        [10.75.180.184 -> 10.75.180.139] (item=10.75.180.139) => {\r\n    \"ansible_loop_var\":
        \"item\",\r\n    \"changed\": false,\r\n    \"cmd\": \"/usr/bin/rsync --delay-updates
        -F --compress --archive --rsh=/usr/bin/ssh -S none -i /home/vbm/access.pem
        -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null --out-format=<<CHANGED>>%i
        %n%L /etc/hosts vbm@10.75.180.184:/home/vbm/\",\r\n    \"invocation\": {\r\n        \"module_args\":
        {\r\n            \"_local_rsync_password\": null,\r\n            ...\r\n            \"perms\":
        null,\r\n            \"private_key\": \"/home/vbm/access.pem\",\r\n            ...\r\n            \"src\":
        \"/etc/hosts\",\r\n            \"ssh_args\": null,\r\n            ...\r\n        }\r\n    },\r\n    \"item\":
        \"10.75.180.139\",\r\n    \"msg\": \"Warning: Identity file /home/vbm/access.pem
        not accessible: No such file or directory.\\nWarning: Permanently added ''10.75.180.184''
        (ECDSA) to the list of known hosts.\\r\\n\\\\S\\nKernel \\\\r on an \\\\m\\nPermission
        denied (publickey,gssapi-keyex,gssapi-with-mic).\\r\\nrsync: connection unexpectedly
        closed (0 bytes received so far) [sender]\\nrsync error: error in rsync protocol
        data stream (code 12) at io.c(226) [sender=3.1.2]\\n\",\r\n    \"rc\": 12\r\n}\r\n```\r\n\r\n####
        Expectation:\r\n##### The private_key parameter in the module_args should
        have been `/home/vbm/test.pem` instead of `/home/vbm/access.pem`","created_at":"2020-08-15T12:28:39Z","updated_at":"2020-09-18T05:24:12Z","closed_at":"2020-09-18T05:24:12Z","merged_at":"2020-09-18T05:24:12Z","merge_commit_sha":"d1fff45191e12f9cacefc9f6ed54359960c49ebe","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":2130308405,"node_id":"MDU6TGFiZWwyMTMwMzA4NDA1","url":"https://api.github.com/repos/ansible-collections/ansible.posix/labels/gate","name":"gate","color":"41B6E6","default":false,"description":"Gate
        PR in Zuul CI"}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/ansible-collections/ansible.posix/pulls/82/commits","review_comments_url":"https://api.github.com/repos/ansible-collections/ansible.posix/pulls/82/comments","review_comment_url":"https://api.github.com/repos/ansible-collections/ansible.posix/pulls/comments{/number}","comments_url":"https://api.github.com/repos/ansible-collections/ansible.posix/issues/82/comments","statuses_url":"https://api.github.com/repos/ansible-collections/ansible.posix/statuses/4b0b50439d3b7fd232291795ca0deec36e4b59de","head":{"label":"bmv126:synchronize_private_key_issue","ref":"synchronize_private_key_issue","sha":"4b0b50439d3b7fd232291795ca0deec36e4b59de","user":{"login":"bmv126","id":20056956,"node_id":"MDQ6VXNlcjIwMDU2OTU2","avatar_url":"https://avatars.githubusercontent.com/u/20056956?v=4","gravatar_id":"","url":"https://api.github.com/users/bmv126","html_url":"https://github.com/bmv126","followers_url":"https://api.github.com/users/bmv126/followers","following_url":"https://api.github.com/users/bmv126/following{/other_user}","gists_url":"https://api.github.com/users/bmv126/gists{/gist_id}","starred_url":"https://api.github.com/users/bmv126/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmv126/subscriptions","organizations_url":"https://api.github.com/users/bmv126/orgs","repos_url":"https://api.github.com/users/bmv126/repos","events_url":"https://api.github.com/users/bmv126/events{/privacy}","received_events_url":"https://api.github.com/users/bmv126/received_events","type":"User","site_admin":false},"repo":{"id":287728517,"node_id":"MDEwOlJlcG9zaXRvcnkyODc3Mjg1MTc=","name":"ansible.posix","full_name":"bmv126/ansible.posix","private":false,"owner":{"login":"bmv126","id":20056956,"node_id":"MDQ6VXNlcjIwMDU2OTU2","avatar_url":"https://avatars.githubusercontent.com/u/20056956?v=4","gravatar_id":"","url":"https://api.github.com/users/bmv126","html_url":"https://github.com/bmv126","followers_url":"https://api.github.com/users/bmv126/followers","following_url":"https://api.github.com/users/bmv126/following{/other_user}","gists_url":"https://api.github.com/users/bmv126/gists{/gist_id}","starred_url":"https://api.github.com/users/bmv126/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmv126/subscriptions","organizations_url":"https://api.github.com/users/bmv126/orgs","repos_url":"https://api.github.com/users/bmv126/repos","events_url":"https://api.github.com/users/bmv126/events{/privacy}","received_events_url":"https://api.github.com/users/bmv126/received_events","type":"User","site_admin":false},"html_url":"https://github.com/bmv126/ansible.posix","description":"Ansible
        Collection for Posix","fork":true,"url":"https://api.github.com/repos/bmv126/ansible.posix","forks_url":"https://api.github.com/repos/bmv126/ansible.posix/forks","keys_url":"https://api.github.com/repos/bmv126/ansible.posix/keys{/key_id}","collaborators_url":"https://api.github.com/repos/bmv126/ansible.posix/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/bmv126/ansible.posix/teams","hooks_url":"https://api.github.com/repos/bmv126/ansible.posix/hooks","issue_events_url":"https://api.github.com/repos/bmv126/ansible.posix/issues/events{/number}","events_url":"https://api.github.com/repos/bmv126/ansible.posix/events","assignees_url":"https://api.github.com/repos/bmv126/ansible.posix/assignees{/user}","branches_url":"https://api.github.com/repos/bmv126/ansible.posix/branches{/branch}","tags_url":"https://api.github.com/repos/bmv126/ansible.posix/tags","blobs_url":"https://api.github.com/repos/bmv126/ansible.posix/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/bmv126/ansible.posix/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/bmv126/ansible.posix/git/refs{/sha}","trees_url":"https://api.github.com/repos/bmv126/ansible.posix/git/trees{/sha}","statuses_url":"https://api.github.com/repos/bmv126/ansible.posix/statuses/{sha}","languages_url":"https://api.github.com/repos/bmv126/ansible.posix/languages","stargazers_url":"https://api.github.com/repos/bmv126/ansible.posix/stargazers","contributors_url":"https://api.github.com/repos/bmv126/ansible.posix/contributors","subscribers_url":"https://api.github.com/repos/bmv126/ansible.posix/subscribers","subscription_url":"https://api.github.com/repos/bmv126/ansible.posix/subscription","commits_url":"https://api.github.com/repos/bmv126/ansible.posix/commits{/sha}","git_commits_url":"https://api.github.com/repos/bmv126/ansible.posix/git/commits{/sha}","comments_url":"https://api.github.com/repos/bmv126/ansible.posix/comments{/number}","issue_comment_url":"https://api.github.com/repos/bmv126/ansible.posix/issues/comments{/number}","contents_url":"https://api.github.com/repos/bmv126/ansible.posix/contents/{+path}","compare_url":"https://api.github.com/repos/bmv126/ansible.posix/compare/{base}...{head}","merges_url":"https://api.github.com/repos/bmv126/ansible.posix/merges","archive_url":"https://api.github.com/repos/bmv126/ansible.posix/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/bmv126/ansible.posix/downloads","issues_url":"https://api.github.com/repos/bmv126/ansible.posix/issues{/number}","pulls_url":"https://api.github.com/repos/bmv126/ansible.posix/pulls{/number}","milestones_url":"https://api.github.com/repos/bmv126/ansible.posix/milestones{/number}","notifications_url":"https://api.github.com/repos/bmv126/ansible.posix/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/bmv126/ansible.posix/labels{/name}","releases_url":"https://api.github.com/repos/bmv126/ansible.posix/releases{/id}","deployments_url":"https://api.github.com/repos/bmv126/ansible.posix/deployments","created_at":"2020-08-15T10:52:35Z","updated_at":"2020-08-15T10:52:36Z","pushed_at":"2020-09-04T08:22:38Z","git_url":"git://github.com/bmv126/ansible.posix.git","ssh_url":"git@github.com:bmv126/ansible.posix.git","clone_url":"https://github.com/bmv126/ansible.posix.git","svn_url":"https://github.com/bmv126/ansible.posix","homepage":"","size":257,"stargazers_count":0,"watchers_count":0,"language":null,"has_issues":false,"has_projects":true,"has_downloads":false,"has_wiki":false,"has_pages":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"gpl-3.0","name":"GNU
        General Public License v3.0","spdx_id":"GPL-3.0","url":"https://api.github.com/licenses/gpl-3.0","node_id":"MDc6TGljZW5zZTk="},"forks":0,"open_issues":0,"watchers":0,"default_branch":"main"}},"base":{"label":"ansible-collections:main","ref":"main","sha":"0177b87cbcc5fb3b0318a4996e68be8c8ba6b642","user":{"login":"ansible-collections","id":44586252,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ0NTg2MjUy","avatar_url":"https://avatars.githubusercontent.com/u/44586252?v=4","gravatar_id":"","url":"https://api.github.com/users/ansible-collections","html_url":"https://github.com/ansible-collections","followers_url":"https://api.github.com/users/ansible-collections/followers","following_url":"https://api.github.com/users/ansible-collections/following{/other_user}","gists_url":"https://api.github.com/users/ansible-collections/gists{/gist_id}","starred_url":"https://api.github.com/users/ansible-collections/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ansible-collections/subscriptions","organizations_url":"https://api.github.com/users/ansible-collections/orgs","repos_url":"https://api.github.com/users/ansible-collections/repos","events_url":"https://api.github.com/users/ansible-collections/events{/privacy}","received_events_url":"https://api.github.com/users/ansible-collections/received_events","type":"Organization","site_admin":false},"repo":{"id":244678142,"node_id":"MDEwOlJlcG9zaXRvcnkyNDQ2NzgxNDI=","name":"ansible.posix","full_name":"ansible-collections/ansible.posix","private":false,"owner":{"login":"ansible-collections","id":44586252,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ0NTg2MjUy","avatar_url":"https://avatars.githubusercontent.com/u/44586252?v=4","gravatar_id":"","url":"https://api.github.com/users/ansible-collections","html_url":"https://github.com/ansible-collections","followers_url":"https://api.github.com/users/ansible-collections/followers","following_url":"https://api.github.com/users/ansible-collections/following{/other_user}","gists_url":"https://api.github.com/users/ansible-collections/gists{/gist_id}","starred_url":"https://api.github.com/users/ansible-collections/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ansible-collections/subscriptions","organizations_url":"https://api.github.com/users/ansible-collections/orgs","repos_url":"https://api.github.com/users/ansible-collections/repos","events_url":"https://api.github.com/users/ansible-collections/events{/privacy}","received_events_url":"https://api.github.com/users/ansible-collections/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/ansible-collections/ansible.posix","description":"Ansible
        Collection for Posix","fork":false,"url":"https://api.github.com/repos/ansible-collections/ansible.posix","forks_url":"https://api.github.com/repos/ansible-collections/ansible.posix/forks","keys_url":"https://api.github.com/repos/ansible-collections/ansible.posix/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ansible-collections/ansible.posix/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ansible-collections/ansible.posix/teams","hooks_url":"https://api.github.com/repos/ansible-collections/ansible.posix/hooks","issue_events_url":"https://api.github.com/repos/ansible-collections/ansible.posix/issues/events{/number}","events_url":"https://api.github.com/repos/ansible-collections/ansible.posix/events","assignees_url":"https://api.github.com/repos/ansible-collections/ansible.posix/assignees{/user}","branches_url":"https://api.github.com/repos/ansible-collections/ansible.posix/branches{/branch}","tags_url":"https://api.github.com/repos/ansible-collections/ansible.posix/tags","blobs_url":"https://api.github.com/repos/ansible-collections/ansible.posix/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ansible-collections/ansible.posix/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ansible-collections/ansible.posix/git/refs{/sha}","trees_url":"https://api.github.com/repos/ansible-collections/ansible.posix/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ansible-collections/ansible.posix/statuses/{sha}","languages_url":"https://api.github.com/repos/ansible-collections/ansible.posix/languages","stargazers_url":"https://api.github.com/repos/ansible-collections/ansible.posix/stargazers","contributors_url":"https://api.github.com/repos/ansible-collections/ansible.posix/contributors","subscribers_url":"https://api.github.com/repos/ansible-collections/ansible.posix/subscribers","subscription_url":"https://api.github.com/repos/ansible-collections/ansible.posix/subscription","commits_url":"https://api.github.com/repos/ansible-collections/ansible.posix/commits{/sha}","git_commits_url":"https://api.github.com/repos/ansible-collections/ansible.posix/git/commits{/sha}","comments_url":"https://api.github.com/repos/ansible-collections/ansible.posix/comments{/number}","issue_comment_url":"https://api.github.com/repos/ansible-collections/ansible.posix/issues/comments{/number}","contents_url":"https://api.github.com/repos/ansible-collections/ansible.posix/contents/{+path}","compare_url":"https://api.github.com/repos/ansible-collections/ansible.posix/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ansible-collections/ansible.posix/merges","archive_url":"https://api.github.com/repos/ansible-collections/ansible.posix/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ansible-collections/ansible.posix/downloads","issues_url":"https://api.github.com/repos/ansible-collections/ansible.posix/issues{/number}","pulls_url":"https://api.github.com/repos/ansible-collections/ansible.posix/pulls{/number}","milestones_url":"https://api.github.com/repos/ansible-collections/ansible.posix/milestones{/number}","notifications_url":"https://api.github.com/repos/ansible-collections/ansible.posix/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ansible-collections/ansible.posix/labels{/name}","releases_url":"https://api.github.com/repos/ansible-collections/ansible.posix/releases{/id}","deployments_url":"https://api.github.com/repos/ansible-collections/ansible.posix/deployments","created_at":"2020-03-03T15:53:21Z","updated_at":"2021-02-20T20:27:14Z","pushed_at":"2021-02-25T19:51:00Z","git_url":"git://github.com/ansible-collections/ansible.posix.git","ssh_url":"git@github.com:ansible-collections/ansible.posix.git","clone_url":"https://github.com/ansible-collections/ansible.posix.git","svn_url":"https://github.com/ansible-collections/ansible.posix","homepage":"","size":287,"stargazers_count":28,"watchers_count":28,"language":"Python","has_issues":true,"has_projects":false,"has_downloads":false,"has_wiki":false,"has_pages":false,"forks_count":48,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":59,"license":{"key":"gpl-3.0","name":"GNU
        General Public License v3.0","spdx_id":"GPL-3.0","url":"https://api.github.com/licenses/gpl-3.0","node_id":"MDc6TGljZW5zZTk="},"forks":48,"open_issues":59,"watchers":28,"default_branch":"main"}},"_links":{"self":{"href":"https://api.github.com/repos/ansible-collections/ansible.posix/pulls/82"},"html":{"href":"https://github.com/ansible-collections/ansible.posix/pull/82"},"issue":{"href":"https://api.github.com/repos/ansible-collections/ansible.posix/issues/82"},"comments":{"href":"https://api.github.com/repos/ansible-collections/ansible.posix/issues/82/comments"},"review_comments":{"href":"https://api.github.com/repos/ansible-collections/ansible.posix/pulls/82/comments"},"review_comment":{"href":"https://api.github.com/repos/ansible-collections/ansible.posix/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/ansible-collections/ansible.posix/pulls/82/commits"},"statuses":{"href":"https://api.github.com/repos/ansible-collections/ansible.posix/statuses/4b0b50439d3b7fd232291795ca0deec36e4b59de"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null,"merged":true,"mergeable":null,"rebaseable":null,"mergeable_state":"unknown","merged_by":{"login":"ansible-zuul[bot]","id":48994755,"node_id":"MDM6Qm90NDg5OTQ3NTU=","avatar_url":"https://avatars.githubusercontent.com/in/27800?v=4","gravatar_id":"","url":"https://api.github.com/users/ansible-zuul%5Bbot%5D","html_url":"https://github.com/apps/ansible-zuul","followers_url":"https://api.github.com/users/ansible-zuul%5Bbot%5D/followers","following_url":"https://api.github.com/users/ansible-zuul%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/ansible-zuul%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/ansible-zuul%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ansible-zuul%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/ansible-zuul%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/ansible-zuul%5Bbot%5D/repos","events_url":"https://api.github.com/users/ansible-zuul%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/ansible-zuul%5Bbot%5D/received_events","type":"Bot","site_admin":false},"comments":6,"review_comments":3,"maintainer_can_modify":false,"commits":1,"additions":1943,"deletions":4,"changed_files":12}'
    headers:
      Access-Control-Allow-Origin:
      - '*'
      Access-Control-Expose-Headers:
      - ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining,
        X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes,
        X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset
      Cache-Control:
      - private, max-age=60, s-maxage=60
      Content-Encoding:
      - gzip
      Content-Security-Policy:
      - default-src 'none'
      Content-Type:
      - application/json; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:42 GMT
      Etag:
      - W/"1952ab816f0adc7a3a53d775cd35cb159187003e74dca365dbee5d8a9f9b8671"
      Last-Modified:
      - Wed, 24 Feb 2021 13:55:48 GMT
      Referrer-Policy:
      - origin-when-cross-origin, strict-origin-when-cross-origin
      Server:
      - GitHub.com
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - Accept, Authorization, Cookie, X-GitHub-OTP
      - Accept-Encoding, Accept, X-Requested-With
      X-Accepted-OAuth-Scopes:
      - ''
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Media-Type:
      - github.cloak-preview, github.groot-preview; format=json
      X-GitHub-Request-Id:
      - AAC0:74C8:2953E:1A85BC:6039F072
      X-OAuth-Scopes:
      - repo, workflow
      X-RateLimit-Limit:
      - '5000'
      X-RateLimit-Remaining:
      - '4937'
      X-RateLimit-Reset:
      - '1614412319'
      X-XSS-Protection:
      - 1; mode=block
      x-ratelimit-used:
      - '63'
    status:
      code: 200
      message: OK
    url: https://api.github.com/repos/ansible-collections/ansible.posix/pulls/82
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Accept-Encoding:
      - gzip, deflate
      Cookie:
      - logged_in=no
      Host:
      - github.com
      User-Agent:
      - Python/3.8 aiohttp/3.7.3
    method: GET
    uri: https://github.com/ansible-collections/ansible.posix/pull/82.diff
  response:
    body: {}
    headers:
      Cache-Control:
      - no-cache
      Content-Security-Policy:
      - 'default-src ''none''; base-uri ''self''; block-all-mixed-content; connect-src
        ''self'' uploads.github.com www.githubstatus.com collector.githubapp.com api.github.com
        github-cloud.s3.amazonaws.com github-production-repository-file-5c1aeb.s3.amazonaws.com
        github-production-upload-manifest-file-7fdce7.s3.amazonaws.com github-production-user-asset-6210df.s3.amazonaws.com
        cdn.optimizely.com logx.optimizely.com/v1/events wss://alive.github.com online.visualstudio.com/api/v1/locations;
        font-src github.githubassets.com; form-action ''self'' github.com gist.github.com;
        frame-ancestors ''none''; frame-src render.githubusercontent.com; img-src
        ''self'' data: github.githubassets.com identicons.github.com collector.githubapp.com
        github-cloud.s3.amazonaws.com user-images.githubusercontent.com/ *.githubusercontent.com;
        manifest-src ''self''; media-src ''none''; script-src github.githubassets.com;
        style-src ''unsafe-inline'' github.githubassets.com; worker-src github.com/socket-worker-5029ae85.js
        gist.github.com/socket-worker-5029ae85.js'
      Content-Type:
      - text/html; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:43 GMT
      Expect-CT:
      - max-age=2592000, report-uri="https://api.github.com/_private/browser/errors"
      Location:
      - https://patch-diff.githubusercontent.com/raw/ansible-collections/ansible.posix/pull/82.diff
      Referrer-Policy:
      - no-referrer-when-downgrade
      Server:
      - GitHub.com
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - X-PJAX
      - Accept-Encoding, Accept, X-Requested-With
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Request-Id:
      - D35A:3DBA:657C49:85426B:6039F073
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 302
      message: Found
    url: https://github.com/ansible-collections/ansible.posix/pull/82.diff
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Accept-Encoding:
      - gzip, deflate
      Host:
      - patch-diff.githubusercontent.com
      User-Agent:
      - Python/3.8 aiohttp/3.7.3
    method: GET
    uri: https://patch-diff.githubusercontent.com/raw/ansible-collections/ansible.posix/pull/82.diff
  response:
    body:
      string: "diff --git a/changelogs/fragments/82-private-key-override-fix.yml b/changelogs/fragments/82-private-key-override-fix.yml\nnew
        file mode 100644\nindex 0000000..fabb66f\n--- /dev/null\n+++ b/changelogs/fragments/82-private-key-override-fix.yml\n@@
        -0,0 +1,3 @@\n+---\n+bugfixes:\n+  - synchronize - Fix for private_key overriding
        in synchronize module\ndiff --git a/plugins/action/synchronize.py b/plugins/action/synchronize.py\nindex
        dd1a219..9fa43e8 100644\n--- a/plugins/action/synchronize.py\n+++ b/plugins/action/synchronize.py\n@@
        -333,10 +333,8 @@ def run(self, tmp=None, task_vars=None):\n                     user
        = task_vars.get('ansible_ssh_user') or self._play_context.remote_user\n \n
        \            # Private key handling\n-            private_key = self._play_context.private_key_file\n-\n-
        \           if private_key is not None:\n-                _tmp_args['private_key']
        = private_key\n+            # Use the private_key parameter if passed else
        use context private_key_file\n+            _tmp_args['private_key'] = _tmp_args.get('private_key',
        self._play_context.private_key_file)\n \n             # use the mode to define
        src and dest's url\n             if _tmp_args.get('mode', 'push') == 'pull':\ndiff
        --git a/tests/unit/plugins/action/fixtures/synchronize/basic_with_private_key/meta.yaml
        b/tests/unit/plugins/action/fixtures/synchronize/basic_with_private_key/meta.yaml\nnew
        file mode 100644\nindex 0000000..9b227e0\n--- /dev/null\n+++ b/tests/unit/plugins/action/fixtures/synchronize/basic_with_private_key/meta.yaml\n@@
        -0,0 +1,25 @@\n+fixtures:\n+    taskvars_in: taskvars_in.json\n+    taskvars_out:
        taskvars_out.json\n+connection:\n+    transport: 'ssh'\n+hostvars:\n+    '127.0.0.1':
        {}\n+    '::1': {}\n+    'localhost': {}\n+_play_context:\n+   private_key_file:
        ~/test.pem\n+task_args:\n+   private_key: ~/.ssh/id_rsa\n+   dest: /tmp/deleteme\n+
        \  src: /tmp/deleteme\n+\n+asserts:\n+    - \"hasattr(SAM._connection, 'ismock')\"\n+
        \   - \"SAM._connection.transport == 'local'\"\n+    - \"self._play_context.shell
        == 'sh'\"\n+    - \"self.execute_called\"\n+    - \"self.final_module_args['_local_rsync_path']
        == 'rsync'\"\n+    - \"self.final_module_args['src'] == '/tmp/deleteme'\"\n+
        \   - \"self.final_module_args['dest'] == 'root@el6host:/tmp/deleteme'\"\n+
        \   - \"self.final_module_args['private_key'] == '~/.ssh/id_rsa'\"\ndiff --git
        a/tests/unit/plugins/action/fixtures/synchronize/basic_with_private_key/taskvars_in.json
        b/tests/unit/plugins/action/fixtures/synchronize/basic_with_private_key/taskvars_in.json\nnew
        file mode 100644\nindex 0000000..9eb5d50\n--- /dev/null\n+++ b/tests/unit/plugins/action/fixtures/synchronize/basic_with_private_key/taskvars_in.json\n@@
        -0,0 +1,151 @@\n+{\n+  \"ansible_pipelining\": false, \n+  \"ansible_docker_extra_args\":
        \"\", \n+  \"ansible_scp_extra_args\": \"\", \n+  \"ansible_user\": \"root\",
        \n+  \"ansible_play_hosts\": [\n+    \"el6host\"\n+  ], \n+  \"ansible_connection\":
        \"smart\", \n+  \"ansible_ssh_common_args\": \"\", \n+  \"environment\": [],
        \n+  \"inventory_hostname\": \"el6host\", \n+  \"vars\": {\n+    \"ansible_check_mode\":
        false, \n+    \"inventory_hostname\": \"el6host\", \n+    \"inventory_file\":
        \"inventory\", \n+    \"inventory_hostname_short\": \"el6host\", \n+    \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+    \"role_names\": [], \n+
        \   \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+    \"environment\":
        [], \n+    \"play_hosts\": [\n+      \"el6host\"\n+    ], \n+    \"ansible_play_hosts\":
        [\n+      \"el6host\"\n+    ], \n+    \"hostvars\": {\n+      \"el6host\":
        {\n+        \"inventory_file\": \"inventory\", \n+        \"group_names\":
        [\n+          \"ungrouped\"\n+        ], \n+        \"groups\": {\n+          \"ungrouped\":
        [\n+            \"el6host\"\n+          ], \n+          \"all\": [\n+            \"el6host\"\n+
        \         ]\n+        }, \n+        \"inventory_hostname\": \"el6host\", \n+
        \       \"inventory_hostname_short\": \"el6host\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__03600813b83569c710bf5cb2a040d6e01da927c6\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }\n+    }, \n+    \"groups\":
        {\n+      \"ungrouped\": [\n+        \"el6host\"\n+      ], \n+      \"all\":
        [\n+        \"el6host\"\n+      ]\n+    }, \n+    \"group_names\": [\n+      \"ungrouped\"\n+
        \   ], \n+    \"omit\": \"__omit_place_holder__03600813b83569c710bf5cb2a040d6e01da927c6\",
        \n+    \"ansible_version\": {\n+      \"major\": 2, \n+      \"full\": \"2.2.0\",
        \n+      \"string\": \"2.2.0\", \n+      \"minor\": 2, \n+      \"revision\":
        0\n+    }, \n+    \"ansible_ssh_user\": \"root\"\n+  }, \n+  \"ansible_accelerate_port\":
        5099, \n+  \"roledir\": null, \n+  \"ansible_ssh_extra_args\": \"\", \n+  \"ansible_ssh_host\":
        \"el6host\", \n+  \"ansible_current_hosts\": [\n+    \"el6host\"\n+  ], \n+
        \ \"hostvars\": {\n+    \"el6host\": {\n+      \"inventory_file\": \"inventory\",
        \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ], \n+      \"groups\":
        {\n+        \"ungrouped\": [\n+          \"el6host\"\n+        ], \n+        \"all\":
        [\n+          \"el6host\"\n+        ]\n+      }, \n+      \"inventory_hostname\":
        \"el6host\", \n+      \"inventory_hostname_short\": \"el6host\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"omit\": \"__omit_place_holder__03600813b83569c710bf5cb2a040d6e01da927c6\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }\n+  }, \n+  \"group_names\": [\n+
        \   \"ungrouped\"\n+  ], \n+  \"ansible_version\": {\n+    \"major\": 2, \n+
        \   \"full\": \"2.2.0\", \n+    \"string\": \"2.2.0\", \n+    \"minor\": 2,
        \n+    \"revision\": 0\n+  }, \n+  \"ansible_ssh_pipelining\": false, \n+
        \ \"inventory_file\": \"inventory\", \n+  \"ansible_module_compression\":
        \"ZIP_DEFLATED\", \n+  \"ansible_failed_hosts\": [], \n+  \"ansible_check_mode\":
        false, \n+  \"groups\": {\n+    \"ungrouped\": [\n+      \"el6host\"\n+    ],
        \n+    \"all\": [\n+      \"el6host\"\n+    ]\n+  }, \n+  \"ansible_host\":
        \"el6host\", \n+  \"ansible_shell_executable\": \"/bin/sh\", \n+  \"inventory_hostname_short\":
        \"el6host\", \n+  \"omit\": \"__omit_place_holder__03600813b83569c710bf5cb2a040d6e01da927c6\",
        \n+  \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+  \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+  \"ansible_ssh_user\": \"root\",
        \n+  \"role_names\": [], \n+  \"play_hosts\": [\n+    \"el6host\"\n+  ], \n+
        \ \"ansible_sftp_extra_args\": \"\"\n+}\n\\ No newline at end of file\ndiff
        --git a/tests/unit/plugins/action/fixtures/synchronize/basic_with_private_key/taskvars_out.json
        b/tests/unit/plugins/action/fixtures/synchronize/basic_with_private_key/taskvars_out.json\nnew
        file mode 100644\nindex 0000000..01ebee2\n--- /dev/null\n+++ b/tests/unit/plugins/action/fixtures/synchronize/basic_with_private_key/taskvars_out.json\n@@
        -0,0 +1,156 @@\n+{\n+  \"ansible_pipelining\": false, \n+  \"ansible_docker_extra_args\":
        \"\", \n+  \"ansible_scp_extra_args\": \"\", \n+  \"ansible_user\": \"root\",
        \n+  \"ansible_play_hosts\": [\n+    \"el6host\"\n+  ], \n+  \"ansible_connection\":
        \"smart\", \n+  \"ansible_ssh_common_args\": \"\", \n+  \"environment\": [],
        \n+  \"inventory_hostname\": \"el6host\", \n+  \"vars\": {\n+    \"ansible_check_mode\":
        false, \n+    \"inventory_hostname\": \"el6host\", \n+    \"inventory_file\":
        \"inventory\", \n+    \"inventory_hostname_short\": \"el6host\", \n+    \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+    \"role_names\": [], \n+
        \   \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+    \"environment\":
        [], \n+    \"play_hosts\": [\n+      \"el6host\"\n+    ], \n+    \"ansible_play_hosts\":
        [\n+      \"el6host\"\n+    ], \n+    \"hostvars\": {\n+      \"el6host\":
        {\n+        \"inventory_file\": \"inventory\", \n+        \"group_names\":
        [\n+          \"ungrouped\"\n+        ], \n+        \"groups\": {\n+          \"ungrouped\":
        [\n+            \"el6host\", \n+            \"::1\"\n+          ], \n+          \"all\":
        [\n+            \"el6host\", \n+            \"::1\"\n+          ]\n+        },
        \n+        \"inventory_hostname\": \"el6host\", \n+        \"inventory_hostname_short\":
        \"el6host\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"omit\": \"__omit_place_holder__03600813b83569c710bf5cb2a040d6e01da927c6\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }\n+    }, \n+    \"groups\":
        {\n+      \"ungrouped\": [\n+        \"el6host\"\n+      ], \n+      \"all\":
        [\n+        \"el6host\"\n+      ]\n+    }, \n+    \"group_names\": [\n+      \"ungrouped\"\n+
        \   ], \n+    \"omit\": \"__omit_place_holder__03600813b83569c710bf5cb2a040d6e01da927c6\",
        \n+    \"ansible_version\": {\n+      \"major\": 2, \n+      \"full\": \"2.2.0\",
        \n+      \"string\": \"2.2.0\", \n+      \"minor\": 2, \n+      \"revision\":
        0\n+    }, \n+    \"ansible_ssh_user\": \"root\"\n+  }, \n+  \"ansible_accelerate_port\":
        5099, \n+  \"roledir\": null, \n+  \"ansible_ssh_extra_args\": \"\", \n+  \"ansible_ssh_host\":
        \"el6host\", \n+  \"ansible_current_hosts\": [\n+    \"el6host\"\n+  ], \n+
        \ \"hostvars\": {\n+    \"el6host\": {\n+      \"inventory_file\": \"inventory\",
        \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ], \n+      \"groups\":
        {\n+        \"ungrouped\": [\n+          \"el6host\", \n+          \"::1\"\n+
        \       ], \n+        \"all\": [\n+          \"el6host\", \n+          \"::1\"\n+
        \       ]\n+      }, \n+      \"inventory_hostname\": \"el6host\", \n+      \"inventory_hostname_short\":
        \"el6host\", \n+      \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__03600813b83569c710bf5cb2a040d6e01da927c6\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }\n+  }, \n+  \"group_names\": [\n+
        \   \"ungrouped\"\n+  ], \n+  \"ansible_version\": {\n+    \"major\": 2, \n+
        \   \"full\": \"2.2.0\", \n+    \"string\": \"2.2.0\", \n+    \"minor\": 2,
        \n+    \"revision\": 0\n+  }, \n+  \"ansible_ssh_pipelining\": false, \n+
        \ \"inventory_file\": \"inventory\", \n+  \"ansible_module_compression\":
        \"ZIP_DEFLATED\", \n+  \"ansible_failed_hosts\": [], \n+  \"ansible_check_mode\":
        false, \n+  \"groups\": {\n+    \"ungrouped\": [\n+      \"el6host\"\n+    ],
        \n+    \"all\": [\n+      \"el6host\"\n+    ]\n+  }, \n+  \"ansible_host\":
        \"el6host\", \n+  \"ansible_shell_executable\": \"/bin/sh\", \n+  \"inventory_hostname_short\":
        \"el6host\", \n+  \"omit\": \"__omit_place_holder__03600813b83569c710bf5cb2a040d6e01da927c6\",
        \n+  \"ansible_python_interpreter\": \"/usr/bin/python\", \n+  \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+  \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+  \"ansible_ssh_user\": \"root\", \n+  \"role_names\": [], \n+  \"play_hosts\":
        [\n+    \"el6host\"\n+  ], \n+  \"ansible_sftp_extra_args\": \"\"\n+}\n\\
        No newline at end of file\ndiff --git a/tests/unit/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/meta.yaml
        b/tests/unit/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/meta.yaml\nnew
        file mode 100644\nindex 0000000..31939ca\n--- /dev/null\n+++ b/tests/unit/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/meta.yaml\n@@
        -0,0 +1,28 @@\n+fixtures:\n+    taskvars_in: task_vars_in.json\n+    taskvars_out:
        task_vars_out.json\n+task_args:\n+    src: /tmp/deleteme\n+    dest: /tmp/deleteme\n+_task:\n+
        \   delegate_to: u1404    \n+_play_context:\n+    shell: None\n+    remote_addr:
        u1404\n+    remote_user: root\n+    private_key_file: ~/test.pem\n+connection:\n+
        \   transport: 'ssh'\n+hostvars:\n+    '127.0.0.1': {}\n+    '::1': {}\n+
        \   'localhost': {}\n+asserts:\n+    - \"hasattr(SAM._connection, 'ismock')\"\n+
        \   - \"SAM._connection.transport == 'ssh'\"\n+    - \"self._play_context.shell
        == None\"\n+    - \"self.execute_called\"\n+    - \"self.final_module_args['_local_rsync_path']
        == 'rsync'\"\n+    - \"self.final_module_args['src'] == '/tmp/deleteme'\"\n+
        \   - \"self.final_module_args['dest'] == 'root@el6host:/tmp/deleteme'\"\n+
        \   - \"self.final_module_args['private_key'] == '~/test.pem'\"\ndiff --git
        a/tests/unit/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/task_vars_in.json
        b/tests/unit/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/task_vars_in.json\nnew
        file mode 100644\nindex 0000000..b8893ee\n--- /dev/null\n+++ b/tests/unit/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/task_vars_in.json\n@@
        -0,0 +1,379 @@\n+{\n+  \"ansible_pipelining\": false, \n+  \"ansible_docker_extra_args\":
        \"\", \n+  \"ansible_scp_extra_args\": \"\", \n+  \"ansible_user\": \"root\",
        \n+  \"ansible_play_hosts\": [\n+    \"el6host\"\n+  ], \n+  \"ansible_connection\":
        \"smart\", \n+  \"ansible_ssh_common_args\": \"\", \n+  \"environment\": [],
        \n+  \"inventory_hostname\": \"el6host\", \n+  \"vars\": {\n+    \"ansible_check_mode\":
        false, \n+    \"inventory_hostname\": \"el6host\", \n+    \"inventory_file\":
        \"inventory\", \n+    \"ansible_delegated_vars\": {\n+      \"u1404\": {\n+
        \       \"inventory_hostname\": \"u1404\", \n+        \"inventory_file\":
        \"inventory\", \n+        \"vars\": {\n+          \"inventory_file\": \"inventory\",
        \n+          \"role_names\": [], \n+          \"ansible_play_hosts\": [\n+
        \           \"el6host\"\n+          ], \n+          \"groups\": {\n+            \"ungrouped\":
        [\n+              \"el6host\", \n+              \"u1404\"\n+            ],
        \n+            \"all\": [\n+              \"el6host\", \n+              \"u1404\"\n+
        \           ]\n+          }, \n+          \"ansible_check_mode\": false, \n+
        \         \"inventory_hostname\": \"u1404\", \n+          \"inventory_hostname_short\":
        \"u1404\", \n+          \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+          \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+          \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+          \"environment\": [], \n+          \"ansible_ssh_user\": \"root\",
        \n+          \"group_names\": [\n+            \"ungrouped\"\n+          ],
        \n+          \"play_hosts\": [\n+            \"el6host\"\n+          ], \n+
        \         \"ansible_version\": {\n+            \"major\": 2, \n+            \"full\":
        \"2.2.0\", \n+            \"string\": \"2.2.0\", \n+            \"minor\":
        2, \n+            \"revision\": 0\n+          }\n+        }, \n+        \"inventory_hostname_short\":
        \"u1404\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"group_names\": [\n+          \"ungrouped\"\n+        ], \n+        \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"ansible_host\": \"u1404\", \n+        \"environment\": [], \n+
        \       \"ansible_play_hosts\": [\n+          \"el6host\"\n+        ], \n+
        \       \"groups\": {\n+          \"ungrouped\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ]\n+        }, \n+        \"ansible_check_mode\":
        false, \n+        \"play_hosts\": [\n+          \"el6host\"\n+        ], \n+
        \       \"role_names\": [], \n+        \"ansible_port\": null, \n+        \"ansible_version\":
        {\n+          \"major\": 2, \n+          \"full\": \"2.2.0\", \n+          \"string\":
        \"2.2.0\", \n+          \"minor\": 2, \n+          \"revision\": 0\n+        },
        \n+        \"ansible_ssh_user\": \"root\"\n+      }\n+    }, \n+    \"inventory_hostname_short\":
        \"el6host\", \n+    \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+    \"role_names\": [], \n+    \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+    \"environment\": [], \n+    \"play_hosts\": [\n+      \"el6host\"\n+
        \   ], \n+    \"ansible_play_hosts\": [\n+      \"el6host\"\n+    ], \n+    \"hostvars\":
        {\n+      \"el6host\": {\n+        \"inventory_file\": \"inventory\", \n+
        \       \"group_names\": [\n+          \"ungrouped\"\n+        ], \n+        \"groups\":
        {\n+          \"ungrouped\": [\n+            \"el6host\", \n+            \"u1404\"\n+
        \         ], \n+          \"all\": [\n+            \"el6host\", \n+            \"u1404\"\n+
        \         ]\n+        }, \n+        \"inventory_hostname\": \"el6host\", \n+
        \       \"inventory_hostname_short\": \"el6host\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }, \n+      \"u1404\": {\n+
        \       \"inventory_file\": \"inventory\", \n+        \"group_names\": [\n+
        \         \"ungrouped\"\n+        ], \n+        \"groups\": {\n+          \"ungrouped\":
        [\n+            \"el6host\", \n+            \"u1404\"\n+          ], \n+          \"all\":
        [\n+            \"el6host\", \n+            \"u1404\"\n+          ]\n+        },
        \n+        \"inventory_hostname\": \"u1404\", \n+        \"inventory_hostname_short\":
        \"u1404\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }\n+    }, \n+    \"groups\":
        {\n+      \"ungrouped\": [\n+        \"el6host\", \n+        \"u1404\"\n+
        \     ], \n+      \"all\": [\n+        \"el6host\", \n+        \"u1404\"\n+
        \     ]\n+    }, \n+    \"group_names\": [\n+      \"ungrouped\"\n+    ],
        \n+    \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+    \"ansible_version\": {\n+      \"major\": 2, \n+      \"full\": \"2.2.0\",
        \n+      \"string\": \"2.2.0\", \n+      \"minor\": 2, \n+      \"revision\":
        0\n+    }, \n+    \"ansible_ssh_user\": \"root\"\n+  }, \n+  \"ansible_accelerate_port\":
        5099, \n+  \"roledir\": null, \n+  \"ansible_ssh_extra_args\": \"\", \n+  \"ansible_ssh_host\":
        \"u1404\", \n+  \"ansible_current_hosts\": [\n+    \"el6host\"\n+  ], \n+
        \ \"hostvars\": {\n+    \"el6host\": {\n+      \"inventory_file\": \"inventory\",
        \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ], \n+      \"groups\":
        {\n+        \"ungrouped\": [\n+          \"el6host\", \n+          \"u1404\"\n+
        \       ], \n+        \"all\": [\n+          \"el6host\", \n+          \"u1404\"\n+
        \       ]\n+      }, \n+      \"inventory_hostname\": \"el6host\", \n+      \"inventory_hostname_short\":
        \"el6host\", \n+      \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }, \n+    \"u1404\": {\n+      \"inventory_file\":
        \"inventory\", \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ],
        \n+      \"groups\": {\n+        \"ungrouped\": [\n+          \"el6host\",
        \n+          \"u1404\"\n+        ], \n+        \"all\": [\n+          \"el6host\",
        \n+          \"u1404\"\n+        ]\n+      }, \n+      \"inventory_hostname\":
        \"u1404\", \n+      \"inventory_hostname_short\": \"u1404\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }\n+  }, \n+  \"group_names\": [\n+
        \   \"ungrouped\"\n+  ], \n+  \"ansible_version\": {\n+    \"major\": 2, \n+
        \   \"full\": \"2.2.0\", \n+    \"string\": \"2.2.0\", \n+    \"minor\": 2,
        \n+    \"revision\": 0\n+  }, \n+  \"ansible_ssh_pipelining\": false, \n+
        \ \"inventory_file\": \"inventory\", \n+  \"ansible_delegated_vars\": {\n+
        \   \"u1404\": {\n+      \"inventory_hostname\": \"u1404\", \n+      \"inventory_file\":
        \"inventory\", \n+      \"vars\": {\n+        \"ansible_check_mode\": false,
        \n+        \"inventory_hostname\": \"u1404\", \n+        \"inventory_file\":
        \"inventory\", \n+        \"inventory_hostname_short\": \"u1404\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"environment\": [], \n+        \"ansible_ssh_user\": \"root\",
        \n+        \"ansible_play_hosts\": [\n+          \"el6host\"\n+        ],
        \n+        \"groups\": {\n+          \"ungrouped\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ]\n+        }, \n+        \"group_names\":
        [\n+          \"ungrouped\"\n+        ], \n+        \"play_hosts\": [\n+          \"el6host\"\n+
        \       ], \n+        \"ansible_version\": {\n+          \"major\": 2, \n+
        \         \"full\": \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\":
        2, \n+          \"revision\": 0\n+        }, \n+        \"role_names\": []\n+
        \     }, \n+      \"inventory_hostname_short\": \"u1404\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"group_names\": [\n+
        \       \"ungrouped\"\n+      ], \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"ansible_host\": \"u1404\", \n+      \"environment\": [], \n+      \"ansible_play_hosts\":
        [\n+        \"el6host\"\n+      ], \n+      \"groups\": {\n+        \"ungrouped\":
        [\n+          \"el6host\", \n+          \"u1404\"\n+        ], \n+        \"all\":
        [\n+          \"el6host\", \n+          \"u1404\"\n+        ]\n+      }, \n+
        \     \"ansible_check_mode\": false, \n+      \"play_hosts\": [\n+        \"el6host\"\n+
        \     ], \n+      \"role_names\": [], \n+      \"ansible_port\": null, \n+
        \     \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }, \n+      \"ansible_ssh_user\": \"root\"\n+
        \   }\n+  }, \n+  \"ansible_module_compression\": \"ZIP_DEFLATED\", \n+  \"ansible_failed_hosts\":
        [], \n+  \"ansible_check_mode\": false, \n+  \"groups\": {\n+    \"ungrouped\":
        [\n+      \"el6host\", \n+      \"u1404\"\n+    ], \n+    \"all\": [\n+      \"el6host\",
        \n+      \"u1404\"\n+    ]\n+  }, \n+  \"ansible_host\": \"u1404\", \n+  \"ansible_shell_executable\":
        \"/bin/sh\", \n+  \"inventory_hostname_short\": \"el6host\", \n+  \"omit\":
        \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\", \n+  \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+  \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+  \"ansible_ssh_user\": \"root\", \n+  \"role_names\": [], \n+  \"play_hosts\":
        [\n+    \"el6host\"\n+  ], \n+  \"ansible_sftp_extra_args\": \"\"\n+}\n\\
        No newline at end of file\ndiff --git a/tests/unit/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/task_vars_out.json
        b/tests/unit/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/task_vars_out.json\nnew
        file mode 100644\nindex 0000000..0b551f0\n--- /dev/null\n+++ b/tests/unit/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/task_vars_out.json\n@@
        -0,0 +1,387 @@\n+{\n+  \"ansible_pipelining\": false, \n+  \"ansible_docker_extra_args\":
        \"\", \n+  \"ansible_scp_extra_args\": \"\", \n+  \"ansible_user\": \"root\",
        \n+  \"ansible_play_hosts\": [\n+    \"el6host\"\n+  ], \n+  \"ansible_connection\":
        \"smart\", \n+  \"ansible_ssh_common_args\": \"\", \n+  \"environment\": [],
        \n+  \"inventory_hostname\": \"el6host\", \n+  \"vars\": {\n+    \"ansible_check_mode\":
        false, \n+    \"inventory_hostname\": \"el6host\", \n+    \"inventory_file\":
        \"inventory\", \n+    \"ansible_delegated_vars\": {\n+      \"u1404\": {\n+
        \       \"inventory_hostname\": \"u1404\", \n+        \"inventory_file\":
        \"inventory\", \n+        \"vars\": {\n+          \"inventory_file\": \"inventory\",
        \n+          \"role_names\": [], \n+          \"ansible_play_hosts\": [\n+
        \           \"el6host\"\n+          ], \n+          \"groups\": {\n+            \"ungrouped\":
        [\n+              \"el6host\", \n+              \"u1404\"\n+            ],
        \n+            \"all\": [\n+              \"el6host\", \n+              \"u1404\"\n+
        \           ]\n+          }, \n+          \"ansible_check_mode\": false, \n+
        \         \"inventory_hostname\": \"u1404\", \n+          \"inventory_hostname_short\":
        \"u1404\", \n+          \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+          \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+          \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+          \"environment\": [], \n+          \"ansible_ssh_user\": \"root\",
        \n+          \"group_names\": [\n+            \"ungrouped\"\n+          ],
        \n+          \"play_hosts\": [\n+            \"el6host\"\n+          ], \n+
        \         \"ansible_version\": {\n+            \"major\": 2, \n+            \"full\":
        \"2.2.0\", \n+            \"string\": \"2.2.0\", \n+            \"minor\":
        2, \n+            \"revision\": 0\n+          }\n+        }, \n+        \"inventory_hostname_short\":
        \"u1404\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"group_names\": [\n+          \"ungrouped\"\n+        ], \n+        \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"ansible_host\": \"u1404\", \n+        \"environment\": [], \n+
        \       \"ansible_play_hosts\": [\n+          \"el6host\"\n+        ], \n+
        \       \"groups\": {\n+          \"ungrouped\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ]\n+        }, \n+        \"ansible_check_mode\":
        false, \n+        \"play_hosts\": [\n+          \"el6host\"\n+        ], \n+
        \       \"role_names\": [], \n+        \"ansible_port\": null, \n+        \"ansible_version\":
        {\n+          \"major\": 2, \n+          \"full\": \"2.2.0\", \n+          \"string\":
        \"2.2.0\", \n+          \"minor\": 2, \n+          \"revision\": 0\n+        },
        \n+        \"ansible_ssh_user\": \"root\"\n+      }\n+    }, \n+    \"inventory_hostname_short\":
        \"el6host\", \n+    \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+    \"role_names\": [], \n+    \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+    \"environment\": [], \n+    \"play_hosts\": [\n+      \"el6host\"\n+
        \   ], \n+    \"ansible_play_hosts\": [\n+      \"el6host\"\n+    ], \n+    \"hostvars\":
        {\n+      \"el6host\": {\n+        \"inventory_file\": \"inventory\", \n+
        \       \"group_names\": [\n+          \"ungrouped\"\n+        ], \n+        \"groups\":
        {\n+          \"ungrouped\": [\n+            \"el6host\", \n+            \"u1404\",
        \n+            \"::1\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\", \n+            \"::1\"\n+          ]\n+        },
        \n+        \"inventory_hostname\": \"el6host\", \n+        \"inventory_hostname_short\":
        \"el6host\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }, \n+      \"u1404\": {\n+
        \       \"inventory_file\": \"inventory\", \n+        \"group_names\": [\n+
        \         \"ungrouped\"\n+        ], \n+        \"groups\": {\n+          \"ungrouped\":
        [\n+            \"el6host\", \n+            \"u1404\", \n+            \"::1\"\n+
        \         ], \n+          \"all\": [\n+            \"el6host\", \n+            \"u1404\",
        \n+            \"::1\"\n+          ]\n+        }, \n+        \"inventory_hostname\":
        \"u1404\", \n+        \"inventory_hostname_short\": \"u1404\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }\n+    }, \n+    \"groups\":
        {\n+      \"ungrouped\": [\n+        \"el6host\", \n+        \"u1404\"\n+
        \     ], \n+      \"all\": [\n+        \"el6host\", \n+        \"u1404\"\n+
        \     ]\n+    }, \n+    \"group_names\": [\n+      \"ungrouped\"\n+    ],
        \n+    \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+    \"ansible_version\": {\n+      \"major\": 2, \n+      \"full\": \"2.2.0\",
        \n+      \"string\": \"2.2.0\", \n+      \"minor\": 2, \n+      \"revision\":
        0\n+    }, \n+    \"ansible_ssh_user\": \"root\"\n+  }, \n+  \"ansible_accelerate_port\":
        5099, \n+  \"roledir\": null, \n+  \"ansible_ssh_extra_args\": \"\", \n+  \"ansible_ssh_host\":
        \"u1404\", \n+  \"ansible_current_hosts\": [\n+    \"el6host\"\n+  ], \n+
        \ \"hostvars\": {\n+    \"el6host\": {\n+      \"inventory_file\": \"inventory\",
        \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ], \n+      \"groups\":
        {\n+        \"ungrouped\": [\n+          \"el6host\", \n+          \"u1404\",
        \n+          \"::1\"\n+        ], \n+        \"all\": [\n+          \"el6host\",
        \n+          \"u1404\", \n+          \"::1\"\n+        ]\n+      }, \n+      \"inventory_hostname\":
        \"el6host\", \n+      \"inventory_hostname_short\": \"el6host\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }, \n+    \"u1404\": {\n+      \"inventory_file\":
        \"inventory\", \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ],
        \n+      \"groups\": {\n+        \"ungrouped\": [\n+          \"el6host\",
        \n+          \"u1404\", \n+          \"::1\"\n+        ], \n+        \"all\":
        [\n+          \"el6host\", \n+          \"u1404\", \n+          \"::1\"\n+
        \       ]\n+      }, \n+      \"inventory_hostname\": \"u1404\", \n+      \"inventory_hostname_short\":
        \"u1404\", \n+      \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }\n+  }, \n+  \"group_names\": [\n+
        \   \"ungrouped\"\n+  ], \n+  \"ansible_version\": {\n+    \"major\": 2, \n+
        \   \"full\": \"2.2.0\", \n+    \"string\": \"2.2.0\", \n+    \"minor\": 2,
        \n+    \"revision\": 0\n+  }, \n+  \"ansible_ssh_pipelining\": false, \n+
        \ \"inventory_file\": \"inventory\", \n+  \"ansible_delegated_vars\": {\n+
        \   \"u1404\": {\n+      \"inventory_hostname\": \"u1404\", \n+      \"inventory_file\":
        \"inventory\", \n+      \"vars\": {\n+        \"ansible_check_mode\": false,
        \n+        \"inventory_hostname\": \"u1404\", \n+        \"inventory_file\":
        \"inventory\", \n+        \"inventory_hostname_short\": \"u1404\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"environment\": [], \n+        \"ansible_ssh_user\": \"root\",
        \n+        \"ansible_play_hosts\": [\n+          \"el6host\"\n+        ],
        \n+        \"groups\": {\n+          \"ungrouped\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ]\n+        }, \n+        \"group_names\":
        [\n+          \"ungrouped\"\n+        ], \n+        \"play_hosts\": [\n+          \"el6host\"\n+
        \       ], \n+        \"ansible_version\": {\n+          \"major\": 2, \n+
        \         \"full\": \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\":
        2, \n+          \"revision\": 0\n+        }, \n+        \"role_names\": []\n+
        \     }, \n+      \"inventory_hostname_short\": \"u1404\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"group_names\": [\n+
        \       \"ungrouped\"\n+      ], \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"ansible_host\": \"u1404\", \n+      \"environment\": [], \n+      \"ansible_play_hosts\":
        [\n+        \"el6host\"\n+      ], \n+      \"groups\": {\n+        \"ungrouped\":
        [\n+          \"el6host\", \n+          \"u1404\"\n+        ], \n+        \"all\":
        [\n+          \"el6host\", \n+          \"u1404\"\n+        ]\n+      }, \n+
        \     \"ansible_check_mode\": false, \n+      \"play_hosts\": [\n+        \"el6host\"\n+
        \     ], \n+      \"role_names\": [], \n+      \"ansible_port\": null, \n+
        \     \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }, \n+      \"ansible_ssh_user\": \"root\"\n+
        \   }\n+  }, \n+  \"ansible_module_compression\": \"ZIP_DEFLATED\", \n+  \"ansible_failed_hosts\":
        [], \n+  \"ansible_check_mode\": false, \n+  \"groups\": {\n+    \"ungrouped\":
        [\n+      \"el6host\", \n+      \"u1404\"\n+    ], \n+    \"all\": [\n+      \"el6host\",
        \n+      \"u1404\"\n+    ]\n+  }, \n+  \"ansible_host\": \"u1404\", \n+  \"ansible_shell_executable\":
        \"/bin/sh\", \n+  \"inventory_hostname_short\": \"el6host\", \n+  \"omit\":
        \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\", \n+  \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+  \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+  \"ansible_ssh_user\": \"root\", \n+  \"role_names\": [], \n+  \"play_hosts\":
        [\n+    \"el6host\"\n+  ], \n+  \"ansible_sftp_extra_args\": \"\"\n+}\n\\
        No newline at end of file\ndiff --git a/tests/unit/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/meta.yaml
        b/tests/unit/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/meta.yaml\nnew
        file mode 100644\nindex 0000000..1242b1d\n--- /dev/null\n+++ b/tests/unit/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/meta.yaml\n@@
        -0,0 +1,29 @@\n+fixtures:\n+    taskvars_in: task_vars_in.json\n+    taskvars_out:
        task_vars_out.json\n+task_args:\n+    src: /tmp/deleteme\n+    dest: /tmp/deleteme\n+
        \   private_key: ~/.ssh/id_rsa\n+_task:\n+    delegate_to: u1404    \n+_play_context:\n+
        \   shell: None\n+    remote_addr: u1404\n+    remote_user: root\n+    private_key_file:
        ~/test.pem\n+connection:\n+    transport: 'ssh'\n+hostvars:\n+    '127.0.0.1':
        {}\n+    '::1': {}\n+    'localhost': {}\n+asserts:\n+    - \"hasattr(SAM._connection,
        'ismock')\"\n+    - \"SAM._connection.transport == 'ssh'\"\n+    - \"self._play_context.shell
        == None\"\n+    - \"self.execute_called\"\n+    - \"self.final_module_args['_local_rsync_path']
        == 'rsync'\"\n+    - \"self.final_module_args['src'] == '/tmp/deleteme'\"\n+
        \   - \"self.final_module_args['dest'] == 'root@el6host:/tmp/deleteme'\"\n+
        \   - \"self.final_module_args['private_key'] == '~/.ssh/id_rsa'\"\ndiff --git
        a/tests/unit/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/task_vars_in.json
        b/tests/unit/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/task_vars_in.json\nnew
        file mode 100644\nindex 0000000..b8893ee\n--- /dev/null\n+++ b/tests/unit/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/task_vars_in.json\n@@
        -0,0 +1,379 @@\n+{\n+  \"ansible_pipelining\": false, \n+  \"ansible_docker_extra_args\":
        \"\", \n+  \"ansible_scp_extra_args\": \"\", \n+  \"ansible_user\": \"root\",
        \n+  \"ansible_play_hosts\": [\n+    \"el6host\"\n+  ], \n+  \"ansible_connection\":
        \"smart\", \n+  \"ansible_ssh_common_args\": \"\", \n+  \"environment\": [],
        \n+  \"inventory_hostname\": \"el6host\", \n+  \"vars\": {\n+    \"ansible_check_mode\":
        false, \n+    \"inventory_hostname\": \"el6host\", \n+    \"inventory_file\":
        \"inventory\", \n+    \"ansible_delegated_vars\": {\n+      \"u1404\": {\n+
        \       \"inventory_hostname\": \"u1404\", \n+        \"inventory_file\":
        \"inventory\", \n+        \"vars\": {\n+          \"inventory_file\": \"inventory\",
        \n+          \"role_names\": [], \n+          \"ansible_play_hosts\": [\n+
        \           \"el6host\"\n+          ], \n+          \"groups\": {\n+            \"ungrouped\":
        [\n+              \"el6host\", \n+              \"u1404\"\n+            ],
        \n+            \"all\": [\n+              \"el6host\", \n+              \"u1404\"\n+
        \           ]\n+          }, \n+          \"ansible_check_mode\": false, \n+
        \         \"inventory_hostname\": \"u1404\", \n+          \"inventory_hostname_short\":
        \"u1404\", \n+          \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+          \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+          \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+          \"environment\": [], \n+          \"ansible_ssh_user\": \"root\",
        \n+          \"group_names\": [\n+            \"ungrouped\"\n+          ],
        \n+          \"play_hosts\": [\n+            \"el6host\"\n+          ], \n+
        \         \"ansible_version\": {\n+            \"major\": 2, \n+            \"full\":
        \"2.2.0\", \n+            \"string\": \"2.2.0\", \n+            \"minor\":
        2, \n+            \"revision\": 0\n+          }\n+        }, \n+        \"inventory_hostname_short\":
        \"u1404\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"group_names\": [\n+          \"ungrouped\"\n+        ], \n+        \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"ansible_host\": \"u1404\", \n+        \"environment\": [], \n+
        \       \"ansible_play_hosts\": [\n+          \"el6host\"\n+        ], \n+
        \       \"groups\": {\n+          \"ungrouped\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ]\n+        }, \n+        \"ansible_check_mode\":
        false, \n+        \"play_hosts\": [\n+          \"el6host\"\n+        ], \n+
        \       \"role_names\": [], \n+        \"ansible_port\": null, \n+        \"ansible_version\":
        {\n+          \"major\": 2, \n+          \"full\": \"2.2.0\", \n+          \"string\":
        \"2.2.0\", \n+          \"minor\": 2, \n+          \"revision\": 0\n+        },
        \n+        \"ansible_ssh_user\": \"root\"\n+      }\n+    }, \n+    \"inventory_hostname_short\":
        \"el6host\", \n+    \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+    \"role_names\": [], \n+    \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+    \"environment\": [], \n+    \"play_hosts\": [\n+      \"el6host\"\n+
        \   ], \n+    \"ansible_play_hosts\": [\n+      \"el6host\"\n+    ], \n+    \"hostvars\":
        {\n+      \"el6host\": {\n+        \"inventory_file\": \"inventory\", \n+
        \       \"group_names\": [\n+          \"ungrouped\"\n+        ], \n+        \"groups\":
        {\n+          \"ungrouped\": [\n+            \"el6host\", \n+            \"u1404\"\n+
        \         ], \n+          \"all\": [\n+            \"el6host\", \n+            \"u1404\"\n+
        \         ]\n+        }, \n+        \"inventory_hostname\": \"el6host\", \n+
        \       \"inventory_hostname_short\": \"el6host\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }, \n+      \"u1404\": {\n+
        \       \"inventory_file\": \"inventory\", \n+        \"group_names\": [\n+
        \         \"ungrouped\"\n+        ], \n+        \"groups\": {\n+          \"ungrouped\":
        [\n+            \"el6host\", \n+            \"u1404\"\n+          ], \n+          \"all\":
        [\n+            \"el6host\", \n+            \"u1404\"\n+          ]\n+        },
        \n+        \"inventory_hostname\": \"u1404\", \n+        \"inventory_hostname_short\":
        \"u1404\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }\n+    }, \n+    \"groups\":
        {\n+      \"ungrouped\": [\n+        \"el6host\", \n+        \"u1404\"\n+
        \     ], \n+      \"all\": [\n+        \"el6host\", \n+        \"u1404\"\n+
        \     ]\n+    }, \n+    \"group_names\": [\n+      \"ungrouped\"\n+    ],
        \n+    \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+    \"ansible_version\": {\n+      \"major\": 2, \n+      \"full\": \"2.2.0\",
        \n+      \"string\": \"2.2.0\", \n+      \"minor\": 2, \n+      \"revision\":
        0\n+    }, \n+    \"ansible_ssh_user\": \"root\"\n+  }, \n+  \"ansible_accelerate_port\":
        5099, \n+  \"roledir\": null, \n+  \"ansible_ssh_extra_args\": \"\", \n+  \"ansible_ssh_host\":
        \"u1404\", \n+  \"ansible_current_hosts\": [\n+    \"el6host\"\n+  ], \n+
        \ \"hostvars\": {\n+    \"el6host\": {\n+      \"inventory_file\": \"inventory\",
        \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ], \n+      \"groups\":
        {\n+        \"ungrouped\": [\n+          \"el6host\", \n+          \"u1404\"\n+
        \       ], \n+        \"all\": [\n+          \"el6host\", \n+          \"u1404\"\n+
        \       ]\n+      }, \n+      \"inventory_hostname\": \"el6host\", \n+      \"inventory_hostname_short\":
        \"el6host\", \n+      \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }, \n+    \"u1404\": {\n+      \"inventory_file\":
        \"inventory\", \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ],
        \n+      \"groups\": {\n+        \"ungrouped\": [\n+          \"el6host\",
        \n+          \"u1404\"\n+        ], \n+        \"all\": [\n+          \"el6host\",
        \n+          \"u1404\"\n+        ]\n+      }, \n+      \"inventory_hostname\":
        \"u1404\", \n+      \"inventory_hostname_short\": \"u1404\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }\n+  }, \n+  \"group_names\": [\n+
        \   \"ungrouped\"\n+  ], \n+  \"ansible_version\": {\n+    \"major\": 2, \n+
        \   \"full\": \"2.2.0\", \n+    \"string\": \"2.2.0\", \n+    \"minor\": 2,
        \n+    \"revision\": 0\n+  }, \n+  \"ansible_ssh_pipelining\": false, \n+
        \ \"inventory_file\": \"inventory\", \n+  \"ansible_delegated_vars\": {\n+
        \   \"u1404\": {\n+      \"inventory_hostname\": \"u1404\", \n+      \"inventory_file\":
        \"inventory\", \n+      \"vars\": {\n+        \"ansible_check_mode\": false,
        \n+        \"inventory_hostname\": \"u1404\", \n+        \"inventory_file\":
        \"inventory\", \n+        \"inventory_hostname_short\": \"u1404\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"environment\": [], \n+        \"ansible_ssh_user\": \"root\",
        \n+        \"ansible_play_hosts\": [\n+          \"el6host\"\n+        ],
        \n+        \"groups\": {\n+          \"ungrouped\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ]\n+        }, \n+        \"group_names\":
        [\n+          \"ungrouped\"\n+        ], \n+        \"play_hosts\": [\n+          \"el6host\"\n+
        \       ], \n+        \"ansible_version\": {\n+          \"major\": 2, \n+
        \         \"full\": \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\":
        2, \n+          \"revision\": 0\n+        }, \n+        \"role_names\": []\n+
        \     }, \n+      \"inventory_hostname_short\": \"u1404\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"group_names\": [\n+
        \       \"ungrouped\"\n+      ], \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"ansible_host\": \"u1404\", \n+      \"environment\": [], \n+      \"ansible_play_hosts\":
        [\n+        \"el6host\"\n+      ], \n+      \"groups\": {\n+        \"ungrouped\":
        [\n+          \"el6host\", \n+          \"u1404\"\n+        ], \n+        \"all\":
        [\n+          \"el6host\", \n+          \"u1404\"\n+        ]\n+      }, \n+
        \     \"ansible_check_mode\": false, \n+      \"play_hosts\": [\n+        \"el6host\"\n+
        \     ], \n+      \"role_names\": [], \n+      \"ansible_port\": null, \n+
        \     \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }, \n+      \"ansible_ssh_user\": \"root\"\n+
        \   }\n+  }, \n+  \"ansible_module_compression\": \"ZIP_DEFLATED\", \n+  \"ansible_failed_hosts\":
        [], \n+  \"ansible_check_mode\": false, \n+  \"groups\": {\n+    \"ungrouped\":
        [\n+      \"el6host\", \n+      \"u1404\"\n+    ], \n+    \"all\": [\n+      \"el6host\",
        \n+      \"u1404\"\n+    ]\n+  }, \n+  \"ansible_host\": \"u1404\", \n+  \"ansible_shell_executable\":
        \"/bin/sh\", \n+  \"inventory_hostname_short\": \"el6host\", \n+  \"omit\":
        \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\", \n+  \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+  \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+  \"ansible_ssh_user\": \"root\", \n+  \"role_names\": [], \n+  \"play_hosts\":
        [\n+    \"el6host\"\n+  ], \n+  \"ansible_sftp_extra_args\": \"\"\n+}\n\\
        No newline at end of file\ndiff --git a/tests/unit/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/task_vars_out.json
        b/tests/unit/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/task_vars_out.json\nnew
        file mode 100644\nindex 0000000..0b551f0\n--- /dev/null\n+++ b/tests/unit/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/task_vars_out.json\n@@
        -0,0 +1,387 @@\n+{\n+  \"ansible_pipelining\": false, \n+  \"ansible_docker_extra_args\":
        \"\", \n+  \"ansible_scp_extra_args\": \"\", \n+  \"ansible_user\": \"root\",
        \n+  \"ansible_play_hosts\": [\n+    \"el6host\"\n+  ], \n+  \"ansible_connection\":
        \"smart\", \n+  \"ansible_ssh_common_args\": \"\", \n+  \"environment\": [],
        \n+  \"inventory_hostname\": \"el6host\", \n+  \"vars\": {\n+    \"ansible_check_mode\":
        false, \n+    \"inventory_hostname\": \"el6host\", \n+    \"inventory_file\":
        \"inventory\", \n+    \"ansible_delegated_vars\": {\n+      \"u1404\": {\n+
        \       \"inventory_hostname\": \"u1404\", \n+        \"inventory_file\":
        \"inventory\", \n+        \"vars\": {\n+          \"inventory_file\": \"inventory\",
        \n+          \"role_names\": [], \n+          \"ansible_play_hosts\": [\n+
        \           \"el6host\"\n+          ], \n+          \"groups\": {\n+            \"ungrouped\":
        [\n+              \"el6host\", \n+              \"u1404\"\n+            ],
        \n+            \"all\": [\n+              \"el6host\", \n+              \"u1404\"\n+
        \           ]\n+          }, \n+          \"ansible_check_mode\": false, \n+
        \         \"inventory_hostname\": \"u1404\", \n+          \"inventory_hostname_short\":
        \"u1404\", \n+          \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+          \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+          \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+          \"environment\": [], \n+          \"ansible_ssh_user\": \"root\",
        \n+          \"group_names\": [\n+            \"ungrouped\"\n+          ],
        \n+          \"play_hosts\": [\n+            \"el6host\"\n+          ], \n+
        \         \"ansible_version\": {\n+            \"major\": 2, \n+            \"full\":
        \"2.2.0\", \n+            \"string\": \"2.2.0\", \n+            \"minor\":
        2, \n+            \"revision\": 0\n+          }\n+        }, \n+        \"inventory_hostname_short\":
        \"u1404\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"group_names\": [\n+          \"ungrouped\"\n+        ], \n+        \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"ansible_host\": \"u1404\", \n+        \"environment\": [], \n+
        \       \"ansible_play_hosts\": [\n+          \"el6host\"\n+        ], \n+
        \       \"groups\": {\n+          \"ungrouped\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ]\n+        }, \n+        \"ansible_check_mode\":
        false, \n+        \"play_hosts\": [\n+          \"el6host\"\n+        ], \n+
        \       \"role_names\": [], \n+        \"ansible_port\": null, \n+        \"ansible_version\":
        {\n+          \"major\": 2, \n+          \"full\": \"2.2.0\", \n+          \"string\":
        \"2.2.0\", \n+          \"minor\": 2, \n+          \"revision\": 0\n+        },
        \n+        \"ansible_ssh_user\": \"root\"\n+      }\n+    }, \n+    \"inventory_hostname_short\":
        \"el6host\", \n+    \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+    \"role_names\": [], \n+    \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+    \"environment\": [], \n+    \"play_hosts\": [\n+      \"el6host\"\n+
        \   ], \n+    \"ansible_play_hosts\": [\n+      \"el6host\"\n+    ], \n+    \"hostvars\":
        {\n+      \"el6host\": {\n+        \"inventory_file\": \"inventory\", \n+
        \       \"group_names\": [\n+          \"ungrouped\"\n+        ], \n+        \"groups\":
        {\n+          \"ungrouped\": [\n+            \"el6host\", \n+            \"u1404\",
        \n+            \"::1\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\", \n+            \"::1\"\n+          ]\n+        },
        \n+        \"inventory_hostname\": \"el6host\", \n+        \"inventory_hostname_short\":
        \"el6host\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }, \n+      \"u1404\": {\n+
        \       \"inventory_file\": \"inventory\", \n+        \"group_names\": [\n+
        \         \"ungrouped\"\n+        ], \n+        \"groups\": {\n+          \"ungrouped\":
        [\n+            \"el6host\", \n+            \"u1404\", \n+            \"::1\"\n+
        \         ], \n+          \"all\": [\n+            \"el6host\", \n+            \"u1404\",
        \n+            \"::1\"\n+          ]\n+        }, \n+        \"inventory_hostname\":
        \"u1404\", \n+        \"inventory_hostname_short\": \"u1404\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }\n+    }, \n+    \"groups\":
        {\n+      \"ungrouped\": [\n+        \"el6host\", \n+        \"u1404\"\n+
        \     ], \n+      \"all\": [\n+        \"el6host\", \n+        \"u1404\"\n+
        \     ]\n+    }, \n+    \"group_names\": [\n+      \"ungrouped\"\n+    ],
        \n+    \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+    \"ansible_version\": {\n+      \"major\": 2, \n+      \"full\": \"2.2.0\",
        \n+      \"string\": \"2.2.0\", \n+      \"minor\": 2, \n+      \"revision\":
        0\n+    }, \n+    \"ansible_ssh_user\": \"root\"\n+  }, \n+  \"ansible_accelerate_port\":
        5099, \n+  \"roledir\": null, \n+  \"ansible_ssh_extra_args\": \"\", \n+  \"ansible_ssh_host\":
        \"u1404\", \n+  \"ansible_current_hosts\": [\n+    \"el6host\"\n+  ], \n+
        \ \"hostvars\": {\n+    \"el6host\": {\n+      \"inventory_file\": \"inventory\",
        \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ], \n+      \"groups\":
        {\n+        \"ungrouped\": [\n+          \"el6host\", \n+          \"u1404\",
        \n+          \"::1\"\n+        ], \n+        \"all\": [\n+          \"el6host\",
        \n+          \"u1404\", \n+          \"::1\"\n+        ]\n+      }, \n+      \"inventory_hostname\":
        \"el6host\", \n+      \"inventory_hostname_short\": \"el6host\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }, \n+    \"u1404\": {\n+      \"inventory_file\":
        \"inventory\", \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ],
        \n+      \"groups\": {\n+        \"ungrouped\": [\n+          \"el6host\",
        \n+          \"u1404\", \n+          \"::1\"\n+        ], \n+        \"all\":
        [\n+          \"el6host\", \n+          \"u1404\", \n+          \"::1\"\n+
        \       ]\n+      }, \n+      \"inventory_hostname\": \"u1404\", \n+      \"inventory_hostname_short\":
        \"u1404\", \n+      \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }\n+  }, \n+  \"group_names\": [\n+
        \   \"ungrouped\"\n+  ], \n+  \"ansible_version\": {\n+    \"major\": 2, \n+
        \   \"full\": \"2.2.0\", \n+    \"string\": \"2.2.0\", \n+    \"minor\": 2,
        \n+    \"revision\": 0\n+  }, \n+  \"ansible_ssh_pipelining\": false, \n+
        \ \"inventory_file\": \"inventory\", \n+  \"ansible_delegated_vars\": {\n+
        \   \"u1404\": {\n+      \"inventory_hostname\": \"u1404\", \n+      \"inventory_file\":
        \"inventory\", \n+      \"vars\": {\n+        \"ansible_check_mode\": false,
        \n+        \"inventory_hostname\": \"u1404\", \n+        \"inventory_file\":
        \"inventory\", \n+        \"inventory_hostname_short\": \"u1404\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"environment\": [], \n+        \"ansible_ssh_user\": \"root\",
        \n+        \"ansible_play_hosts\": [\n+          \"el6host\"\n+        ],
        \n+        \"groups\": {\n+          \"ungrouped\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ]\n+        }, \n+        \"group_names\":
        [\n+          \"ungrouped\"\n+        ], \n+        \"play_hosts\": [\n+          \"el6host\"\n+
        \       ], \n+        \"ansible_version\": {\n+          \"major\": 2, \n+
        \         \"full\": \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\":
        2, \n+          \"revision\": 0\n+        }, \n+        \"role_names\": []\n+
        \     }, \n+      \"inventory_hostname_short\": \"u1404\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"group_names\": [\n+
        \       \"ungrouped\"\n+      ], \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"ansible_host\": \"u1404\", \n+      \"environment\": [], \n+      \"ansible_play_hosts\":
        [\n+        \"el6host\"\n+      ], \n+      \"groups\": {\n+        \"ungrouped\":
        [\n+          \"el6host\", \n+          \"u1404\"\n+        ], \n+        \"all\":
        [\n+          \"el6host\", \n+          \"u1404\"\n+        ]\n+      }, \n+
        \     \"ansible_check_mode\": false, \n+      \"play_hosts\": [\n+        \"el6host\"\n+
        \     ], \n+      \"role_names\": [], \n+      \"ansible_port\": null, \n+
        \     \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }, \n+      \"ansible_ssh_user\": \"root\"\n+
        \   }\n+  }, \n+  \"ansible_module_compression\": \"ZIP_DEFLATED\", \n+  \"ansible_failed_hosts\":
        [], \n+  \"ansible_check_mode\": false, \n+  \"groups\": {\n+    \"ungrouped\":
        [\n+      \"el6host\", \n+      \"u1404\"\n+    ], \n+    \"all\": [\n+      \"el6host\",
        \n+      \"u1404\"\n+    ]\n+  }, \n+  \"ansible_host\": \"u1404\", \n+  \"ansible_shell_executable\":
        \"/bin/sh\", \n+  \"inventory_hostname_short\": \"el6host\", \n+  \"omit\":
        \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\", \n+  \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+  \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+  \"ansible_ssh_user\": \"root\", \n+  \"role_names\": [], \n+  \"play_hosts\":
        [\n+    \"el6host\"\n+  ], \n+  \"ansible_sftp_extra_args\": \"\"\n+}\n\\
        No newline at end of file\ndiff --git a/tests/unit/plugins/action/test_synchronize.py
        b/tests/unit/plugins/action/test_synchronize.py\nindex 4f78928..f8f5f8a 100644\n---
        a/tests/unit/plugins/action/test_synchronize.py\n+++ b/tests/unit/plugins/action/test_synchronize.py\n@@
        -251,6 +251,23 @@ def test_delegate_remote_su(self):\n         x = SynchronizeTester()\n
        \        x.runtest(fixturepath=os.path.join(self.fixturedir, 'delegate_remote_su'))\n
        \n+    @patch('ansible_collections.ansible.posix.plugins.action.synchronize.connection_loader',
        FakePluginLoader)\n+    def test_basic_with_private_key(self):\n+        x
        = SynchronizeTester()\n+        x.runtest(fixturepath=os.path.join(self.fixturedir,
        'basic_with_private_key'))\n+\n+    @patch('ansible_collections.ansible.posix.plugins.action.synchronize.connection_loader',
        FakePluginLoader)\n+    def test_delegate_remote_with_private_key(self):\n+
        \       # delegate to other remote host and use the module param private_key\n+
        \       x = SynchronizeTester()\n+        x.runtest(fixturepath=os.path.join(self.fixturedir,
        'delegate_remote_with_private_key'))\n+\n+    @patch('ansible_collections.ansible.posix.plugins.action.synchronize.connection_loader',
        FakePluginLoader)\n+    def test_delegate_remote_play_context_private_key(self):\n+
        \       # delegate to other remote host and use the play context private_key\n+
        \       x = SynchronizeTester()\n+        x.runtest(fixturepath=os.path.join(self.fixturedir,
        'delegate_remote_play_context_private_key'))\n+\n     @patch.object(ActionModule,
        '_low_level_execute_command', side_effect=BreakPoint)\n     @patch.object(ActionModule,
        '_remote_expand_user', side_effect=ActionModule._remote_expand_user, autospec=True)\n
        \    def test_remote_user_not_in_local_tmpdir(self, spy_remote_expand_user,
        ll_ec):\n"
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Content-Encoding:
      - gzip
      Content-Security-Policy:
      - 'default-src ''none''; base-uri ''self''; block-all-mixed-content; connect-src
        ''self'' uploads.github.com www.githubstatus.com collector.githubapp.com api.github.com
        github-cloud.s3.amazonaws.com github-production-repository-file-5c1aeb.s3.amazonaws.com
        github-production-upload-manifest-file-7fdce7.s3.amazonaws.com github-production-user-asset-6210df.s3.amazonaws.com
        cdn.optimizely.com logx.optimizely.com/v1/events wss://alive.github.com; font-src
        github.githubassets.com; form-action ''self'' github.com gist.github.com;
        frame-ancestors ''none''; frame-src render.githubusercontent.com; img-src
        ''self'' data: github.githubassets.com identicons.github.com collector.githubapp.com
        github-cloud.s3.amazonaws.com user-images.githubusercontent.com/ *.githubusercontent.com;
        manifest-src ''self''; media-src ''none''; script-src github.githubassets.com;
        style-src ''unsafe-inline'' github.githubassets.com; worker-src github.com/socket-worker-5029ae85.js
        gist.github.com/socket-worker-5029ae85.js'
      Content-Type:
      - text/plain; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:43 GMT
      Etag:
      - W/"15b3e92fb8cf6848bf6f318157125e20"
      Expect-CT:
      - max-age=2592000, report-uri="https://api.github.com/_private/browser/errors"
      Referrer-Policy:
      - origin-when-cross-origin, strict-origin-when-cross-origin
      Server:
      - GitHub.com
      Set-Cookie:
      - logged_in=no; domain=.github.com; path=/; expires=Sun, 27 Feb 2022 07:10:43
        GMT; secure; HttpOnly; SameSite=Lax
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - X-PJAX
      - Accept-Encoding, Accept, X-Requested-With
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Request-Id:
      - D35C:1A52:95E3EC:B71B55:6039F073
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
    url: https://patch-diff.githubusercontent.com/raw/ansible-collections/ansible.posix/pull/82.diff
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Cookie:
      - logged_in=no
    method: GET
    uri: https://api.github.com/repos/ansible/ansible/pulls/73556
  response:
    body:
      string: '{"url":"https://api.github.com/repos/ansible/ansible/pulls/73556","id":570687276,"node_id":"MDExOlB1bGxSZXF1ZXN0NTcwNjg3Mjc2","html_url":"https://github.com/ansible/ansible/pull/73556","diff_url":"https://github.com/ansible/ansible/pull/73556.diff","patch_url":"https://github.com/ansible/ansible/pull/73556.patch","issue_url":"https://api.github.com/repos/ansible/ansible/issues/73556","number":73556,"state":"open","locked":false,"title":"Fix
        for private_key overriding in synchronize module","user":{"login":"holser","id":954156,"node_id":"MDQ6VXNlcjk1NDE1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/954156?v=4","gravatar_id":"","url":"https://api.github.com/users/holser","html_url":"https://github.com/holser","followers_url":"https://api.github.com/users/holser/followers","following_url":"https://api.github.com/users/holser/following{/other_user}","gists_url":"https://api.github.com/users/holser/gists{/gist_id}","starred_url":"https://api.github.com/users/holser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/holser/subscriptions","organizations_url":"https://api.github.com/users/holser/orgs","repos_url":"https://api.github.com/users/holser/repos","events_url":"https://api.github.com/users/holser/events{/privacy}","received_events_url":"https://api.github.com/users/holser/received_events","type":"User","site_admin":false},"body":"SUMMARY\r\nBackport
        of https://github.com/ansible-collections/ansible.posix/commit/4b0b50439d3b7fd232291795ca0deec36e4b59de\r\n\r\nISSUE
        TYPE\r\nBug\r\n\r\nBugfix Pull Request\r\nhttps://github.com/ansible/ansible/pull/73556\r\n\r\nDocs
        Pull Request\r\nFeature Pull Request\r\nTest Pull Request\r\nCOMPONENT NAME\r\n\r\nADDITIONAL
        INFORMATION","created_at":"2021-02-09T23:25:44Z","updated_at":"2021-02-18T16:43:40Z","closed_at":null,"merged_at":null,"merge_commit_sha":"ff3d7fd0eac35fe9f8341b76c07d079b8a345c2f","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1316917295,"node_id":"MDU6TGFiZWwxMzE2OTE3Mjk1","url":"https://api.github.com/repos/ansible/ansible/labels/affects_2.9","name":"affects_2.9","color":"5319e7","default":false,"description":"This
        issue/PR affects Ansible v2.9"},{"id":266246971,"node_id":"MDU6TGFiZWwyNjYyNDY5NzE=","url":"https://api.github.com/repos/ansible/ansible/labels/backport","name":"backport","color":"00ff00","default":false,"description":"This
        PR does not target the devel branch."},{"id":785271699,"node_id":"MDU6TGFiZWw3ODUyNzE2OTk=","url":"https://api.github.com/repos/ansible/ansible/labels/bug","name":"bug","color":"fbca04","default":true,"description":"This
        issue/PR relates to a bug."},{"id":1285191701,"node_id":"MDU6TGFiZWwxMjg1MTkxNzAx","url":"https://api.github.com/repos/ansible/ansible/labels/collection","name":"collection","color":"b60205","default":false,"description":"Related
        to Ansible Collections work"},{"id":1991397378,"node_id":"MDU6TGFiZWwxOTkxMzk3Mzc4","url":"https://api.github.com/repos/ansible/ansible/labels/collection:ansible.posix","name":"collection:ansible.posix","color":"ededed","default":false,"description":null},{"id":513652538,"node_id":"MDU6TGFiZWw1MTM2NTI1Mzg=","url":"https://api.github.com/repos/ansible/ansible/labels/core_review","name":"core_review","color":"ededed","default":false,"description":"In
        order to be merged, this PR must follow the core review workflow."},{"id":503572087,"node_id":"MDU6TGFiZWw1MDM1NzIwODc=","url":"https://api.github.com/repos/ansible/ansible/labels/needs_triage","name":"needs_triage","color":"0e8a16","default":false,"description":"Needs
        a first human triage before being processed."},{"id":723150340,"node_id":"MDU6TGFiZWw3MjMxNTAzNDA=","url":"https://api.github.com/repos/ansible/ansible/labels/new_contributor","name":"new_contributor","color":"c2e0c6","default":false,"description":"This
        PR is the first contribution by a new community member."},{"id":153577825,"node_id":"MDU6TGFiZWwxNTM1Nzc4MjU=","url":"https://api.github.com/repos/ansible/ansible/labels/new_plugin","name":"new_plugin","color":"bfe5bf","default":false,"description":"This
        PR includes a new plugin."},{"id":581543918,"node_id":"MDU6TGFiZWw1ODE1NDM5MTg=","url":"https://api.github.com/repos/ansible/ansible/labels/stale_ci","name":"stale_ci","color":"fef2c0","default":false,"description":"This
        PR has been tested by CI more than one week ago. Close and re-open this PR
        to get it retested."},{"id":636327968,"node_id":"MDU6TGFiZWw2MzYzMjc5Njg=","url":"https://api.github.com/repos/ansible/ansible/labels/support:community","name":"support:community","color":"ededed","default":false,"description":"This
        issue/PR relates to code supported by the Ansible community."},{"id":636352796,"node_id":"MDU6TGFiZWw2MzYzNTI3OTY=","url":"https://api.github.com/repos/ansible/ansible/labels/support:core","name":"support:core","color":"ededed","default":false,"description":"This
        issue/PR relates to code supported by the Ansible Engineering Team."},{"id":468273802,"node_id":"MDU6TGFiZWw0NjgyNzM4MDI=","url":"https://api.github.com/repos/ansible/ansible/labels/test","name":"test","color":"0e8a16","default":false,"description":"This
        PR relates to tests."}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/ansible/ansible/pulls/73556/commits","review_comments_url":"https://api.github.com/repos/ansible/ansible/pulls/73556/comments","review_comment_url":"https://api.github.com/repos/ansible/ansible/pulls/comments{/number}","comments_url":"https://api.github.com/repos/ansible/ansible/issues/73556/comments","statuses_url":"https://api.github.com/repos/ansible/ansible/statuses/c38a0ed55403d508b77d1ba7dc91c4e7ce14780f","head":{"label":"holser:fix_synchronize","ref":"fix_synchronize","sha":"c38a0ed55403d508b77d1ba7dc91c4e7ce14780f","user":{"login":"holser","id":954156,"node_id":"MDQ6VXNlcjk1NDE1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/954156?v=4","gravatar_id":"","url":"https://api.github.com/users/holser","html_url":"https://github.com/holser","followers_url":"https://api.github.com/users/holser/followers","following_url":"https://api.github.com/users/holser/following{/other_user}","gists_url":"https://api.github.com/users/holser/gists{/gist_id}","starred_url":"https://api.github.com/users/holser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/holser/subscriptions","organizations_url":"https://api.github.com/users/holser/orgs","repos_url":"https://api.github.com/users/holser/repos","events_url":"https://api.github.com/users/holser/events{/privacy}","received_events_url":"https://api.github.com/users/holser/received_events","type":"User","site_admin":false},"repo":{"id":331725409,"node_id":"MDEwOlJlcG9zaXRvcnkzMzE3MjU0MDk=","name":"ansible","full_name":"holser/ansible","private":false,"owner":{"login":"holser","id":954156,"node_id":"MDQ6VXNlcjk1NDE1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/954156?v=4","gravatar_id":"","url":"https://api.github.com/users/holser","html_url":"https://github.com/holser","followers_url":"https://api.github.com/users/holser/followers","following_url":"https://api.github.com/users/holser/following{/other_user}","gists_url":"https://api.github.com/users/holser/gists{/gist_id}","starred_url":"https://api.github.com/users/holser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/holser/subscriptions","organizations_url":"https://api.github.com/users/holser/orgs","repos_url":"https://api.github.com/users/holser/repos","events_url":"https://api.github.com/users/holser/events{/privacy}","received_events_url":"https://api.github.com/users/holser/received_events","type":"User","site_admin":false},"html_url":"https://github.com/holser/ansible","description":"Ansible
        is a radically simple IT automation platform that makes your applications
        and systems easier to deploy and maintain. Automate everything from code deployment
        to network configuration to cloud management, in a language that approaches
        plain English, using SSH, with no agents to install on remote systems. https://docs.ansible.com.","fork":true,"url":"https://api.github.com/repos/holser/ansible","forks_url":"https://api.github.com/repos/holser/ansible/forks","keys_url":"https://api.github.com/repos/holser/ansible/keys{/key_id}","collaborators_url":"https://api.github.com/repos/holser/ansible/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/holser/ansible/teams","hooks_url":"https://api.github.com/repos/holser/ansible/hooks","issue_events_url":"https://api.github.com/repos/holser/ansible/issues/events{/number}","events_url":"https://api.github.com/repos/holser/ansible/events","assignees_url":"https://api.github.com/repos/holser/ansible/assignees{/user}","branches_url":"https://api.github.com/repos/holser/ansible/branches{/branch}","tags_url":"https://api.github.com/repos/holser/ansible/tags","blobs_url":"https://api.github.com/repos/holser/ansible/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/holser/ansible/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/holser/ansible/git/refs{/sha}","trees_url":"https://api.github.com/repos/holser/ansible/git/trees{/sha}","statuses_url":"https://api.github.com/repos/holser/ansible/statuses/{sha}","languages_url":"https://api.github.com/repos/holser/ansible/languages","stargazers_url":"https://api.github.com/repos/holser/ansible/stargazers","contributors_url":"https://api.github.com/repos/holser/ansible/contributors","subscribers_url":"https://api.github.com/repos/holser/ansible/subscribers","subscription_url":"https://api.github.com/repos/holser/ansible/subscription","commits_url":"https://api.github.com/repos/holser/ansible/commits{/sha}","git_commits_url":"https://api.github.com/repos/holser/ansible/git/commits{/sha}","comments_url":"https://api.github.com/repos/holser/ansible/comments{/number}","issue_comment_url":"https://api.github.com/repos/holser/ansible/issues/comments{/number}","contents_url":"https://api.github.com/repos/holser/ansible/contents/{+path}","compare_url":"https://api.github.com/repos/holser/ansible/compare/{base}...{head}","merges_url":"https://api.github.com/repos/holser/ansible/merges","archive_url":"https://api.github.com/repos/holser/ansible/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/holser/ansible/downloads","issues_url":"https://api.github.com/repos/holser/ansible/issues{/number}","pulls_url":"https://api.github.com/repos/holser/ansible/pulls{/number}","milestones_url":"https://api.github.com/repos/holser/ansible/milestones{/number}","notifications_url":"https://api.github.com/repos/holser/ansible/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/holser/ansible/labels{/name}","releases_url":"https://api.github.com/repos/holser/ansible/releases{/id}","deployments_url":"https://api.github.com/repos/holser/ansible/deployments","created_at":"2021-01-21T18:58:57Z","updated_at":"2021-02-09T23:11:57Z","pushed_at":"2021-02-10T00:13:41Z","git_url":"git://github.com/holser/ansible.git","ssh_url":"git@github.com:holser/ansible.git","clone_url":"https://github.com/holser/ansible.git","svn_url":"https://github.com/holser/ansible","homepage":"https://www.ansible.com/","size":186484,"stargazers_count":0,"watchers_count":0,"language":"Python","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"gpl-3.0","name":"GNU
        General Public License v3.0","spdx_id":"GPL-3.0","url":"https://api.github.com/licenses/gpl-3.0","node_id":"MDc6TGljZW5zZTk="},"forks":0,"open_issues":0,"watchers":0,"default_branch":"devel"}},"base":{"label":"ansible:stable-2.9","ref":"stable-2.9","sha":"7a7f5a700660c9ea9028062b6714540df57910e2","user":{"login":"ansible","id":1507452,"node_id":"MDEyOk9yZ2FuaXphdGlvbjE1MDc0NTI=","avatar_url":"https://avatars.githubusercontent.com/u/1507452?v=4","gravatar_id":"","url":"https://api.github.com/users/ansible","html_url":"https://github.com/ansible","followers_url":"https://api.github.com/users/ansible/followers","following_url":"https://api.github.com/users/ansible/following{/other_user}","gists_url":"https://api.github.com/users/ansible/gists{/gist_id}","starred_url":"https://api.github.com/users/ansible/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ansible/subscriptions","organizations_url":"https://api.github.com/users/ansible/orgs","repos_url":"https://api.github.com/users/ansible/repos","events_url":"https://api.github.com/users/ansible/events{/privacy}","received_events_url":"https://api.github.com/users/ansible/received_events","type":"Organization","site_admin":false},"repo":{"id":3638964,"node_id":"MDEwOlJlcG9zaXRvcnkzNjM4OTY0","name":"ansible","full_name":"ansible/ansible","private":false,"owner":{"login":"ansible","id":1507452,"node_id":"MDEyOk9yZ2FuaXphdGlvbjE1MDc0NTI=","avatar_url":"https://avatars.githubusercontent.com/u/1507452?v=4","gravatar_id":"","url":"https://api.github.com/users/ansible","html_url":"https://github.com/ansible","followers_url":"https://api.github.com/users/ansible/followers","following_url":"https://api.github.com/users/ansible/following{/other_user}","gists_url":"https://api.github.com/users/ansible/gists{/gist_id}","starred_url":"https://api.github.com/users/ansible/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ansible/subscriptions","organizations_url":"https://api.github.com/users/ansible/orgs","repos_url":"https://api.github.com/users/ansible/repos","events_url":"https://api.github.com/users/ansible/events{/privacy}","received_events_url":"https://api.github.com/users/ansible/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/ansible/ansible","description":"Ansible
        is a radically simple IT automation platform that makes your applications
        and systems easier to deploy and maintain. Automate everything from code deployment
        to network configuration to cloud management, in a language that approaches
        plain English, using SSH, with no agents to install on remote systems. https://docs.ansible.com.","fork":false,"url":"https://api.github.com/repos/ansible/ansible","forks_url":"https://api.github.com/repos/ansible/ansible/forks","keys_url":"https://api.github.com/repos/ansible/ansible/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ansible/ansible/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ansible/ansible/teams","hooks_url":"https://api.github.com/repos/ansible/ansible/hooks","issue_events_url":"https://api.github.com/repos/ansible/ansible/issues/events{/number}","events_url":"https://api.github.com/repos/ansible/ansible/events","assignees_url":"https://api.github.com/repos/ansible/ansible/assignees{/user}","branches_url":"https://api.github.com/repos/ansible/ansible/branches{/branch}","tags_url":"https://api.github.com/repos/ansible/ansible/tags","blobs_url":"https://api.github.com/repos/ansible/ansible/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ansible/ansible/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ansible/ansible/git/refs{/sha}","trees_url":"https://api.github.com/repos/ansible/ansible/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ansible/ansible/statuses/{sha}","languages_url":"https://api.github.com/repos/ansible/ansible/languages","stargazers_url":"https://api.github.com/repos/ansible/ansible/stargazers","contributors_url":"https://api.github.com/repos/ansible/ansible/contributors","subscribers_url":"https://api.github.com/repos/ansible/ansible/subscribers","subscription_url":"https://api.github.com/repos/ansible/ansible/subscription","commits_url":"https://api.github.com/repos/ansible/ansible/commits{/sha}","git_commits_url":"https://api.github.com/repos/ansible/ansible/git/commits{/sha}","comments_url":"https://api.github.com/repos/ansible/ansible/comments{/number}","issue_comment_url":"https://api.github.com/repos/ansible/ansible/issues/comments{/number}","contents_url":"https://api.github.com/repos/ansible/ansible/contents/{+path}","compare_url":"https://api.github.com/repos/ansible/ansible/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ansible/ansible/merges","archive_url":"https://api.github.com/repos/ansible/ansible/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ansible/ansible/downloads","issues_url":"https://api.github.com/repos/ansible/ansible/issues{/number}","pulls_url":"https://api.github.com/repos/ansible/ansible/pulls{/number}","milestones_url":"https://api.github.com/repos/ansible/ansible/milestones{/number}","notifications_url":"https://api.github.com/repos/ansible/ansible/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ansible/ansible/labels{/name}","releases_url":"https://api.github.com/repos/ansible/ansible/releases{/id}","deployments_url":"https://api.github.com/repos/ansible/ansible/deployments","created_at":"2012-03-06T14:58:02Z","updated_at":"2021-02-27T02:40:42Z","pushed_at":"2021-02-27T06:00:14Z","git_url":"git://github.com/ansible/ansible.git","ssh_url":"org-1507452@github.com:ansible/ansible.git","clone_url":"https://github.com/ansible/ansible.git","svn_url":"https://github.com/ansible/ansible","homepage":"https://www.ansible.com/","size":194931,"stargazers_count":47033,"watchers_count":47033,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"forks_count":20311,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1892,"license":{"key":"gpl-3.0","name":"GNU
        General Public License v3.0","spdx_id":"GPL-3.0","url":"https://api.github.com/licenses/gpl-3.0","node_id":"MDc6TGljZW5zZTk="},"forks":20311,"open_issues":1892,"watchers":47033,"default_branch":"devel"}},"_links":{"self":{"href":"https://api.github.com/repos/ansible/ansible/pulls/73556"},"html":{"href":"https://github.com/ansible/ansible/pull/73556"},"issue":{"href":"https://api.github.com/repos/ansible/ansible/issues/73556"},"comments":{"href":"https://api.github.com/repos/ansible/ansible/issues/73556/comments"},"review_comments":{"href":"https://api.github.com/repos/ansible/ansible/pulls/73556/comments"},"review_comment":{"href":"https://api.github.com/repos/ansible/ansible/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/ansible/ansible/pulls/73556/commits"},"statuses":{"href":"https://api.github.com/repos/ansible/ansible/statuses/c38a0ed55403d508b77d1ba7dc91c4e7ce14780f"}},"author_association":"FIRST_TIME_CONTRIBUTOR","auto_merge":null,"active_lock_reason":null,"merged":false,"mergeable":true,"rebaseable":true,"mergeable_state":"clean","merged_by":null,"comments":1,"review_comments":0,"maintainer_can_modify":true,"commits":1,"additions":1943,"deletions":5,"changed_files":12}'
    headers:
      Access-Control-Allow-Origin:
      - '*'
      Access-Control-Expose-Headers:
      - ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining,
        X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes,
        X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset
      Cache-Control:
      - private, max-age=60, s-maxage=60
      Content-Encoding:
      - gzip
      Content-Security-Policy:
      - default-src 'none'
      Content-Type:
      - application/json; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:43 GMT
      Etag:
      - W/"d9025a416b31fe9125b26c3ced320e90c88ce66269a1288d29f3b1937b110dc3"
      Last-Modified:
      - Wed, 24 Feb 2021 11:34:34 GMT
      Referrer-Policy:
      - origin-when-cross-origin, strict-origin-when-cross-origin
      Server:
      - GitHub.com
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - Accept, Authorization, Cookie, X-GitHub-OTP
      - Accept-Encoding, Accept, X-Requested-With
      X-Accepted-OAuth-Scopes:
      - ''
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Media-Type:
      - github.cloak-preview, github.groot-preview; format=json
      X-GitHub-Request-Id:
      - AAC0:74C8:2953F:1A85CB:6039F073
      X-OAuth-Scopes:
      - repo, workflow
      X-RateLimit-Limit:
      - '5000'
      X-RateLimit-Remaining:
      - '4936'
      X-RateLimit-Reset:
      - '1614412319'
      X-XSS-Protection:
      - 1; mode=block
      x-ratelimit-used:
      - '64'
    status:
      code: 200
      message: OK
    url: https://api.github.com/repos/ansible/ansible/pulls/73556
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Accept-Encoding:
      - gzip, deflate
      Cookie:
      - logged_in=no
      Host:
      - github.com
      User-Agent:
      - Python/3.8 aiohttp/3.7.3
    method: GET
    uri: https://github.com/ansible/ansible/pull/73556.diff
  response:
    body: {}
    headers:
      Cache-Control:
      - no-cache
      Content-Security-Policy:
      - 'default-src ''none''; base-uri ''self''; block-all-mixed-content; connect-src
        ''self'' uploads.github.com www.githubstatus.com collector.githubapp.com api.github.com
        github-cloud.s3.amazonaws.com github-production-repository-file-5c1aeb.s3.amazonaws.com
        github-production-upload-manifest-file-7fdce7.s3.amazonaws.com github-production-user-asset-6210df.s3.amazonaws.com
        cdn.optimizely.com logx.optimizely.com/v1/events wss://alive.github.com online.visualstudio.com/api/v1/locations;
        font-src github.githubassets.com; form-action ''self'' github.com gist.github.com;
        frame-ancestors ''none''; frame-src render.githubusercontent.com; img-src
        ''self'' data: github.githubassets.com identicons.github.com collector.githubapp.com
        github-cloud.s3.amazonaws.com user-images.githubusercontent.com/ *.githubusercontent.com;
        manifest-src ''self''; media-src ''none''; script-src github.githubassets.com;
        style-src ''unsafe-inline'' github.githubassets.com; worker-src github.com/socket-worker-5029ae85.js
        gist.github.com/socket-worker-5029ae85.js'
      Content-Type:
      - text/html; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:43 GMT
      Expect-CT:
      - max-age=2592000, report-uri="https://api.github.com/_private/browser/errors"
      Location:
      - https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73556.diff
      Referrer-Policy:
      - no-referrer-when-downgrade
      Server:
      - GitHub.com
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - X-PJAX
      - Accept-Encoding, Accept, X-Requested-With
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Request-Id:
      - D35A:3DBA:657C97:8542D0:6039F073
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 302
      message: Found
    url: https://github.com/ansible/ansible/pull/73556.diff
- request:
    body: null
    headers:
      Accept:
      - application/vnd.github.cloak-preview, application/vnd.github.groot-preview+json,
        application/vnd.github.v3+json
      Accept-Encoding:
      - gzip, deflate
      Host:
      - patch-diff.githubusercontent.com
      User-Agent:
      - Python/3.8 aiohttp/3.7.3
    method: GET
    uri: https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73556.diff
  response:
    body:
      string: "diff --git a/changelogs/fragments/73556-private-key-override-fix.yml-private-key-override-fix.yml
        b/changelogs/fragments/73556-private-key-override-fix.yml-private-key-override-fix.yml\nnew
        file mode 100644\nindex 0000000000000..fabb66fef4e23\n--- /dev/null\n+++ b/changelogs/fragments/73556-private-key-override-fix.yml-private-key-override-fix.yml\n@@
        -0,0 +1,3 @@\n+---\n+bugfixes:\n+  - synchronize - Fix for private_key overriding
        in synchronize module\ndiff --git a/lib/ansible/plugins/action/synchronize.py
        b/lib/ansible/plugins/action/synchronize.py\nindex 0385cc9a72d19..0ff1751607b78
        100644\n--- a/lib/ansible/plugins/action/synchronize.py\n+++ b/lib/ansible/plugins/action/synchronize.py\n@@
        -332,11 +332,8 @@ def run(self, tmp=None, task_vars=None):\n                 else:\n
        \                    user = task_vars.get('ansible_ssh_user') or self._play_context.remote_user\n
        \n-            # Private key handling\n-            private_key = self._play_context.private_key_file\n-\n-
        \           if private_key is not None:\n-                _tmp_args['private_key']
        = private_key\n+            # Use the private_key parameter if passed else
        use context private_key_file\n+            _tmp_args['private_key'] = _tmp_args.get('private_key',
        self._play_context.private_key_file)\n \n             # use the mode to define
        src and dest's url\n             if _tmp_args.get('mode', 'push') == 'pull':\ndiff
        --git a/test/units/plugins/action/fixtures/synchronize/basic_with_private_key/meta.yaml
        b/test/units/plugins/action/fixtures/synchronize/basic_with_private_key/meta.yaml\nnew
        file mode 100644\nindex 0000000000000..9b227e075b167\n--- /dev/null\n+++ b/test/units/plugins/action/fixtures/synchronize/basic_with_private_key/meta.yaml\n@@
        -0,0 +1,25 @@\n+fixtures:\n+    taskvars_in: taskvars_in.json\n+    taskvars_out:
        taskvars_out.json\n+connection:\n+    transport: 'ssh'\n+hostvars:\n+    '127.0.0.1':
        {}\n+    '::1': {}\n+    'localhost': {}\n+_play_context:\n+   private_key_file:
        ~/test.pem\n+task_args:\n+   private_key: ~/.ssh/id_rsa\n+   dest: /tmp/deleteme\n+
        \  src: /tmp/deleteme\n+\n+asserts:\n+    - \"hasattr(SAM._connection, 'ismock')\"\n+
        \   - \"SAM._connection.transport == 'local'\"\n+    - \"self._play_context.shell
        == 'sh'\"\n+    - \"self.execute_called\"\n+    - \"self.final_module_args['_local_rsync_path']
        == 'rsync'\"\n+    - \"self.final_module_args['src'] == '/tmp/deleteme'\"\n+
        \   - \"self.final_module_args['dest'] == 'root@el6host:/tmp/deleteme'\"\n+
        \   - \"self.final_module_args['private_key'] == '~/.ssh/id_rsa'\"\ndiff --git
        a/test/units/plugins/action/fixtures/synchronize/basic_with_private_key/taskvars_in.json
        b/test/units/plugins/action/fixtures/synchronize/basic_with_private_key/taskvars_in.json\nnew
        file mode 100644\nindex 0000000000000..9eb5d50ad1fc1\n--- /dev/null\n+++ b/test/units/plugins/action/fixtures/synchronize/basic_with_private_key/taskvars_in.json\n@@
        -0,0 +1,151 @@\n+{\n+  \"ansible_pipelining\": false, \n+  \"ansible_docker_extra_args\":
        \"\", \n+  \"ansible_scp_extra_args\": \"\", \n+  \"ansible_user\": \"root\",
        \n+  \"ansible_play_hosts\": [\n+    \"el6host\"\n+  ], \n+  \"ansible_connection\":
        \"smart\", \n+  \"ansible_ssh_common_args\": \"\", \n+  \"environment\": [],
        \n+  \"inventory_hostname\": \"el6host\", \n+  \"vars\": {\n+    \"ansible_check_mode\":
        false, \n+    \"inventory_hostname\": \"el6host\", \n+    \"inventory_file\":
        \"inventory\", \n+    \"inventory_hostname_short\": \"el6host\", \n+    \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+    \"role_names\": [], \n+
        \   \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+    \"environment\":
        [], \n+    \"play_hosts\": [\n+      \"el6host\"\n+    ], \n+    \"ansible_play_hosts\":
        [\n+      \"el6host\"\n+    ], \n+    \"hostvars\": {\n+      \"el6host\":
        {\n+        \"inventory_file\": \"inventory\", \n+        \"group_names\":
        [\n+          \"ungrouped\"\n+        ], \n+        \"groups\": {\n+          \"ungrouped\":
        [\n+            \"el6host\"\n+          ], \n+          \"all\": [\n+            \"el6host\"\n+
        \         ]\n+        }, \n+        \"inventory_hostname\": \"el6host\", \n+
        \       \"inventory_hostname_short\": \"el6host\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__03600813b83569c710bf5cb2a040d6e01da927c6\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }\n+    }, \n+    \"groups\":
        {\n+      \"ungrouped\": [\n+        \"el6host\"\n+      ], \n+      \"all\":
        [\n+        \"el6host\"\n+      ]\n+    }, \n+    \"group_names\": [\n+      \"ungrouped\"\n+
        \   ], \n+    \"omit\": \"__omit_place_holder__03600813b83569c710bf5cb2a040d6e01da927c6\",
        \n+    \"ansible_version\": {\n+      \"major\": 2, \n+      \"full\": \"2.2.0\",
        \n+      \"string\": \"2.2.0\", \n+      \"minor\": 2, \n+      \"revision\":
        0\n+    }, \n+    \"ansible_ssh_user\": \"root\"\n+  }, \n+  \"ansible_accelerate_port\":
        5099, \n+  \"roledir\": null, \n+  \"ansible_ssh_extra_args\": \"\", \n+  \"ansible_ssh_host\":
        \"el6host\", \n+  \"ansible_current_hosts\": [\n+    \"el6host\"\n+  ], \n+
        \ \"hostvars\": {\n+    \"el6host\": {\n+      \"inventory_file\": \"inventory\",
        \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ], \n+      \"groups\":
        {\n+        \"ungrouped\": [\n+          \"el6host\"\n+        ], \n+        \"all\":
        [\n+          \"el6host\"\n+        ]\n+      }, \n+      \"inventory_hostname\":
        \"el6host\", \n+      \"inventory_hostname_short\": \"el6host\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"omit\": \"__omit_place_holder__03600813b83569c710bf5cb2a040d6e01da927c6\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }\n+  }, \n+  \"group_names\": [\n+
        \   \"ungrouped\"\n+  ], \n+  \"ansible_version\": {\n+    \"major\": 2, \n+
        \   \"full\": \"2.2.0\", \n+    \"string\": \"2.2.0\", \n+    \"minor\": 2,
        \n+    \"revision\": 0\n+  }, \n+  \"ansible_ssh_pipelining\": false, \n+
        \ \"inventory_file\": \"inventory\", \n+  \"ansible_module_compression\":
        \"ZIP_DEFLATED\", \n+  \"ansible_failed_hosts\": [], \n+  \"ansible_check_mode\":
        false, \n+  \"groups\": {\n+    \"ungrouped\": [\n+      \"el6host\"\n+    ],
        \n+    \"all\": [\n+      \"el6host\"\n+    ]\n+  }, \n+  \"ansible_host\":
        \"el6host\", \n+  \"ansible_shell_executable\": \"/bin/sh\", \n+  \"inventory_hostname_short\":
        \"el6host\", \n+  \"omit\": \"__omit_place_holder__03600813b83569c710bf5cb2a040d6e01da927c6\",
        \n+  \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+  \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+  \"ansible_ssh_user\": \"root\",
        \n+  \"role_names\": [], \n+  \"play_hosts\": [\n+    \"el6host\"\n+  ], \n+
        \ \"ansible_sftp_extra_args\": \"\"\n+}\n\\ No newline at end of file\ndiff
        --git a/test/units/plugins/action/fixtures/synchronize/basic_with_private_key/taskvars_out.json
        b/test/units/plugins/action/fixtures/synchronize/basic_with_private_key/taskvars_out.json\nnew
        file mode 100644\nindex 0000000000000..01ebee25296cf\n--- /dev/null\n+++ b/test/units/plugins/action/fixtures/synchronize/basic_with_private_key/taskvars_out.json\n@@
        -0,0 +1,156 @@\n+{\n+  \"ansible_pipelining\": false, \n+  \"ansible_docker_extra_args\":
        \"\", \n+  \"ansible_scp_extra_args\": \"\", \n+  \"ansible_user\": \"root\",
        \n+  \"ansible_play_hosts\": [\n+    \"el6host\"\n+  ], \n+  \"ansible_connection\":
        \"smart\", \n+  \"ansible_ssh_common_args\": \"\", \n+  \"environment\": [],
        \n+  \"inventory_hostname\": \"el6host\", \n+  \"vars\": {\n+    \"ansible_check_mode\":
        false, \n+    \"inventory_hostname\": \"el6host\", \n+    \"inventory_file\":
        \"inventory\", \n+    \"inventory_hostname_short\": \"el6host\", \n+    \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+    \"role_names\": [], \n+
        \   \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+    \"environment\":
        [], \n+    \"play_hosts\": [\n+      \"el6host\"\n+    ], \n+    \"ansible_play_hosts\":
        [\n+      \"el6host\"\n+    ], \n+    \"hostvars\": {\n+      \"el6host\":
        {\n+        \"inventory_file\": \"inventory\", \n+        \"group_names\":
        [\n+          \"ungrouped\"\n+        ], \n+        \"groups\": {\n+          \"ungrouped\":
        [\n+            \"el6host\", \n+            \"::1\"\n+          ], \n+          \"all\":
        [\n+            \"el6host\", \n+            \"::1\"\n+          ]\n+        },
        \n+        \"inventory_hostname\": \"el6host\", \n+        \"inventory_hostname_short\":
        \"el6host\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"omit\": \"__omit_place_holder__03600813b83569c710bf5cb2a040d6e01da927c6\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }\n+    }, \n+    \"groups\":
        {\n+      \"ungrouped\": [\n+        \"el6host\"\n+      ], \n+      \"all\":
        [\n+        \"el6host\"\n+      ]\n+    }, \n+    \"group_names\": [\n+      \"ungrouped\"\n+
        \   ], \n+    \"omit\": \"__omit_place_holder__03600813b83569c710bf5cb2a040d6e01da927c6\",
        \n+    \"ansible_version\": {\n+      \"major\": 2, \n+      \"full\": \"2.2.0\",
        \n+      \"string\": \"2.2.0\", \n+      \"minor\": 2, \n+      \"revision\":
        0\n+    }, \n+    \"ansible_ssh_user\": \"root\"\n+  }, \n+  \"ansible_accelerate_port\":
        5099, \n+  \"roledir\": null, \n+  \"ansible_ssh_extra_args\": \"\", \n+  \"ansible_ssh_host\":
        \"el6host\", \n+  \"ansible_current_hosts\": [\n+    \"el6host\"\n+  ], \n+
        \ \"hostvars\": {\n+    \"el6host\": {\n+      \"inventory_file\": \"inventory\",
        \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ], \n+      \"groups\":
        {\n+        \"ungrouped\": [\n+          \"el6host\", \n+          \"::1\"\n+
        \       ], \n+        \"all\": [\n+          \"el6host\", \n+          \"::1\"\n+
        \       ]\n+      }, \n+      \"inventory_hostname\": \"el6host\", \n+      \"inventory_hostname_short\":
        \"el6host\", \n+      \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__03600813b83569c710bf5cb2a040d6e01da927c6\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }\n+  }, \n+  \"group_names\": [\n+
        \   \"ungrouped\"\n+  ], \n+  \"ansible_version\": {\n+    \"major\": 2, \n+
        \   \"full\": \"2.2.0\", \n+    \"string\": \"2.2.0\", \n+    \"minor\": 2,
        \n+    \"revision\": 0\n+  }, \n+  \"ansible_ssh_pipelining\": false, \n+
        \ \"inventory_file\": \"inventory\", \n+  \"ansible_module_compression\":
        \"ZIP_DEFLATED\", \n+  \"ansible_failed_hosts\": [], \n+  \"ansible_check_mode\":
        false, \n+  \"groups\": {\n+    \"ungrouped\": [\n+      \"el6host\"\n+    ],
        \n+    \"all\": [\n+      \"el6host\"\n+    ]\n+  }, \n+  \"ansible_host\":
        \"el6host\", \n+  \"ansible_shell_executable\": \"/bin/sh\", \n+  \"inventory_hostname_short\":
        \"el6host\", \n+  \"omit\": \"__omit_place_holder__03600813b83569c710bf5cb2a040d6e01da927c6\",
        \n+  \"ansible_python_interpreter\": \"/usr/bin/python\", \n+  \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+  \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+  \"ansible_ssh_user\": \"root\", \n+  \"role_names\": [], \n+  \"play_hosts\":
        [\n+    \"el6host\"\n+  ], \n+  \"ansible_sftp_extra_args\": \"\"\n+}\n\\
        No newline at end of file\ndiff --git a/test/units/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/meta.yaml
        b/test/units/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/meta.yaml\nnew
        file mode 100644\nindex 0000000000000..31939caffdc61\n--- /dev/null\n+++ b/test/units/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/meta.yaml\n@@
        -0,0 +1,28 @@\n+fixtures:\n+    taskvars_in: task_vars_in.json\n+    taskvars_out:
        task_vars_out.json\n+task_args:\n+    src: /tmp/deleteme\n+    dest: /tmp/deleteme\n+_task:\n+
        \   delegate_to: u1404    \n+_play_context:\n+    shell: None\n+    remote_addr:
        u1404\n+    remote_user: root\n+    private_key_file: ~/test.pem\n+connection:\n+
        \   transport: 'ssh'\n+hostvars:\n+    '127.0.0.1': {}\n+    '::1': {}\n+
        \   'localhost': {}\n+asserts:\n+    - \"hasattr(SAM._connection, 'ismock')\"\n+
        \   - \"SAM._connection.transport == 'ssh'\"\n+    - \"self._play_context.shell
        == None\"\n+    - \"self.execute_called\"\n+    - \"self.final_module_args['_local_rsync_path']
        == 'rsync'\"\n+    - \"self.final_module_args['src'] == '/tmp/deleteme'\"\n+
        \   - \"self.final_module_args['dest'] == 'root@el6host:/tmp/deleteme'\"\n+
        \   - \"self.final_module_args['private_key'] == '~/test.pem'\"\ndiff --git
        a/test/units/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/task_vars_in.json
        b/test/units/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/task_vars_in.json\nnew
        file mode 100644\nindex 0000000000000..b8893eef85cf8\n--- /dev/null\n+++ b/test/units/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/task_vars_in.json\n@@
        -0,0 +1,379 @@\n+{\n+  \"ansible_pipelining\": false, \n+  \"ansible_docker_extra_args\":
        \"\", \n+  \"ansible_scp_extra_args\": \"\", \n+  \"ansible_user\": \"root\",
        \n+  \"ansible_play_hosts\": [\n+    \"el6host\"\n+  ], \n+  \"ansible_connection\":
        \"smart\", \n+  \"ansible_ssh_common_args\": \"\", \n+  \"environment\": [],
        \n+  \"inventory_hostname\": \"el6host\", \n+  \"vars\": {\n+    \"ansible_check_mode\":
        false, \n+    \"inventory_hostname\": \"el6host\", \n+    \"inventory_file\":
        \"inventory\", \n+    \"ansible_delegated_vars\": {\n+      \"u1404\": {\n+
        \       \"inventory_hostname\": \"u1404\", \n+        \"inventory_file\":
        \"inventory\", \n+        \"vars\": {\n+          \"inventory_file\": \"inventory\",
        \n+          \"role_names\": [], \n+          \"ansible_play_hosts\": [\n+
        \           \"el6host\"\n+          ], \n+          \"groups\": {\n+            \"ungrouped\":
        [\n+              \"el6host\", \n+              \"u1404\"\n+            ],
        \n+            \"all\": [\n+              \"el6host\", \n+              \"u1404\"\n+
        \           ]\n+          }, \n+          \"ansible_check_mode\": false, \n+
        \         \"inventory_hostname\": \"u1404\", \n+          \"inventory_hostname_short\":
        \"u1404\", \n+          \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+          \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+          \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+          \"environment\": [], \n+          \"ansible_ssh_user\": \"root\",
        \n+          \"group_names\": [\n+            \"ungrouped\"\n+          ],
        \n+          \"play_hosts\": [\n+            \"el6host\"\n+          ], \n+
        \         \"ansible_version\": {\n+            \"major\": 2, \n+            \"full\":
        \"2.2.0\", \n+            \"string\": \"2.2.0\", \n+            \"minor\":
        2, \n+            \"revision\": 0\n+          }\n+        }, \n+        \"inventory_hostname_short\":
        \"u1404\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"group_names\": [\n+          \"ungrouped\"\n+        ], \n+        \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"ansible_host\": \"u1404\", \n+        \"environment\": [], \n+
        \       \"ansible_play_hosts\": [\n+          \"el6host\"\n+        ], \n+
        \       \"groups\": {\n+          \"ungrouped\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ]\n+        }, \n+        \"ansible_check_mode\":
        false, \n+        \"play_hosts\": [\n+          \"el6host\"\n+        ], \n+
        \       \"role_names\": [], \n+        \"ansible_port\": null, \n+        \"ansible_version\":
        {\n+          \"major\": 2, \n+          \"full\": \"2.2.0\", \n+          \"string\":
        \"2.2.0\", \n+          \"minor\": 2, \n+          \"revision\": 0\n+        },
        \n+        \"ansible_ssh_user\": \"root\"\n+      }\n+    }, \n+    \"inventory_hostname_short\":
        \"el6host\", \n+    \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+    \"role_names\": [], \n+    \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+    \"environment\": [], \n+    \"play_hosts\": [\n+      \"el6host\"\n+
        \   ], \n+    \"ansible_play_hosts\": [\n+      \"el6host\"\n+    ], \n+    \"hostvars\":
        {\n+      \"el6host\": {\n+        \"inventory_file\": \"inventory\", \n+
        \       \"group_names\": [\n+          \"ungrouped\"\n+        ], \n+        \"groups\":
        {\n+          \"ungrouped\": [\n+            \"el6host\", \n+            \"u1404\"\n+
        \         ], \n+          \"all\": [\n+            \"el6host\", \n+            \"u1404\"\n+
        \         ]\n+        }, \n+        \"inventory_hostname\": \"el6host\", \n+
        \       \"inventory_hostname_short\": \"el6host\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }, \n+      \"u1404\": {\n+
        \       \"inventory_file\": \"inventory\", \n+        \"group_names\": [\n+
        \         \"ungrouped\"\n+        ], \n+        \"groups\": {\n+          \"ungrouped\":
        [\n+            \"el6host\", \n+            \"u1404\"\n+          ], \n+          \"all\":
        [\n+            \"el6host\", \n+            \"u1404\"\n+          ]\n+        },
        \n+        \"inventory_hostname\": \"u1404\", \n+        \"inventory_hostname_short\":
        \"u1404\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }\n+    }, \n+    \"groups\":
        {\n+      \"ungrouped\": [\n+        \"el6host\", \n+        \"u1404\"\n+
        \     ], \n+      \"all\": [\n+        \"el6host\", \n+        \"u1404\"\n+
        \     ]\n+    }, \n+    \"group_names\": [\n+      \"ungrouped\"\n+    ],
        \n+    \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+    \"ansible_version\": {\n+      \"major\": 2, \n+      \"full\": \"2.2.0\",
        \n+      \"string\": \"2.2.0\", \n+      \"minor\": 2, \n+      \"revision\":
        0\n+    }, \n+    \"ansible_ssh_user\": \"root\"\n+  }, \n+  \"ansible_accelerate_port\":
        5099, \n+  \"roledir\": null, \n+  \"ansible_ssh_extra_args\": \"\", \n+  \"ansible_ssh_host\":
        \"u1404\", \n+  \"ansible_current_hosts\": [\n+    \"el6host\"\n+  ], \n+
        \ \"hostvars\": {\n+    \"el6host\": {\n+      \"inventory_file\": \"inventory\",
        \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ], \n+      \"groups\":
        {\n+        \"ungrouped\": [\n+          \"el6host\", \n+          \"u1404\"\n+
        \       ], \n+        \"all\": [\n+          \"el6host\", \n+          \"u1404\"\n+
        \       ]\n+      }, \n+      \"inventory_hostname\": \"el6host\", \n+      \"inventory_hostname_short\":
        \"el6host\", \n+      \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }, \n+    \"u1404\": {\n+      \"inventory_file\":
        \"inventory\", \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ],
        \n+      \"groups\": {\n+        \"ungrouped\": [\n+          \"el6host\",
        \n+          \"u1404\"\n+        ], \n+        \"all\": [\n+          \"el6host\",
        \n+          \"u1404\"\n+        ]\n+      }, \n+      \"inventory_hostname\":
        \"u1404\", \n+      \"inventory_hostname_short\": \"u1404\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }\n+  }, \n+  \"group_names\": [\n+
        \   \"ungrouped\"\n+  ], \n+  \"ansible_version\": {\n+    \"major\": 2, \n+
        \   \"full\": \"2.2.0\", \n+    \"string\": \"2.2.0\", \n+    \"minor\": 2,
        \n+    \"revision\": 0\n+  }, \n+  \"ansible_ssh_pipelining\": false, \n+
        \ \"inventory_file\": \"inventory\", \n+  \"ansible_delegated_vars\": {\n+
        \   \"u1404\": {\n+      \"inventory_hostname\": \"u1404\", \n+      \"inventory_file\":
        \"inventory\", \n+      \"vars\": {\n+        \"ansible_check_mode\": false,
        \n+        \"inventory_hostname\": \"u1404\", \n+        \"inventory_file\":
        \"inventory\", \n+        \"inventory_hostname_short\": \"u1404\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"environment\": [], \n+        \"ansible_ssh_user\": \"root\",
        \n+        \"ansible_play_hosts\": [\n+          \"el6host\"\n+        ],
        \n+        \"groups\": {\n+          \"ungrouped\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ]\n+        }, \n+        \"group_names\":
        [\n+          \"ungrouped\"\n+        ], \n+        \"play_hosts\": [\n+          \"el6host\"\n+
        \       ], \n+        \"ansible_version\": {\n+          \"major\": 2, \n+
        \         \"full\": \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\":
        2, \n+          \"revision\": 0\n+        }, \n+        \"role_names\": []\n+
        \     }, \n+      \"inventory_hostname_short\": \"u1404\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"group_names\": [\n+
        \       \"ungrouped\"\n+      ], \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"ansible_host\": \"u1404\", \n+      \"environment\": [], \n+      \"ansible_play_hosts\":
        [\n+        \"el6host\"\n+      ], \n+      \"groups\": {\n+        \"ungrouped\":
        [\n+          \"el6host\", \n+          \"u1404\"\n+        ], \n+        \"all\":
        [\n+          \"el6host\", \n+          \"u1404\"\n+        ]\n+      }, \n+
        \     \"ansible_check_mode\": false, \n+      \"play_hosts\": [\n+        \"el6host\"\n+
        \     ], \n+      \"role_names\": [], \n+      \"ansible_port\": null, \n+
        \     \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }, \n+      \"ansible_ssh_user\": \"root\"\n+
        \   }\n+  }, \n+  \"ansible_module_compression\": \"ZIP_DEFLATED\", \n+  \"ansible_failed_hosts\":
        [], \n+  \"ansible_check_mode\": false, \n+  \"groups\": {\n+    \"ungrouped\":
        [\n+      \"el6host\", \n+      \"u1404\"\n+    ], \n+    \"all\": [\n+      \"el6host\",
        \n+      \"u1404\"\n+    ]\n+  }, \n+  \"ansible_host\": \"u1404\", \n+  \"ansible_shell_executable\":
        \"/bin/sh\", \n+  \"inventory_hostname_short\": \"el6host\", \n+  \"omit\":
        \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\", \n+  \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+  \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+  \"ansible_ssh_user\": \"root\", \n+  \"role_names\": [], \n+  \"play_hosts\":
        [\n+    \"el6host\"\n+  ], \n+  \"ansible_sftp_extra_args\": \"\"\n+}\n\\
        No newline at end of file\ndiff --git a/test/units/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/task_vars_out.json
        b/test/units/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/task_vars_out.json\nnew
        file mode 100644\nindex 0000000000000..0b551f041d412\n--- /dev/null\n+++ b/test/units/plugins/action/fixtures/synchronize/delegate_remote_play_context_private_key/task_vars_out.json\n@@
        -0,0 +1,387 @@\n+{\n+  \"ansible_pipelining\": false, \n+  \"ansible_docker_extra_args\":
        \"\", \n+  \"ansible_scp_extra_args\": \"\", \n+  \"ansible_user\": \"root\",
        \n+  \"ansible_play_hosts\": [\n+    \"el6host\"\n+  ], \n+  \"ansible_connection\":
        \"smart\", \n+  \"ansible_ssh_common_args\": \"\", \n+  \"environment\": [],
        \n+  \"inventory_hostname\": \"el6host\", \n+  \"vars\": {\n+    \"ansible_check_mode\":
        false, \n+    \"inventory_hostname\": \"el6host\", \n+    \"inventory_file\":
        \"inventory\", \n+    \"ansible_delegated_vars\": {\n+      \"u1404\": {\n+
        \       \"inventory_hostname\": \"u1404\", \n+        \"inventory_file\":
        \"inventory\", \n+        \"vars\": {\n+          \"inventory_file\": \"inventory\",
        \n+          \"role_names\": [], \n+          \"ansible_play_hosts\": [\n+
        \           \"el6host\"\n+          ], \n+          \"groups\": {\n+            \"ungrouped\":
        [\n+              \"el6host\", \n+              \"u1404\"\n+            ],
        \n+            \"all\": [\n+              \"el6host\", \n+              \"u1404\"\n+
        \           ]\n+          }, \n+          \"ansible_check_mode\": false, \n+
        \         \"inventory_hostname\": \"u1404\", \n+          \"inventory_hostname_short\":
        \"u1404\", \n+          \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+          \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+          \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+          \"environment\": [], \n+          \"ansible_ssh_user\": \"root\",
        \n+          \"group_names\": [\n+            \"ungrouped\"\n+          ],
        \n+          \"play_hosts\": [\n+            \"el6host\"\n+          ], \n+
        \         \"ansible_version\": {\n+            \"major\": 2, \n+            \"full\":
        \"2.2.0\", \n+            \"string\": \"2.2.0\", \n+            \"minor\":
        2, \n+            \"revision\": 0\n+          }\n+        }, \n+        \"inventory_hostname_short\":
        \"u1404\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"group_names\": [\n+          \"ungrouped\"\n+        ], \n+        \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"ansible_host\": \"u1404\", \n+        \"environment\": [], \n+
        \       \"ansible_play_hosts\": [\n+          \"el6host\"\n+        ], \n+
        \       \"groups\": {\n+          \"ungrouped\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ]\n+        }, \n+        \"ansible_check_mode\":
        false, \n+        \"play_hosts\": [\n+          \"el6host\"\n+        ], \n+
        \       \"role_names\": [], \n+        \"ansible_port\": null, \n+        \"ansible_version\":
        {\n+          \"major\": 2, \n+          \"full\": \"2.2.0\", \n+          \"string\":
        \"2.2.0\", \n+          \"minor\": 2, \n+          \"revision\": 0\n+        },
        \n+        \"ansible_ssh_user\": \"root\"\n+      }\n+    }, \n+    \"inventory_hostname_short\":
        \"el6host\", \n+    \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+    \"role_names\": [], \n+    \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+    \"environment\": [], \n+    \"play_hosts\": [\n+      \"el6host\"\n+
        \   ], \n+    \"ansible_play_hosts\": [\n+      \"el6host\"\n+    ], \n+    \"hostvars\":
        {\n+      \"el6host\": {\n+        \"inventory_file\": \"inventory\", \n+
        \       \"group_names\": [\n+          \"ungrouped\"\n+        ], \n+        \"groups\":
        {\n+          \"ungrouped\": [\n+            \"el6host\", \n+            \"u1404\",
        \n+            \"::1\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\", \n+            \"::1\"\n+          ]\n+        },
        \n+        \"inventory_hostname\": \"el6host\", \n+        \"inventory_hostname_short\":
        \"el6host\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }, \n+      \"u1404\": {\n+
        \       \"inventory_file\": \"inventory\", \n+        \"group_names\": [\n+
        \         \"ungrouped\"\n+        ], \n+        \"groups\": {\n+          \"ungrouped\":
        [\n+            \"el6host\", \n+            \"u1404\", \n+            \"::1\"\n+
        \         ], \n+          \"all\": [\n+            \"el6host\", \n+            \"u1404\",
        \n+            \"::1\"\n+          ]\n+        }, \n+        \"inventory_hostname\":
        \"u1404\", \n+        \"inventory_hostname_short\": \"u1404\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }\n+    }, \n+    \"groups\":
        {\n+      \"ungrouped\": [\n+        \"el6host\", \n+        \"u1404\"\n+
        \     ], \n+      \"all\": [\n+        \"el6host\", \n+        \"u1404\"\n+
        \     ]\n+    }, \n+    \"group_names\": [\n+      \"ungrouped\"\n+    ],
        \n+    \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+    \"ansible_version\": {\n+      \"major\": 2, \n+      \"full\": \"2.2.0\",
        \n+      \"string\": \"2.2.0\", \n+      \"minor\": 2, \n+      \"revision\":
        0\n+    }, \n+    \"ansible_ssh_user\": \"root\"\n+  }, \n+  \"ansible_accelerate_port\":
        5099, \n+  \"roledir\": null, \n+  \"ansible_ssh_extra_args\": \"\", \n+  \"ansible_ssh_host\":
        \"u1404\", \n+  \"ansible_current_hosts\": [\n+    \"el6host\"\n+  ], \n+
        \ \"hostvars\": {\n+    \"el6host\": {\n+      \"inventory_file\": \"inventory\",
        \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ], \n+      \"groups\":
        {\n+        \"ungrouped\": [\n+          \"el6host\", \n+          \"u1404\",
        \n+          \"::1\"\n+        ], \n+        \"all\": [\n+          \"el6host\",
        \n+          \"u1404\", \n+          \"::1\"\n+        ]\n+      }, \n+      \"inventory_hostname\":
        \"el6host\", \n+      \"inventory_hostname_short\": \"el6host\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }, \n+    \"u1404\": {\n+      \"inventory_file\":
        \"inventory\", \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ],
        \n+      \"groups\": {\n+        \"ungrouped\": [\n+          \"el6host\",
        \n+          \"u1404\", \n+          \"::1\"\n+        ], \n+        \"all\":
        [\n+          \"el6host\", \n+          \"u1404\", \n+          \"::1\"\n+
        \       ]\n+      }, \n+      \"inventory_hostname\": \"u1404\", \n+      \"inventory_hostname_short\":
        \"u1404\", \n+      \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }\n+  }, \n+  \"group_names\": [\n+
        \   \"ungrouped\"\n+  ], \n+  \"ansible_version\": {\n+    \"major\": 2, \n+
        \   \"full\": \"2.2.0\", \n+    \"string\": \"2.2.0\", \n+    \"minor\": 2,
        \n+    \"revision\": 0\n+  }, \n+  \"ansible_ssh_pipelining\": false, \n+
        \ \"inventory_file\": \"inventory\", \n+  \"ansible_delegated_vars\": {\n+
        \   \"u1404\": {\n+      \"inventory_hostname\": \"u1404\", \n+      \"inventory_file\":
        \"inventory\", \n+      \"vars\": {\n+        \"ansible_check_mode\": false,
        \n+        \"inventory_hostname\": \"u1404\", \n+        \"inventory_file\":
        \"inventory\", \n+        \"inventory_hostname_short\": \"u1404\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"environment\": [], \n+        \"ansible_ssh_user\": \"root\",
        \n+        \"ansible_play_hosts\": [\n+          \"el6host\"\n+        ],
        \n+        \"groups\": {\n+          \"ungrouped\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ]\n+        }, \n+        \"group_names\":
        [\n+          \"ungrouped\"\n+        ], \n+        \"play_hosts\": [\n+          \"el6host\"\n+
        \       ], \n+        \"ansible_version\": {\n+          \"major\": 2, \n+
        \         \"full\": \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\":
        2, \n+          \"revision\": 0\n+        }, \n+        \"role_names\": []\n+
        \     }, \n+      \"inventory_hostname_short\": \"u1404\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"group_names\": [\n+
        \       \"ungrouped\"\n+      ], \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"ansible_host\": \"u1404\", \n+      \"environment\": [], \n+      \"ansible_play_hosts\":
        [\n+        \"el6host\"\n+      ], \n+      \"groups\": {\n+        \"ungrouped\":
        [\n+          \"el6host\", \n+          \"u1404\"\n+        ], \n+        \"all\":
        [\n+          \"el6host\", \n+          \"u1404\"\n+        ]\n+      }, \n+
        \     \"ansible_check_mode\": false, \n+      \"play_hosts\": [\n+        \"el6host\"\n+
        \     ], \n+      \"role_names\": [], \n+      \"ansible_port\": null, \n+
        \     \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }, \n+      \"ansible_ssh_user\": \"root\"\n+
        \   }\n+  }, \n+  \"ansible_module_compression\": \"ZIP_DEFLATED\", \n+  \"ansible_failed_hosts\":
        [], \n+  \"ansible_check_mode\": false, \n+  \"groups\": {\n+    \"ungrouped\":
        [\n+      \"el6host\", \n+      \"u1404\"\n+    ], \n+    \"all\": [\n+      \"el6host\",
        \n+      \"u1404\"\n+    ]\n+  }, \n+  \"ansible_host\": \"u1404\", \n+  \"ansible_shell_executable\":
        \"/bin/sh\", \n+  \"inventory_hostname_short\": \"el6host\", \n+  \"omit\":
        \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\", \n+  \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+  \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+  \"ansible_ssh_user\": \"root\", \n+  \"role_names\": [], \n+  \"play_hosts\":
        [\n+    \"el6host\"\n+  ], \n+  \"ansible_sftp_extra_args\": \"\"\n+}\n\\
        No newline at end of file\ndiff --git a/test/units/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/meta.yaml
        b/test/units/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/meta.yaml\nnew
        file mode 100644\nindex 0000000000000..1242b1d390c95\n--- /dev/null\n+++ b/test/units/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/meta.yaml\n@@
        -0,0 +1,29 @@\n+fixtures:\n+    taskvars_in: task_vars_in.json\n+    taskvars_out:
        task_vars_out.json\n+task_args:\n+    src: /tmp/deleteme\n+    dest: /tmp/deleteme\n+
        \   private_key: ~/.ssh/id_rsa\n+_task:\n+    delegate_to: u1404    \n+_play_context:\n+
        \   shell: None\n+    remote_addr: u1404\n+    remote_user: root\n+    private_key_file:
        ~/test.pem\n+connection:\n+    transport: 'ssh'\n+hostvars:\n+    '127.0.0.1':
        {}\n+    '::1': {}\n+    'localhost': {}\n+asserts:\n+    - \"hasattr(SAM._connection,
        'ismock')\"\n+    - \"SAM._connection.transport == 'ssh'\"\n+    - \"self._play_context.shell
        == None\"\n+    - \"self.execute_called\"\n+    - \"self.final_module_args['_local_rsync_path']
        == 'rsync'\"\n+    - \"self.final_module_args['src'] == '/tmp/deleteme'\"\n+
        \   - \"self.final_module_args['dest'] == 'root@el6host:/tmp/deleteme'\"\n+
        \   - \"self.final_module_args['private_key'] == '~/.ssh/id_rsa'\"\ndiff --git
        a/test/units/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/task_vars_in.json
        b/test/units/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/task_vars_in.json\nnew
        file mode 100644\nindex 0000000000000..b8893eef85cf8\n--- /dev/null\n+++ b/test/units/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/task_vars_in.json\n@@
        -0,0 +1,379 @@\n+{\n+  \"ansible_pipelining\": false, \n+  \"ansible_docker_extra_args\":
        \"\", \n+  \"ansible_scp_extra_args\": \"\", \n+  \"ansible_user\": \"root\",
        \n+  \"ansible_play_hosts\": [\n+    \"el6host\"\n+  ], \n+  \"ansible_connection\":
        \"smart\", \n+  \"ansible_ssh_common_args\": \"\", \n+  \"environment\": [],
        \n+  \"inventory_hostname\": \"el6host\", \n+  \"vars\": {\n+    \"ansible_check_mode\":
        false, \n+    \"inventory_hostname\": \"el6host\", \n+    \"inventory_file\":
        \"inventory\", \n+    \"ansible_delegated_vars\": {\n+      \"u1404\": {\n+
        \       \"inventory_hostname\": \"u1404\", \n+        \"inventory_file\":
        \"inventory\", \n+        \"vars\": {\n+          \"inventory_file\": \"inventory\",
        \n+          \"role_names\": [], \n+          \"ansible_play_hosts\": [\n+
        \           \"el6host\"\n+          ], \n+          \"groups\": {\n+            \"ungrouped\":
        [\n+              \"el6host\", \n+              \"u1404\"\n+            ],
        \n+            \"all\": [\n+              \"el6host\", \n+              \"u1404\"\n+
        \           ]\n+          }, \n+          \"ansible_check_mode\": false, \n+
        \         \"inventory_hostname\": \"u1404\", \n+          \"inventory_hostname_short\":
        \"u1404\", \n+          \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+          \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+          \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+          \"environment\": [], \n+          \"ansible_ssh_user\": \"root\",
        \n+          \"group_names\": [\n+            \"ungrouped\"\n+          ],
        \n+          \"play_hosts\": [\n+            \"el6host\"\n+          ], \n+
        \         \"ansible_version\": {\n+            \"major\": 2, \n+            \"full\":
        \"2.2.0\", \n+            \"string\": \"2.2.0\", \n+            \"minor\":
        2, \n+            \"revision\": 0\n+          }\n+        }, \n+        \"inventory_hostname_short\":
        \"u1404\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"group_names\": [\n+          \"ungrouped\"\n+        ], \n+        \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"ansible_host\": \"u1404\", \n+        \"environment\": [], \n+
        \       \"ansible_play_hosts\": [\n+          \"el6host\"\n+        ], \n+
        \       \"groups\": {\n+          \"ungrouped\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ]\n+        }, \n+        \"ansible_check_mode\":
        false, \n+        \"play_hosts\": [\n+          \"el6host\"\n+        ], \n+
        \       \"role_names\": [], \n+        \"ansible_port\": null, \n+        \"ansible_version\":
        {\n+          \"major\": 2, \n+          \"full\": \"2.2.0\", \n+          \"string\":
        \"2.2.0\", \n+          \"minor\": 2, \n+          \"revision\": 0\n+        },
        \n+        \"ansible_ssh_user\": \"root\"\n+      }\n+    }, \n+    \"inventory_hostname_short\":
        \"el6host\", \n+    \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+    \"role_names\": [], \n+    \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+    \"environment\": [], \n+    \"play_hosts\": [\n+      \"el6host\"\n+
        \   ], \n+    \"ansible_play_hosts\": [\n+      \"el6host\"\n+    ], \n+    \"hostvars\":
        {\n+      \"el6host\": {\n+        \"inventory_file\": \"inventory\", \n+
        \       \"group_names\": [\n+          \"ungrouped\"\n+        ], \n+        \"groups\":
        {\n+          \"ungrouped\": [\n+            \"el6host\", \n+            \"u1404\"\n+
        \         ], \n+          \"all\": [\n+            \"el6host\", \n+            \"u1404\"\n+
        \         ]\n+        }, \n+        \"inventory_hostname\": \"el6host\", \n+
        \       \"inventory_hostname_short\": \"el6host\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }, \n+      \"u1404\": {\n+
        \       \"inventory_file\": \"inventory\", \n+        \"group_names\": [\n+
        \         \"ungrouped\"\n+        ], \n+        \"groups\": {\n+          \"ungrouped\":
        [\n+            \"el6host\", \n+            \"u1404\"\n+          ], \n+          \"all\":
        [\n+            \"el6host\", \n+            \"u1404\"\n+          ]\n+        },
        \n+        \"inventory_hostname\": \"u1404\", \n+        \"inventory_hostname_short\":
        \"u1404\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }\n+    }, \n+    \"groups\":
        {\n+      \"ungrouped\": [\n+        \"el6host\", \n+        \"u1404\"\n+
        \     ], \n+      \"all\": [\n+        \"el6host\", \n+        \"u1404\"\n+
        \     ]\n+    }, \n+    \"group_names\": [\n+      \"ungrouped\"\n+    ],
        \n+    \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+    \"ansible_version\": {\n+      \"major\": 2, \n+      \"full\": \"2.2.0\",
        \n+      \"string\": \"2.2.0\", \n+      \"minor\": 2, \n+      \"revision\":
        0\n+    }, \n+    \"ansible_ssh_user\": \"root\"\n+  }, \n+  \"ansible_accelerate_port\":
        5099, \n+  \"roledir\": null, \n+  \"ansible_ssh_extra_args\": \"\", \n+  \"ansible_ssh_host\":
        \"u1404\", \n+  \"ansible_current_hosts\": [\n+    \"el6host\"\n+  ], \n+
        \ \"hostvars\": {\n+    \"el6host\": {\n+      \"inventory_file\": \"inventory\",
        \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ], \n+      \"groups\":
        {\n+        \"ungrouped\": [\n+          \"el6host\", \n+          \"u1404\"\n+
        \       ], \n+        \"all\": [\n+          \"el6host\", \n+          \"u1404\"\n+
        \       ]\n+      }, \n+      \"inventory_hostname\": \"el6host\", \n+      \"inventory_hostname_short\":
        \"el6host\", \n+      \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }, \n+    \"u1404\": {\n+      \"inventory_file\":
        \"inventory\", \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ],
        \n+      \"groups\": {\n+        \"ungrouped\": [\n+          \"el6host\",
        \n+          \"u1404\"\n+        ], \n+        \"all\": [\n+          \"el6host\",
        \n+          \"u1404\"\n+        ]\n+      }, \n+      \"inventory_hostname\":
        \"u1404\", \n+      \"inventory_hostname_short\": \"u1404\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }\n+  }, \n+  \"group_names\": [\n+
        \   \"ungrouped\"\n+  ], \n+  \"ansible_version\": {\n+    \"major\": 2, \n+
        \   \"full\": \"2.2.0\", \n+    \"string\": \"2.2.0\", \n+    \"minor\": 2,
        \n+    \"revision\": 0\n+  }, \n+  \"ansible_ssh_pipelining\": false, \n+
        \ \"inventory_file\": \"inventory\", \n+  \"ansible_delegated_vars\": {\n+
        \   \"u1404\": {\n+      \"inventory_hostname\": \"u1404\", \n+      \"inventory_file\":
        \"inventory\", \n+      \"vars\": {\n+        \"ansible_check_mode\": false,
        \n+        \"inventory_hostname\": \"u1404\", \n+        \"inventory_file\":
        \"inventory\", \n+        \"inventory_hostname_short\": \"u1404\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"environment\": [], \n+        \"ansible_ssh_user\": \"root\",
        \n+        \"ansible_play_hosts\": [\n+          \"el6host\"\n+        ],
        \n+        \"groups\": {\n+          \"ungrouped\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ]\n+        }, \n+        \"group_names\":
        [\n+          \"ungrouped\"\n+        ], \n+        \"play_hosts\": [\n+          \"el6host\"\n+
        \       ], \n+        \"ansible_version\": {\n+          \"major\": 2, \n+
        \         \"full\": \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\":
        2, \n+          \"revision\": 0\n+        }, \n+        \"role_names\": []\n+
        \     }, \n+      \"inventory_hostname_short\": \"u1404\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"group_names\": [\n+
        \       \"ungrouped\"\n+      ], \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"ansible_host\": \"u1404\", \n+      \"environment\": [], \n+      \"ansible_play_hosts\":
        [\n+        \"el6host\"\n+      ], \n+      \"groups\": {\n+        \"ungrouped\":
        [\n+          \"el6host\", \n+          \"u1404\"\n+        ], \n+        \"all\":
        [\n+          \"el6host\", \n+          \"u1404\"\n+        ]\n+      }, \n+
        \     \"ansible_check_mode\": false, \n+      \"play_hosts\": [\n+        \"el6host\"\n+
        \     ], \n+      \"role_names\": [], \n+      \"ansible_port\": null, \n+
        \     \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }, \n+      \"ansible_ssh_user\": \"root\"\n+
        \   }\n+  }, \n+  \"ansible_module_compression\": \"ZIP_DEFLATED\", \n+  \"ansible_failed_hosts\":
        [], \n+  \"ansible_check_mode\": false, \n+  \"groups\": {\n+    \"ungrouped\":
        [\n+      \"el6host\", \n+      \"u1404\"\n+    ], \n+    \"all\": [\n+      \"el6host\",
        \n+      \"u1404\"\n+    ]\n+  }, \n+  \"ansible_host\": \"u1404\", \n+  \"ansible_shell_executable\":
        \"/bin/sh\", \n+  \"inventory_hostname_short\": \"el6host\", \n+  \"omit\":
        \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\", \n+  \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+  \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+  \"ansible_ssh_user\": \"root\", \n+  \"role_names\": [], \n+  \"play_hosts\":
        [\n+    \"el6host\"\n+  ], \n+  \"ansible_sftp_extra_args\": \"\"\n+}\n\\
        No newline at end of file\ndiff --git a/test/units/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/task_vars_out.json
        b/test/units/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/task_vars_out.json\nnew
        file mode 100644\nindex 0000000000000..0b551f041d412\n--- /dev/null\n+++ b/test/units/plugins/action/fixtures/synchronize/delegate_remote_with_private_key/task_vars_out.json\n@@
        -0,0 +1,387 @@\n+{\n+  \"ansible_pipelining\": false, \n+  \"ansible_docker_extra_args\":
        \"\", \n+  \"ansible_scp_extra_args\": \"\", \n+  \"ansible_user\": \"root\",
        \n+  \"ansible_play_hosts\": [\n+    \"el6host\"\n+  ], \n+  \"ansible_connection\":
        \"smart\", \n+  \"ansible_ssh_common_args\": \"\", \n+  \"environment\": [],
        \n+  \"inventory_hostname\": \"el6host\", \n+  \"vars\": {\n+    \"ansible_check_mode\":
        false, \n+    \"inventory_hostname\": \"el6host\", \n+    \"inventory_file\":
        \"inventory\", \n+    \"ansible_delegated_vars\": {\n+      \"u1404\": {\n+
        \       \"inventory_hostname\": \"u1404\", \n+        \"inventory_file\":
        \"inventory\", \n+        \"vars\": {\n+          \"inventory_file\": \"inventory\",
        \n+          \"role_names\": [], \n+          \"ansible_play_hosts\": [\n+
        \           \"el6host\"\n+          ], \n+          \"groups\": {\n+            \"ungrouped\":
        [\n+              \"el6host\", \n+              \"u1404\"\n+            ],
        \n+            \"all\": [\n+              \"el6host\", \n+              \"u1404\"\n+
        \           ]\n+          }, \n+          \"ansible_check_mode\": false, \n+
        \         \"inventory_hostname\": \"u1404\", \n+          \"inventory_hostname_short\":
        \"u1404\", \n+          \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+          \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+          \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+          \"environment\": [], \n+          \"ansible_ssh_user\": \"root\",
        \n+          \"group_names\": [\n+            \"ungrouped\"\n+          ],
        \n+          \"play_hosts\": [\n+            \"el6host\"\n+          ], \n+
        \         \"ansible_version\": {\n+            \"major\": 2, \n+            \"full\":
        \"2.2.0\", \n+            \"string\": \"2.2.0\", \n+            \"minor\":
        2, \n+            \"revision\": 0\n+          }\n+        }, \n+        \"inventory_hostname_short\":
        \"u1404\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"group_names\": [\n+          \"ungrouped\"\n+        ], \n+        \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"ansible_host\": \"u1404\", \n+        \"environment\": [], \n+
        \       \"ansible_play_hosts\": [\n+          \"el6host\"\n+        ], \n+
        \       \"groups\": {\n+          \"ungrouped\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ]\n+        }, \n+        \"ansible_check_mode\":
        false, \n+        \"play_hosts\": [\n+          \"el6host\"\n+        ], \n+
        \       \"role_names\": [], \n+        \"ansible_port\": null, \n+        \"ansible_version\":
        {\n+          \"major\": 2, \n+          \"full\": \"2.2.0\", \n+          \"string\":
        \"2.2.0\", \n+          \"minor\": 2, \n+          \"revision\": 0\n+        },
        \n+        \"ansible_ssh_user\": \"root\"\n+      }\n+    }, \n+    \"inventory_hostname_short\":
        \"el6host\", \n+    \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+    \"role_names\": [], \n+    \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+    \"environment\": [], \n+    \"play_hosts\": [\n+      \"el6host\"\n+
        \   ], \n+    \"ansible_play_hosts\": [\n+      \"el6host\"\n+    ], \n+    \"hostvars\":
        {\n+      \"el6host\": {\n+        \"inventory_file\": \"inventory\", \n+
        \       \"group_names\": [\n+          \"ungrouped\"\n+        ], \n+        \"groups\":
        {\n+          \"ungrouped\": [\n+            \"el6host\", \n+            \"u1404\",
        \n+            \"::1\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\", \n+            \"::1\"\n+          ]\n+        },
        \n+        \"inventory_hostname\": \"el6host\", \n+        \"inventory_hostname_short\":
        \"el6host\", \n+        \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }, \n+      \"u1404\": {\n+
        \       \"inventory_file\": \"inventory\", \n+        \"group_names\": [\n+
        \         \"ungrouped\"\n+        ], \n+        \"groups\": {\n+          \"ungrouped\":
        [\n+            \"el6host\", \n+            \"u1404\", \n+            \"::1\"\n+
        \         ], \n+          \"all\": [\n+            \"el6host\", \n+            \"u1404\",
        \n+            \"::1\"\n+          ]\n+        }, \n+        \"inventory_hostname\":
        \"u1404\", \n+        \"inventory_hostname_short\": \"u1404\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"ansible_ssh_user\": \"root\", \n+        \"ansible_check_mode\":
        false, \n+        \"ansible_version\": {\n+          \"major\": 2, \n+          \"full\":
        \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\": 2,
        \n+          \"revision\": 0\n+        }\n+      }\n+    }, \n+    \"groups\":
        {\n+      \"ungrouped\": [\n+        \"el6host\", \n+        \"u1404\"\n+
        \     ], \n+      \"all\": [\n+        \"el6host\", \n+        \"u1404\"\n+
        \     ]\n+    }, \n+    \"group_names\": [\n+      \"ungrouped\"\n+    ],
        \n+    \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+    \"ansible_version\": {\n+      \"major\": 2, \n+      \"full\": \"2.2.0\",
        \n+      \"string\": \"2.2.0\", \n+      \"minor\": 2, \n+      \"revision\":
        0\n+    }, \n+    \"ansible_ssh_user\": \"root\"\n+  }, \n+  \"ansible_accelerate_port\":
        5099, \n+  \"roledir\": null, \n+  \"ansible_ssh_extra_args\": \"\", \n+  \"ansible_ssh_host\":
        \"u1404\", \n+  \"ansible_current_hosts\": [\n+    \"el6host\"\n+  ], \n+
        \ \"hostvars\": {\n+    \"el6host\": {\n+      \"inventory_file\": \"inventory\",
        \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ], \n+      \"groups\":
        {\n+        \"ungrouped\": [\n+          \"el6host\", \n+          \"u1404\",
        \n+          \"::1\"\n+        ], \n+        \"all\": [\n+          \"el6host\",
        \n+          \"u1404\", \n+          \"::1\"\n+        ]\n+      }, \n+      \"inventory_hostname\":
        \"el6host\", \n+      \"inventory_hostname_short\": \"el6host\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }, \n+    \"u1404\": {\n+      \"inventory_file\":
        \"inventory\", \n+      \"group_names\": [\n+        \"ungrouped\"\n+      ],
        \n+      \"groups\": {\n+        \"ungrouped\": [\n+          \"el6host\",
        \n+          \"u1404\", \n+          \"::1\"\n+        ], \n+        \"all\":
        [\n+          \"el6host\", \n+          \"u1404\", \n+          \"::1\"\n+
        \       ]\n+      }, \n+      \"inventory_hostname\": \"u1404\", \n+      \"inventory_hostname_short\":
        \"u1404\", \n+      \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\", \n+
        \     \"ansible_ssh_user\": \"root\", \n+      \"ansible_check_mode\": false,
        \n+      \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }\n+    }\n+  }, \n+  \"group_names\": [\n+
        \   \"ungrouped\"\n+  ], \n+  \"ansible_version\": {\n+    \"major\": 2, \n+
        \   \"full\": \"2.2.0\", \n+    \"string\": \"2.2.0\", \n+    \"minor\": 2,
        \n+    \"revision\": 0\n+  }, \n+  \"ansible_ssh_pipelining\": false, \n+
        \ \"inventory_file\": \"inventory\", \n+  \"ansible_delegated_vars\": {\n+
        \   \"u1404\": {\n+      \"inventory_hostname\": \"u1404\", \n+      \"inventory_file\":
        \"inventory\", \n+      \"vars\": {\n+        \"ansible_check_mode\": false,
        \n+        \"inventory_hostname\": \"u1404\", \n+        \"inventory_file\":
        \"inventory\", \n+        \"inventory_hostname_short\": \"u1404\", \n+        \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+        \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+        \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+        \"environment\": [], \n+        \"ansible_ssh_user\": \"root\",
        \n+        \"ansible_play_hosts\": [\n+          \"el6host\"\n+        ],
        \n+        \"groups\": {\n+          \"ungrouped\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ], \n+          \"all\": [\n+            \"el6host\",
        \n+            \"u1404\"\n+          ]\n+        }, \n+        \"group_names\":
        [\n+          \"ungrouped\"\n+        ], \n+        \"play_hosts\": [\n+          \"el6host\"\n+
        \       ], \n+        \"ansible_version\": {\n+          \"major\": 2, \n+
        \         \"full\": \"2.2.0\", \n+          \"string\": \"2.2.0\", \n+          \"minor\":
        2, \n+          \"revision\": 0\n+        }, \n+        \"role_names\": []\n+
        \     }, \n+      \"inventory_hostname_short\": \"u1404\", \n+      \"playbook_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+      \"group_names\": [\n+
        \       \"ungrouped\"\n+      ], \n+      \"inventory_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+      \"omit\": \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\",
        \n+      \"ansible_host\": \"u1404\", \n+      \"environment\": [], \n+      \"ansible_play_hosts\":
        [\n+        \"el6host\"\n+      ], \n+      \"groups\": {\n+        \"ungrouped\":
        [\n+          \"el6host\", \n+          \"u1404\"\n+        ], \n+        \"all\":
        [\n+          \"el6host\", \n+          \"u1404\"\n+        ]\n+      }, \n+
        \     \"ansible_check_mode\": false, \n+      \"play_hosts\": [\n+        \"el6host\"\n+
        \     ], \n+      \"role_names\": [], \n+      \"ansible_port\": null, \n+
        \     \"ansible_version\": {\n+        \"major\": 2, \n+        \"full\":
        \"2.2.0\", \n+        \"string\": \"2.2.0\", \n+        \"minor\": 2, \n+
        \       \"revision\": 0\n+      }, \n+      \"ansible_ssh_user\": \"root\"\n+
        \   }\n+  }, \n+  \"ansible_module_compression\": \"ZIP_DEFLATED\", \n+  \"ansible_failed_hosts\":
        [], \n+  \"ansible_check_mode\": false, \n+  \"groups\": {\n+    \"ungrouped\":
        [\n+      \"el6host\", \n+      \"u1404\"\n+    ], \n+    \"all\": [\n+      \"el6host\",
        \n+      \"u1404\"\n+    ]\n+  }, \n+  \"ansible_host\": \"u1404\", \n+  \"ansible_shell_executable\":
        \"/bin/sh\", \n+  \"inventory_hostname_short\": \"el6host\", \n+  \"omit\":
        \"__omit_place_holder__2433ce0463ffd13b68850ce9cdd98a1cde088e22\", \n+  \"inventory_dir\":
        \"/home/jtanner/workspace/issues/AP-15905\", \n+  \"playbook_dir\": \"/home/jtanner/workspace/issues/AP-15905\",
        \n+  \"ansible_ssh_user\": \"root\", \n+  \"role_names\": [], \n+  \"play_hosts\":
        [\n+    \"el6host\"\n+  ], \n+  \"ansible_sftp_extra_args\": \"\"\n+}\n\\
        No newline at end of file\ndiff --git a/test/units/plugins/action/test_synchronize.py
        b/test/units/plugins/action/test_synchronize.py\nindex 7d40f7b70e299..f83443377eefb
        100644\n--- a/test/units/plugins/action/test_synchronize.py\n+++ b/test/units/plugins/action/test_synchronize.py\n@@
        -251,6 +251,23 @@ def test_delegate_remote_su(self):\n         x = SynchronizeTester()\n
        \        x.runtest(fixturepath=os.path.join(self.fixturedir, 'delegate_remote_su'))\n
        \n+    @patch('ansible.plugins.action.synchronize.connection_loader', FakePluginLoader)\n+
        \   def test_basic_with_private_key(self):\n+        x = SynchronizeTester()\n+
        \       x.runtest(fixturepath=os.path.join(self.fixturedir, 'basic_with_private_key'))\n+\n+
        \   @patch('ansible.plugins.action.synchronize.connection_loader', FakePluginLoader)\n+
        \   def test_delegate_remote_with_private_key(self):\n+        # delegate
        to other remote host and use the module param private_key\n+        x = SynchronizeTester()\n+
        \       x.runtest(fixturepath=os.path.join(self.fixturedir, 'delegate_remote_with_private_key'))\n+\n+
        \   @patch('ansible.plugins.action.synchronize.connection_loader', FakePluginLoader)\n+
        \   def test_delegate_remote_play_context_private_key(self):\n+        # delegate
        to other remote host and use the play context private_key\n+        x = SynchronizeTester()\n+
        \       x.runtest(fixturepath=os.path.join(self.fixturedir, 'delegate_remote_play_context_private_key'))\n+\n
        \    @patch.object(ActionModule, '_low_level_execute_command', side_effect=BreakPoint)\n
        \    @patch.object(ActionModule, '_remote_expand_user', side_effect=ActionModule._remote_expand_user,
        autospec=True)\n     def test_remote_user_not_in_local_tmpdir(self, spy_remote_expand_user,
        ll_ec):\n"
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Content-Encoding:
      - gzip
      Content-Security-Policy:
      - 'default-src ''none''; base-uri ''self''; block-all-mixed-content; connect-src
        ''self'' uploads.github.com www.githubstatus.com collector.githubapp.com api.github.com
        github-cloud.s3.amazonaws.com github-production-repository-file-5c1aeb.s3.amazonaws.com
        github-production-upload-manifest-file-7fdce7.s3.amazonaws.com github-production-user-asset-6210df.s3.amazonaws.com
        cdn.optimizely.com logx.optimizely.com/v1/events wss://alive.github.com; font-src
        github.githubassets.com; form-action ''self'' github.com gist.github.com;
        frame-ancestors ''none''; frame-src render.githubusercontent.com; img-src
        ''self'' data: github.githubassets.com identicons.github.com collector.githubapp.com
        github-cloud.s3.amazonaws.com user-images.githubusercontent.com/ *.githubusercontent.com;
        manifest-src ''self''; media-src ''none''; script-src github.githubassets.com;
        style-src ''unsafe-inline'' github.githubassets.com; worker-src github.com/socket-worker-5029ae85.js
        gist.github.com/socket-worker-5029ae85.js'
      Content-Type:
      - text/plain; charset=utf-8
      Date:
      - Sat, 27 Feb 2021 07:10:43 GMT
      Etag:
      - W/"e2ae899a04cb834ca4ae7b9ef1689ade"
      Expect-CT:
      - max-age=2592000, report-uri="https://api.github.com/_private/browser/errors"
      Referrer-Policy:
      - origin-when-cross-origin, strict-origin-when-cross-origin
      Server:
      - GitHub.com
      Set-Cookie:
      - logged_in=no; domain=.github.com; path=/; expires=Sun, 27 Feb 2022 07:10:43
        GMT; secure; HttpOnly; SameSite=Lax
      Strict-Transport-Security:
      - max-age=31536000; includeSubdomains; preload
      Transfer-Encoding:
      - chunked
      Vary:
      - X-PJAX
      - Accept-Encoding, Accept, X-Requested-With
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - deny
      X-GitHub-Request-Id:
      - D35C:1A52:95E44A:B71BCB:6039F073
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
    url: https://patch-diff.githubusercontent.com/raw/ansible/ansible/pull/73556.diff
version: 1
